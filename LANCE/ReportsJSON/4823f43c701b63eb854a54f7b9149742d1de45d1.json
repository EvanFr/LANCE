{
    "id": "038cbf42-469b-4fc6-be38-1a035530ea6d",
    "created_at": "2023-06-05T02:07:49.808755Z",
    "updated_at": "2024-11-22T02:03:06.610294Z",
    "deleted_at": null,
    "sha1_hash": "4823f43c701b63eb854a54f7b9149742d1de45d1",
    "title": "2023-05-04 - Kimsuky Evolves Reconnaissance Capabilities in New Global Campaign",
    "authors": "",
    "file_creation_date": "2023-06-04T12:27:19Z",
    "file_modification_date": "2023-06-04T12:27:19Z",
    "file_size": 560355,
    "plain_text": "Kimsuky Evolves Reconnaissance Capabilities in New\nGlobal Campaign\nsentinelone.com/labs/kimsuky-evolves-reconnaissance-capabilities-in-new-global-campaign/\nTom Hegel\n\nBy Tom Hegel and Aleksandar Milenkoski\n\nExecutive Summary\nSentinelLabs has observed ongoing attacks from Kimsuky, a North Korean statesponsored APT that has a long history of targeting organizations across Asia, North\nAmerica, and Europe.\nOngoing campaigns use a new malware component we call ReconShark, which is\nactively delivered to specifically targeted individuals through spear-phishing emails,\nOneDrive links leading to document downloads, and the execution of malicious\nmacros.\nReconShark functions as a reconnaissance tool with unique execution instructions and\nserver communication methods. Recent activity has been linked to a wider set of\nactivity we confidently attribute to North Korea.\n\nBackground\nKimsuky is a North Korean advanced persistent threat (APT) group with a long history of\ntargeted attacks across the world. Current understanding of the group indicates they are\nprimarily assigned to intelligence collection and espionage operations in support of the North\nKorean government since at least 2012. In 2018 the group was observed deploying a\nmalware family dubbed BabyShark, and our latest observations indicate the group has\nevolved the malware with an expanded reconnaissance capability \u2013 we refer to this\nBabyShark component as ReconShark.\n\nTargeted Organizations\nHistorically, Kimsuky targets have been located across countries in North America, Asia, and\nEurope. In the groups latest campaigns, they continue their global targeting themed around\nvarious ongoing geopolitical topics. For example, the latest Kimsuky campaigns have\nfocused on nuclear agendas between China and North Korea, relevant to the ongoing war\nbetween Russia and Ukraine.\nIn a recent campaign Kimsuky targeted the staff of Korea Risk Group (KRG), the information\nand analysis firm specializing in matters directly and indirectly impacting the Democratic\nPeople\u2019s Republic of Korea (DPRK). We applaud KRG\u2019s willingness to publicly share our\n1/10\n\nanalysis of attacks against them so the wider cybersecurity community can use this\nintelligence for expanded understanding of the Kimsuky threat actor and their own hunting\nand detection efforts. Our assessment is that the same campaign has been used to continue\ntargeting other organizations and individuals in at least the United States, Europe, and Asia,\nincluding think tanks, research universities, and government entities.\n\nInitial Access Targeting\nFor the deployment of ReconShark, Kimsuky continues to make use of specially crafted\nphishing emails. Notably, the spear-phishing emails are made with a level of design quality\ntuned for specific individuals, increasing the likelihood of opening by the target. This includes\nproper formatting, grammar, and visual clues, appearing legitimate to unsuspecting users.\nNotably, the targeted emails, which contain links to download malicious documents, and the\nmalicious documents themselves, abuse the names of real individuals whose expertise is\nrelevant to the lure subject such as Political Scientists.\nIn the malicious emails, Kimsuky entices the target to open a link to download a passwordprotected document. Most recently, they made use of Microsoft OneDrive to host the\nmalicious document for download. For example, as used against KRG, the lure email\ncontained the OneDrive shared file link:\n1drv[.]ms/u/s!AvPucizxIXoqedcUKN647svN3QM?e=K6N1gT\n\nThe file downloaded is a password protected .doc file named \u201cResearch Proposal-Haowen\nSong.doc\u201d (SHA1: 86a025e282495584eabece67e4e2a43dca28e505) which contains a\nmalicious macro (SHA1: c8f54cb73c240a1904030eb36bb2baa7db6aeb01)\n\n2/10\n\nMalicious Document, themed to DPRK / China\n\nReconShark: A New BabyShark Reconnaissance Variant\nThe lure documents Kimsuky distributes contain Microsoft Office macros that activate on\ndocument close. Based on overlaps in file naming conventions, used malware staging\ntechniques, and code format, we assess that the macros implement a newer variant of a\nreconnaissance capability of the Kimsuky\u2019s BabyShark malware seen targeting entities in the\nKorean peninsula towards the end of 2022. We refer to this BabyShark component as\nReconShark.\nThe ability of ReconShark to exfiltrate valuable information, such as deployed detection\nmechanisms and hardware information, indicates that ReconShark is part of a Kimsukyorchestrated reconnaissance operation that enables subsequent precision attacks, possibly\ninvolving malware specifically tailored to evade defenses and exploit platform weaknesses.\n\nInformation Exfiltration\nThe main responsibility of ReconShark is to exfiltrate information about the infected platform,\nsuch as running processes, information about the battery connected to the system, and\ndeployed endpoint threat detection mechanisms.\nSimilar to previous BabyShark variants, ReconShark relies on Windows Management\nInstrumentation (WMI) to query process and battery information.\n\n3/10\n\nReconShark queries process and battery information\nReconShark checks for the presence of a broad set of processes associated with detection\nmechanisms, such as ntrtscan.exe (Trend Micro OfficeScan), mbam.exe (Malwarebytes\nAnti-Malware), NortonSecurity.exe (Norton Security), and avpui.exe (Kaspersky Internet\nSecurity).\n\nEnumeration of deployed\n\ndetection mechanisms\nIn contrast to previous BabyShark variants, ReconShark exfiltrates information without first\nstoring it on the filesystem \u2013 the malware stores the information it collects in string variables\nand then uploads them to the C2 server by issuing HTTP POST requests.\n\nReconShark exfiltrates information\n\nPayload Deployment\n\n4/10\n\nIn addition to exfiltrating information, ReconShark deploys further payloads in a multi-stage\nmanner that are implemented as scripts (VBS, HTA, and Windows Batch), macro-enabled\nMicrosoft Office templates, or Windows DLL files. ReconShark decides what payloads to\ndeploy depending on what detection mechanism processes run on infected machines.\nSome ReconShark strings are encrypted using a relatively simple cipher to evade static\ndetection mechanisms. These strings are typically commands or scripts for downloading\nand/or executing payloads.\n\nA decrypted command\nReconShark deploys and executes payloads in different ways. For example, the malware\ncan directly download a payload from the C2 server using the curl utility, but also use\nWindows Shortcut (LNK files) or Office templates for that purpose.\nReconShark edits Windows Shortcuts (LNK files) to the msedge.exe (Microsoft Edge),\nchrome.exe (Google Chrome), outlook.exe (Office Outlook), whale.exe (Whale browser),\nand firefox.exe (Mozilla Firefox) applications. When executed, these LNK files start the\nlinked legitimate applications and execute malicious code at the same time.\nFurther, ReconShark replaces the default %AppData%\\Microsoft\\Templates\\Normal.dotm\nOffice template, which opens whenever a user starts Microsoft Word, with a malicious Office\ntemplate hosted at the C2 server. This effectively compromises the execution of Microsoft\nWord.\n\n5/10\n\nReconShark edits LNK files (top) and deploys a malicious Normal.dotm Office template\n(bottom)\nThe payload staging ends with Windows Batch or VBS scripts that create the %AppData%\\1\nfile with a content of ss or sss. These files may represent markers of a successful\nReconShark execution.\n\nA third-stage\nReconShark payload\n\nInfrastructure Analysis\nAll observed infrastructure in this campaign are hosted on a shared hosting server from\nNameCheap, whom we\u2019ve already notified of this malicious activity and recommended\ntakedowns. Kimsuky operators continually made use of LiteSpeed Web Server (LSWS) for\nmanaging the malicious functionality.\n\n6/10\n\nKimsuky LiteSpeed Web Server Portal\nPhishing emails have been observed sending from the yonsei[.]lol domain, while\nrfa[.]ink and mitmail[.]tech are used for command and control. The domain\nyonsei[.]lol has been active since December 2022, with malicious activity occurring as\nrecently as this week. rfa[.]ink has been actively used since early February 2023, and\nmitmail[.]tech since mid January 2023. Kimsuky also made use of newshare[.]online as\na C2 server for a short time at the end of 2022.\nAs shown in the ReconShark macro example, beacons are made to the /bio/ directory of\nrfa[.]ink. During our analysis of the activity, the attacker made multiple attempts at\nrenaming that directory, including /bio433ertgd12/ then later /bio234567890rtyui/, and a\nday later returning back to /bio/.\nThis may have been an attempt to hinder research efforts, or pause the intake of new victims\nfor unknown reasons. The IOC table below highlights each of the URL paths Kimsuky\nmanages across each C2 domain and their specific purpose according to the execution flow\nin the macro. These patterns match across domains, while the directory they are placed in\noften varies. Attempted navigation to some paths on C2 domains are configured to redirect\nvisitors to the legitimate Microsoft website.\nAs with most malicious infrastructure linked to North Korean actors, we can quickly find links\nback to previous reporting or separate campaigns. For example, links can be found to the\ndomains mainchksrh[.]com and com-change[.]info, with indications com-change was\nused in 2020-2022 credential phishing campaigns at these subdomains:\n\n7/10\n\naaaaawwqwdqkidoemsk.lives.com-change[.]info\naccounts.live.com-change[.]info\naccounts.lives.com-change[.]info\ncashsentinel.com-change[.]info\ncashsentinel.hotmail.com-change[.]info\ncashsentinel.hotrnail.com-change[.]info\ncashsentinel.live.com-change[.]info\ncashsentinel.lives.com-change[.]info\ncashsentinel.microsoft.com-change[.]info\ncashsentinel.naver.com-change[.]info\ncashsentinel.navers.com-change[.]info\ncashsentinel.navor.com-change[.]info\ncashsentinel.outlock.com-change[.]info\ncashsentinel.outlook.com-change[.]info\ncloud.navor.com-change[.]info\ndownmail.navor.com-change[.]info\ngmail.com-change[.]info\ngrnail.com-change[.]info\nhotmail.com-change[.]info\nhotrnail.com-change[.]info\nlive.com-change[.]info\nlives.com-change[.]info\nloges.lives.com-change[.]info\nloginsaa.gmail.com-change[.]info\nloginsaa.grnail.com-change[.]info\nlogmes.lives.com-change[.]info\nlogrns.lives.com-change[.]info\nlogws.lives.com-change[.]info\nmicrosoft.com-change[.]info\nmicrosoft.loginsaa.gmail.com-change[.]info\nmicrosoft.loginsaa.grnail.com-change[.]info\nnaver.com-change[.]info\nnaver.loginsaa.gmail.com-change[.]info\nnavers.com-change[.]info\nnavor.com-change[.]info\nnlds.navor.com-change[.]info\noutlock.com-change[.]info\noutlook.com-change[.]info\npaypal.com-change[.]info\npubliccloud.navor.com-change[.]info\nskjflkjsjflejlkjieiieieiei.lives.com-change[.]info\n\nConclusion\nThe ongoing attacks from Kimsuky and their use of the new reconnaissance tool,\nReconShark, highlight the evolving nature of the North Korean threat landscape.\nOrganizations and individuals need to be aware of the TTPs used by North Korea statesponsored APTs and take necessary precautions to protect themselves against such attacks.\nThe link between recent activity and a wider set of previously unknown activity attributed to\nNorth Korea underscores the need for continued vigilance and collaboration.\n8/10\n\nIndicators of Compromise\nIndicator\n\nDescription\n\nyonsei[.]lol\n\nPhishing Email\nSender Domain\n\nhttps[:]//rfa[.]ink/bio/r.php https[:]//mitmail.tech/gorgon/r.php\n\nC2 server endpoint.\n\nhttps[:]//rfa[.]ink/bio/t1.hta https[:]//mitmail[.]tech/gorgon/t1.hta\n\nReconShark\npayload: HTA\nscript.\n\nhttps[:]//rfa[.]ink/bio/ca.php?na=reg.gif\nhttps[:]//mitmail.tech/gorgon/ca.php?na=reg.gif\n\nReconShark\npayload: VBS\nscript.\n\nhttps[:]//rfa[.]ink/bio/ca.php?na=secur32.gif\nhttps[:]//mitmail[.]tech/gorgon/ca.php?na=secur32.gif\nhttps[:]//newshare[.]online/lee/ca.php?na=secur32.gif\n\nReconShark\npayload: DLL file.\n\nhttps[:]//rfa[.]ink/bio/ca.php?na=dot_eset.gif\nhttps[:]//mitmail[.]tech/gorgon/ca.php?na=dot_eset.gif\n\nReconShark\npayload: Office\ntemplate.\n\nhttps[:]//rfa[.]ink/bio/ca.php?na=video.gif\nhttps[:]//mitmail[.]tech/gorgon/ca.php?na=video.gif\n\nReconShark\npayload: Windows\nBatch script.\n\nhttps[:]//rfa[.]ink/bio/ca.php?na=start2.gif\nhttps[:]//mitmail[.]tech/gorgon/ca.php?na=start2.gif\n\nReconShark\npayload: Windows\nBatch script.\n\nhttps[:]//rfa[.]ink/bio/ca.php?na=start4.gif\nhttps[:]//mitmail[.]tech/gorgon/ca.php?na=start4.gif\n\nReconShark\npayload: VBS\nscript.\n\nhttps[:]//rfa[.]ink/bio/ca.php?na=start3.gif\nhttps[:]//mitmail[.]tech/gorgon/ca.php?na=start3.gif\n\nReconShark\npayload: Windows\nBatch script.\n\nhttps[:]//rfa[.]ink/bio/ca.php?na=videop.gif\nhttps[:]//mitmail[.]tech/gorgon/ca.php?na=videop.gif\n\nReconShark\npayload: Windows\nBatch script.\n\nhttps[:]//rfa[.]ink/bio/ca.php?na=start1.gif\nhttps[:]//mitmail[.]tech/gorgon/ca.php?na=start1.gif\n\nReconShark\npayload: Windows\nBatch script.\n\n9/10\n\nhttps[:]//rfa[.]ink/bio/ca.php?na=vbs_esen.gif\nhttps[:]//mitmail[.]tech/gorgon/ca.php?na=vbs_esen.gif\n\nReconShark\npayload: VBS\nscript.\n\nhttps[:]//rfa[.]ink/bio/ca.php?na=start0.gif\nhttps[:]//mitmail[.]tech/gorgon/ca.php?na=start0.gif\n\nReconShark\npayload: Windows\nBatch script.\n\nhttps[:]//rfa[.]ink /bio/d.php?na=vbtmp\n\nReconShark\npayload: VBS\nscript.\n\nhttps[:]//rfa[.]ink/bio/ca.php?na=vbs.gif\nhttps[:]//mitmail[.]tech/gorgon/ca.php?na=vbs.gif\n\nReconShark\npayload: VBS\nscript.\n\nhttps[:]//rfa[.]ink/bio/d.php?na=battmp\n\nReconShark\npayload: Windows\nBatch script.\n\nhttps[:]//rfa[.]ink/bio/ca.php?na=dot_v3.gif\nhttps[:]//mitmail[.]tech/gorgon/ca.php?na=dot_v3.gif\n\nReconShark\npayload: Office\ntemplate.\n\nhttps[:]//rfa[.]ink/bio/ca.php?na=dot_esen.gif\nhttps[:]//mitmail[.]tech/gorgon/ca.php?na=dot_esen.gif\n\nReconShark\npayload: Office\ntemplate.\n\nhttp[:]//rfa[.]ink/bio/ca.php?na=dot_avg.gif\nhttps[:]//mitmail[.]tech/gorgon/ca.php?na=dot_avg.gif\n\nReconShark\npayload: Office\ntemplate.\n\nhttps[:]//rfa[.]ink/bio/ca.php?na=dot_kasp.gif\nhttps[:]//mitmail[.]tech/gorgon/ca.php?na=dot_kasp.gif\n\nReconShark\npayload: Office\ntemplate.\n\n86a025e282495584eabece67e4e2a43dca28e505\n\nLure Doc Example\n\u2013 SHA1\n\nc8f54cb73c240a1904030eb36bb2baa7db6aeb01\n\nMacro \u2013 SHA1\n\n10/10",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2023/2023-05-04 - Kimsuky Evolves Reconnaissance Capabilities in New Global Campaign.pdf"
    ],
    "report_names": [
        "2023-05-04 - Kimsuky Evolves Reconnaissance Capabilities in New Global Campaign.pdf"
    ],
    "threat_actors": [
        {
            "id": "dc78f675-b309-431d-8160-b8dcff037d4f",
            "created_at": "2024-05-01T02:03:08.142224Z",
            "updated_at": "2024-11-22T02:02:53.101712Z",
            "deleted_at": null,
            "main_name": "NICKEL KIMBALL",
            "aliases": [
                "Black Banshee ",
                "Crooked Pisces ",
                "Emerald Sleet ",
                "Kimsuky ",
                "Opal Sleet ",
                "SharpTongue ",
                "THALLIUM ",
                "Velvet Chollima ",
                "APT43 "
            ],
            "source_name": "Secureworks:NICKEL KIMBALL",
            "tools": [
                " KONNI",
                " KimJongRAT",
                " Kimsuky",
                "BabyShark"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "760f2827-1718-4eed-8234-4027c1346145",
            "created_at": "2023-01-06T13:46:38.670947Z",
            "updated_at": "2024-11-22T02:00:02.551126Z",
            "deleted_at": null,
            "main_name": "Kimsuky",
            "aliases": [
                "G0086",
                "APT43",
                "Emerald Sleet",
                "THALLIUM",
                "Sparkling Pisces",
                "Velvet Chollima",
                "Thallium",
                "Springtail",
                "Black Banshee",
                "Operation Stolen Pencil"
            ],
            "source_name": "MISPGALAXY:Kimsuky",
            "tools": [
                "xrat",
                "QUASARRAT",
                "RDP Wrapper",
                "TightVNC",
                "BabyShark",
                "RevClient"
            ],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "191d7f9a-8c3c-442a-9f13-debe259d4cc2",
            "created_at": "2022-10-25T15:50:23.280374Z",
            "updated_at": "2024-11-22T02:00:52.30662Z",
            "deleted_at": null,
            "main_name": "Kimsuky",
            "aliases": [
                "Kimsuky",
                "Black Banshee",
                "Velvet Chollima",
                "Emerald Sleet",
                "THALLIUM",
                "APT43",
                "TA427"
            ],
            "source_name": "MITRE:Kimsuky",
            "tools": [
                "schtasks",
                "Amadey",
                "Brave Prince",
                "CSPY Downloader",
                "gh0st RAT",
                "AppleSeed",
                "NOKKI",
                "QuasarRAT",
                "Gold Dragon",
                "PsExec",
                "KGH_SPY",
                "Mimikatz",
                "BabyShark"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "71a1e16c-3ba6-4193-be62-be53527817bc",
            "created_at": "2022-10-25T16:07:23.753455Z",
            "updated_at": "2024-11-22T02:02:01.064081Z",
            "deleted_at": null,
            "main_name": "Kimsuky",
            "aliases": [
                "APT 43",
                "Black Banshee",
                "Emerald Sleet",
                "ITG16",
                "KTA082",
                "Kimsuky",
                "Operation Baby Coin",
                "Operation Covert Stalker",
                "Operation DEEP#GOSU",
                "Operation Kabar Cobra",
                "Operation Mystery Baby",
                "Operation Red Salt",
                "Operation Smoke Screen",
                "Operation Stealth Power",
                "Operation Stolen Pencil",
                "SharpTongue",
                "Sparkling Pisces",
                "Springtail",
                "TA406",
                "TA427",
                "Thallium",
                "UAT-5394",
                "Velvet Chollima"
            ],
            "source_name": "ETDA:Kimsuky",
            "tools": [
                "AngryRebel",
                "AppleSeed",
                "BITTERSWEET",
                "BabyShark",
                "BoBoStealer",
                "CSPY Downloader",
                "Farfli",
                "FlowerPower",
                "Gh0st RAT",
                "Ghost RAT",
                "Gold Dragon",
                "GoldDragon",
                "GoldStamp",
                "JamBog",
                "KGH Spyware Suite",
                "KGH_SPY",
                "KPortScan",
                "KimJongRAT",
                "Kimsuky",
                "LATEOP",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "Lovexxx",
                "MailPassView",
                "Mechanical",
                "Mimikatz",
                "MoonPeak",
                "Moudour",
                "MyDogs",
                "Mydoor",
                "Network Password Recovery",
                "PCRat",
                "ProcDump",
                "PsExec",
                "ReconShark",
                "Remote Desktop PassView",
                "SHARPEXT",
                "SWEETDROP",
                "SniffPass",
                "TODDLERSHARK",
                "TRANSLATEXT",
                "Troll Stealer",
                "TrollAgent",
                "VENOMBITE",
                "WebBrowserPassView",
                "xRAT"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1685930869808,
    "ts_updated_at": 1732240986610,
    "ts_creation_date": 1685881639000,
    "ts_modification_date": 1685881639000,
    "files": {
        "pdf": "https://archive.orkl.eu/4823f43c701b63eb854a54f7b9149742d1de45d1.pdf",
        "text": "https://archive.orkl.eu/4823f43c701b63eb854a54f7b9149742d1de45d1.txt",
        "img": "https://archive.orkl.eu/4823f43c701b63eb854a54f7b9149742d1de45d1.jpg"
    }
}