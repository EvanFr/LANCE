{
    "id": "79afa07a-a18a-4c68-a4b5-34e73379387f",
    "created_at": "2023-12-13T02:07:22.211955Z",
    "updated_at": "2024-11-22T02:03:45.87192Z",
    "deleted_at": null,
    "sha1_hash": "5e1d8f90ff100844c70bc6c663ffe26771881cd7",
    "title": "Analysis of activities of suspected APT-C-36 (Blind Eagle) organization launching Amadey botnet Trojan",
    "authors": "CoreSec360",
    "file_creation_date": "2023-12-12T04:31:02Z",
    "file_modification_date": "2023-12-12T04:31:02Z",
    "file_size": 1584353,
    "plain_text": "Analysis of activities of suspected APT-C-36 (Blind\nEagle) organization launching Amadey botnet Trojan\nmp.weixin.qq.com/s/-7U1-NTP0EdVOtptzbHUsg\n\nAdvanced Threat Institute 360 Threat Intelligence Center 2023-10-31 06:05 Posted onBeijing\nAPT-C-36\nblind eagle\nAPT-C-36 (Blind Eagle) is an APT organization suspected to come from South America. Its\nmain targets are located in Colombia and some areas of South America such as Ecuador\nand Panama. Since its discovery in 2018, the organization has continued to launch targeted\nattacks against government departments, finance, insurance and other industries as well as\nlarge companies in Colombia.\nDuring the tracking of the APT-C-36 organization, we found that the organization is\nconstantly trying new attack streams and trying to add the Amadey botnet Trojan to its\narsenal.\n\n1. Analysis of attack activities\nIn daily hunting activities, we discovered that the APT-C-36 organization recently attempted\nto add the Amadey botnet Trojan to its usual PDF spear phishing attack flow. The Amadey\nbotnet Trojan is a modular botnet Trojan that appeared for sale on Russian hacker forums\naround October 2018. It has the capabilities of intranet traversal, information theft, remote\ncommand execution, script execution, and DDos attacks.\n\n1. Attack process analysis\nThe attack flow of the Amadey botnet Trojan was used in this campaign.\n\n1/9\n\n2. Load delivery analysis\nThe decoy PDF document downloads an encrypted compressed package containing a\nmalicious VBS script from a third-party cloud service.\n\n2/9\n\nMalicious code data is embedded in VBS.\n\nThe Powershell exploit script code is generated by replacing special characters and\ndecrypted by beas64. The Powershell code downloads two payloads from a third-party\nplatform for loading and running.\n\n3. Attack component analysis\nOne of the two payloads is net_dll for reflection loading, which can be seen frequently used\nby APT-C-36 in previous attacks; the other is the Amadey botnet Trojan. As a relatively\ncomplete botnet Trojan, Amadey has: Sandbox, persistence, permission acquisition, script\nexecution, remote control, data theft and other functions.\n\nNet_dll\nThe Powershell script decrypts the net_dll payload data by downloading it from a third-party\nplatform and calls the CdWDdB.DKeSvl.NnIaUq method to implement reflective loading. The\nnet_dll is a common component of APT-C-36 and is mainly used for persistence and loading\nthe next stage of payload execution.\nAfter Net_dll is run, a vbs and ps1 script will be created in the %TEMP% folder of the\ncomputer for persistence.\n\n3/9\n\nCreate scheduled tasks for persistence.\n\nContinue to download the next-stage payload encoding data from the third-party platform,\nreverse the encoded data, replace special characters, and base64 decode the encoded data\nto obtain the next-stage payload.\n\n4/9\n\nThe processed net_dll payload data is loaded reflectively by calling its\nKoAOkX.MXuuJb.WwQTZc method. In the second stage, after net_dll is run, the AsyncRAT\nTrojan is injected into the system process to run.\n\nAmadey\nThe base64 encoded data downloaded by the Powershell script code from another thirdparty platform is the Amadey botnet Trojan. As a relatively complete botnet Trojan, Amadey\nhas: anti-sandbox, persistence, permission acquisition, script execution, command\nexecution, lateral movement, DDos attacks, data theft and other functional plug-ins.\nMD5\n\n461A67CE40F4A12863244EFEEF5EBC26\n\nsize\n\n237056 (bytes)\n\ntype\n\nWIN32 EXE\n\nAfter running the distributed Amadey, it will download three files: cred.dll, clip.dll, and\nonLyofFicED.bat. The dll file is Amadey\u2019s information collection component and is used to\nsteal user privacy data such as browser accounts. The bat file is to Malicious scripts\nexecuted.\nDuring the file request process, Amadey will send specific fields to the CC server based on\nthe current computer information.\n\n5/9\n\nThe meaning of each field.\nField\n\nmeaning\n\nID\n\nInfected machine ID\n\nvs\n\nAmadey version number\n\nsd\n\nAmadeyID\n\nos\n\nsystem version\n\nbi\n\nNumber of system bits\n\nar\n\nDo you have administrator rights?\n\npc\n\nComputer name\n\nun\n\nusername\n\nDM\n\nCurrent domain\n\nav\n\nInstall anti-virus software\n\nlv\n\nGetTaskContent\n\nog\n\nnone\n\n6/9\n\nIn the bat file, the attacker uses base64 encryption + AES + Gzip to encrypt the two\nexecutable programs and embed them into the script file. After the bat script is run, the\nciphertext data is located through the \":\" symbol, decrypted and loaded in sequence.\n\nOne of the executable programs is the CrubCrypt encryptor. After running, it Gzip\ndecompresses the Remcos compressed data of the resource and then loads and runs it.\n\n2. Attribution Research and Judgment\n\n7/9\n\nThe bait PDF file used in this spear phishing incident, the malicious code obfuscation method\nused, and the subsequent payload are consistent with those used by APT-C-36 in previous\nactivities.\nDuring the continuous tracking of APT-C-36, we found that the organization continues to\nlaunch attacks in Ecuador and other regions, and constantly tries to add new Trojan tools to\nits arsenal to improve its attack capabilities. It is foreseeable that APT-C-36 may turn its\nattention to new areas in the future, and its own attack capabilities will become more\ncomplex.\n\nAppendix IOC\n20561F6497492900567CBF08A20AFCCA\n42DD207E642CEC5A12839257DF892CA9\n461A67CE40F4A12863244EFEEF5EBC26\nFDD66DC414647B87AA1688610337133B\n5590C7E442E8D2BC857813C008CE4A6C\n303ACDC5A695A27A91FEA715AE8FDFB8\nFECB399CAE4861440DF73EAA7110F52C\nC92A9FA4306F7912D3AF58C2A75682FD\n57A169A5A3CA09A0EDE3FEDC50E6D222\n05B99BEE0D8BA95F5CCB1D356939DAA8\n64E6B811153C4452837E187A10D54665\nc1eeb77920357a53e271091f85618bd9\nautgerman.autgerman.com\nhttp://213.226.123.14/8bmeVwqx/Plugins/cred.dll\nhttp://213.226.123.14/8bmeVwqx/Plugins/clip64.dll\nhttp://213.226.123.14/8bmeVwqx/index.php\nhttp://213.226.123.14/8bmeVwqx/Plugins/cred64.dll\nhttp://213.226.123.14/8bmeVwqx/Plugins/clip.dll\nhttp://213.226.123.14/8bmeVwqx/index.php?scr=1\nhttps://subirfact.com/onLyofFicED.bat\n360 Advanced Threat Research Institute\n360 Advanced Threat Research Institute is the core capability support department of 360\nDigital Security Group. It is composed of 360 senior security experts. It focuses on the\ndiscovery, defense, disposal and research of advanced threats. It has been the first to\ncapture Double Kill, Double Star, and Nightmare Formula globally. It has conducted many\nwell-known zero-day attacks in the wild and exclusively disclosed the advanced actions of\n8/9\n\nmultiple national APT organizations, winning widespread recognition within and outside the\nindustry and providing strong support for 360 to ensure national network security.\nAPT109\n\u200b\n\n9/9",
    "language": "EN",
    "sources": [
        {
            "id": "d63ae2b7-445f-460d-965d-2676dacdb6de",
            "created_at": "2022-10-25T15:59:19.552139Z",
            "updated_at": "2022-10-25T15:59:19.552139Z",
            "deleted_at": null,
            "name": "APTnotes",
            "url": "https://github.com/aptnotes/data",
            "description": "APTnotes data",
            "reports": null
        }
    ],
    "references": [
        "https://app.box.com/s/ubdtp5ptp5mk79x2d1cutpsr4cik8af0"
    ],
    "report_names": [
        "CoreSec360_APT-C-36-BlindEagle-Amadey-botnet(10-31-2023)"
    ],
    "threat_actors": [
        {
            "id": "98b22fd7-bf1b-41a6-b51c-0e33a0ffd813",
            "created_at": "2022-10-25T15:50:23.688973Z",
            "updated_at": "2024-11-22T02:00:52.397568Z",
            "deleted_at": null,
            "main_name": "APT-C-36",
            "aliases": [
                "APT-C-36",
                "Blind Eagle"
            ],
            "source_name": "MITRE:APT-C-36",
            "tools": [
                "Imminent Monitor"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "bd43391b-b835-4cb3-839a-d830aa1a3410",
            "created_at": "2023-01-06T13:46:38.925525Z",
            "updated_at": "2024-11-22T02:00:02.626593Z",
            "deleted_at": null,
            "main_name": "APT-C-36",
            "aliases": [
                "Blind Eagle"
            ],
            "source_name": "MISPGALAXY:APT-C-36",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "be597b07-0cde-47bc-80c3-790a8df34af4",
            "created_at": "2022-10-25T16:07:23.407484Z",
            "updated_at": "2024-11-22T02:02:00.968443Z",
            "deleted_at": null,
            "main_name": "Blind Eagle",
            "aliases": [
                "APT-C-36",
                "APT-Q-98",
                "AguilaCiega"
            ],
            "source_name": "ETDA:Blind Eagle",
            "tools": [
                "AsyncRAT",
                "BitRAT",
                "Bladabindi",
                "BlotchyQuasar",
                "Imminent Monitor",
                "Imminent Monitor RAT",
                "Jorik",
                "LimeRAT",
                "Remcos",
                "RemcosRAT",
                "Remvio",
                "Socmer",
                "Warzone",
                "Warzone RAT",
                "njRAT"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1702433242211,
    "ts_updated_at": 1732241025871,
    "ts_creation_date": 1702355462000,
    "ts_modification_date": 1702355462000,
    "files": {
        "pdf": "https://archive.orkl.eu/5e1d8f90ff100844c70bc6c663ffe26771881cd7.pdf",
        "text": "https://archive.orkl.eu/5e1d8f90ff100844c70bc6c663ffe26771881cd7.txt",
        "img": "https://archive.orkl.eu/5e1d8f90ff100844c70bc6c663ffe26771881cd7.jpg"
    }
}