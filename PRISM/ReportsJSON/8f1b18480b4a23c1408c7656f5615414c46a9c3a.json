{
    "id": "d279d0ff-12cf-447d-82ac-5727983bf65b",
    "created_at": "2023-06-05T02:07:25.861628Z",
    "updated_at": "2024-11-22T02:02:55.967628Z",
    "deleted_at": null,
    "sha1_hash": "8f1b18480b4a23c1408c7656f5615414c46a9c3a",
    "title": "2023-05-17 - APT28 leverages multiple phishing techniques to target Ukrainian civil society",
    "authors": "",
    "file_creation_date": "2023-06-04T12:58:29Z",
    "file_modification_date": "2023-06-04T12:58:29Z",
    "file_size": 1147968,
    "plain_text": "APT28 leverages multiple phishing techniques to target\nUkrainian civil society\nblog.sekoia.io/apt28-leverages-multiple-phishing-techniques-to-target-ukrainian-civil-society/\n17 May 2023\n\nLog in\nWhoops! You have to login to access the Reading Center functionalities!\nForgot password?\n\nSearch the site...\nAll categories\nResearch & Threat Intelligence\nProduct News & Tutorials\nReset\nResearch & Threat Intelligence\nThe APT28 intrusion set (aka. Sofacy, PawnStorm, Fancy Bear), associated to the Russian\nGRU was observed using multiple phishing techniques to target the Ukrainian civil society.\nAPT28\nphishing\nSofacy\nukraine\n\nFelix Aim\u00e9 and Threat & Detection Research Team - TDR May 17 2023\n384 0\nRead it later Remove\n8 minutes reading\nThe APT28 intrusion set (aka. Sofacy, PawnStorm, Fancy Bear), associated to the Russian\nGRU and famous for its cyber espionage and sabotage campaigns, was observed using\nmultiple phishing techniques to target the Ukrainian civil society. These techniques include\nusing HTTP webhook services such as as Pipedream and Webhook, as well as\n\n1/10\n\ncompromised Ubiquiti routers to steal victims\u2019 credentials. On one occasion, APT28 was\nseen using the \u201cBrowser in the Browser\u201d technique to display a fake login page to the victim,\npurporting to decrypt a document.\nThe majority of retrieved phishing webpages target the UKR.NET webmail service, which is\npopular among Ukrainian society. However, APT28 could use the same techniques against\nother webmail services used by western civil society which supports Ukraine.\nThis small blogpost aims at presenting the different techniques used by APT28 to create\ntheir spear phishing webpages, as well as ways to detect them, including IOCs and YARA\nrules.\n\nTechnique 1: Man in the browser\nDuring their investigations, Sekoia.io TDR analysts identified a file named CDS Daily Brief\n23.03.2023.html, impersonating the Ukrainian security think tank Centre for Defence\nStrategies. The centre provides online daily briefings on the Russo-Ukrainian conflict. The\nretrieved decoy document trick the victim into click on a button to decrypt the page content,\nwhich is presumably secured by a UKR.NET technology.\nClicking on the button displays fake login window. This window contains an iframe that\nembeds a fake UKR.NET login webpage hosted on robot-876.frge[.]io \u2013 which was\ndeactivated during the investigation and was already published by Google TAG. The\nintention here is to trick the user into entering their credentials.\n\n2/10\n\nThis is the only known phishing case from APT28 that we know of where the intrusion set\nuses an HTML attachment with the Man in the Browser technique to trick the user into\nentering its credentials. Although the code and the technique was copied from the mrd0x\noriginal blogpost dating back to 2022, the analysed document is currently only detected by\none antivirus engine on VirusTotal (eScan) at the time of writing.\n\nTechnique 2: Use of HTTP debugging / webhook services by APT28\nA second technique that we observed used by APT28 since more than a year is the use of\npublic HTTP debugging / webhook services in their phishing webpages to retrieve stolen\ncredentials, as shown below:\n\n3/10\n\nTherefore, APT28 operators don\u2019t need to setup any extra script or infrastructure to collect\nthe credentials, but only to setup a webhook page on the service and wait to receive\ncredentials from the victim. During the investigation, we identified two services abused by\nAPT28, PipeDream.com and Webhook.site, both receiving HTTP requests without any user\ninscription.\nThis technique was at least on two phishing webpages operated by APT28, the first one\ntargeting UKR.NET, and the second one targeting Yahoo.com, as shown below:\n\n4/10\n\nThis is the first time we see a state-sponsored threat actor use these services for phishing\noperations. While this technique remains effective, from a security perspective, there is a\nconcern that some services might allow access to hooks created by simply by\nspecifying the hook identifier. This implies that anyone accessing the phishing page can\nview stolen credentials by looking at the specific hook.\n\nTechnique 3: Use of compromised Ubiquiti Routers by APT28.\nThe aforementioned technique is only applicable to accounts with 1FA authentication, as the\nwebhook service lacks the capability to interact with the UKR.NET servers for validating the\nsecond factor and retrieving authentication cookies or tokens. For 2FA accounts, APT28\ncreated dedicated webpages hosted on *.frge[.]io domains that interact with a Python script\nrunning on compromised Ubiquiti routers.\nHere is an extract from the HTML code of a phishing webpage that points to a compromised\nUbiquiti router ( 174.53.242.108):\n\nThe Python script, which was leaked on Twitter, interacts with the UKR.NET API to\nauthenticate the user and bypass 2FA. Interestingly, as the UKR.NET service uses\nRecaptchaV2 during the authentication process, the Python script contains code to bypass\nthe captcha by using the anti-captcha.com service API with the customer key equal to\nacbb64c3de5ea5e5936df4a1eecf1235.\n\n5/10\n\nThe script enables two other interesting features. The first one is that it activates IMAP\naccess via the UKR.NET API for the compromised mail account and saves the generated\npassword from UKR.NET, which will be used for this access, to a file as shown below.\nEmbedding IMAP access to the mailbox is a known trick that allows APT28 operators to\nautomate mail exfiltration.\n\nAnother interesting feature embedded in this script is that it deletes the last emails received\nfrom noreply@ukr.net. Sekoia.io analysts assess this is almost certainly done to cover up\nchanges to the mailbox security settings. It is also highly likely a technique to prevent the\nuser from being alerted to a new access to the mailbox.\n\nThrough the use of heuristics, Sekoia.io discovered five different Ubiquiti routers hosting the\nPython script. All of them were already compromised by the same SSH rootkit, as\nindicated by their unusual SSH banners. This rootkit is based on the openssh-backdoor-kit\nopen-source project. This rootkit has already compromised hundreds of Ubiquiti\nrouters, as evidenced by the returned SSH banners. It is unclear whether this rootkit is\n\n6/10\n\nused by APT28 or another threat actor who is also looking for shells on embedded devices.\nSo far, no other compromised SOHO brands or VPS instances were matching our heuristics\non the APT28\u2019s 2FA phishing script.\nUpdate: An attentive reader said that it is likely that APT28 took over the routers by exploiting\nthe SSH backdoor, as the backdoor has been already analyzed and its passwords published.\nMoreover, one of the backdoored sshd sample was known on VT since 2018.\nAs demonstrated in our FLINT report on CVE-2023-23397, APT-28 recently used\ncompromised Ubiquiti Edge devices, based on EdgeOS, as operational boxes to serve\nResponder instances on 445. Attackers seem to find EdgeOs, which is based on the\nDebian fork Vyatta, particularly interesting due to its default password, WAN access, and\nAptitude package management capabilities. These features make it easy for them to deploy\ntheir scripts.\n\nLinks to APT28\nSekoia.io analysts link their campaigns to APT28 with high confidence based on two\nartefacts.\nAPT28 uses the getforge service since 2022, which produces the frge[.]io domain names. In\n2022, APT28 used this service to exploit the Follina vulnerability and drop its CredoMap\nstealer. This service allows for free hosting of static web pages and is no longer maintained\nby the company that created it. Sekoia.io analysts think that APT28 may see this as a good\nopportunity to host web pages without the risk of being taken down.\nThe final point pertains to the use of HTTP webhooks and mocking-free services in APT28\u2019s\noperations. They appear to use these services to host payloads and retrieve victim data\nbecause getforge doesn\u2019t allow to host dynamic webpages. Moreover, these services are\nfree, legit and do not require specific infrastructure setup. Although we currently only see\nAPT28 using these services, it is possible that other intrusion sets may follow, as was the\ncase with the use of pastebin-like services to host payloads.\n\u2014\nFeatured image: Drone Shot of Motherland Monument and the City of Kyiv \u2013 CC Petkevich\nEvgeniy\n\nIOCs of APT28 listed as part of this campaign targeting Ukrainian\ncivil society\nMalicious domains names\n\n7/10\n\nrobot-876.frge[.]io\nsetnewcred.ukr.net.frge[.]io\npanelunregistertle-348[.]frge.io\nsettings-panel.frge[.]io\nukrprivacysite.frge[.]io\nconfig-panel.frge[.]io (medium confidence)\nsmtp-relay.frge[.]io (medium confidence)\n\nCompromised Ubiquiti routers\n68.76.150[.]97\n174.53.242[.]108\n24.11.70[.]85\n202.175.177[.]238\n85.240.182[.]23\n\nSSH rootkit IOCs\n69.28.64[.]137 - Attacker\u2019s IP\npackinstall.kozow[.]com - Installation script staging server\n\nYara rules to detect APT28\n\n8/10\n\nrule apt_APT28_Phishing_webpage_Ubiquiti {\nmeta:\nid = \"324e9b6f-45eb-4cb4-bca6-9012edc7170c\"\nversion = \"1.0\"\nintrusion_set = \"APT28\"\ndescription = \"Detects APT28 phishing page sending to Ubiquiti devices\"\nsource = \"SEKOIA\"\ncreation_date = \"2023-04-28\"\nclassification = \"TLP:WHITE\"\nstrings:\n$ = \"req.open(\\\"GET\\\", \\\"http://\"\n$ = \"/captcha\\\", true);\"\n$ = \"[3].style.backgroundImage=\"\n$ = \".html?usr=\"\n$ = \"full.forEach(element=>setInp\"\ncondition:\nfilesize < 100KB and\n3 of them\n}\nrule apt_APT28_UKRNET_2FA_Bypass_Python_Script {\nmeta:\nid = \"b8e4418c-1b39-4f78-b2ec-a0b85e4e7ca6\"\nversion = \"1.0\"\nintrusion_set = \"APT28\"\ndescription = \"Detects APT28 Python script used to bypass 2FA on UKR.NET\"\nsource = \"SEKOIA\"\ncreation_date = \"2023-04-28\"\nclassification = \"TLP:WHITE\"\nstrings:\n$ = \"debug('f_res ok')\"\n$ = \"make_response('BAD')\"\n$ = \"make_response('NOOP')\"\n$ = \"debug('task='+str(task))\"\n$ = \"f.write(str_cookie\"\n$ = \"if stop==True:\"\n$ = \"with open(login+\"\ncondition:\nfilesize < 5KB and\n3 of them\n}\nrule apt_APT28_Phishing_webpage_webhook {\nmeta:\nid = \"46adc67b-8bcc-4cba-a480-502c7eb433a3\"\nversion = \"1.0\"\nintrusion_set = \"APT28\"\ndescription = \"Detects webhook APT28 phishing page\"\nsource = \"SEKOIA\"\ncreation_date = \"2023-04-28\"\nclassification = \"TLP:WHITE\"\nstrings:\n\n9/10\n\n$ = \"location.replace(\\\"http\"\n$ = \"name=location.search.split('=')[1];\"\n$ = \"req.send(JSON.stringify({login: name, pass: pass,\"\ncondition:\nfilesize < 20KB and\nall of them\n}\nrule apt_APT28_Phishing_Browser_in_Browser {\nmeta:\nid = \"e997b893-3120-4121-a813-281abfaa59c8\"\nversion = \"1.0\"\nintrusion_set = \"APT28\"\ndescription = \"Detects APT28 Browser in Browser phishing page\"\nsource = \"SEKOIA\"\ncreation_date = \"2023-04-28\"\nclassification = \"TLP:WHITE\"\nstrings:\n$ = \"U2FsdGVkX19nY7\"\n$ = \"').innerHTML=CryptoJS.AES.decrypt(document.getElementById(\"\n$ = \").toString(CryptoJS.enc.Utf8)\"\n$ = \"function sh()\"\n$ = \"$(\\\"#clickme\\\")[0].style.display='none'\"\n$ = \"<span id=\\\"domain-name\\\">\"\ncondition:\n4 of them and\nfilesize < 500KB\n}\n\nChat with our team!\nWould you like to know more about our solutions?\nDo you want to discover our XDR and CTI products?\nDo you have a cybersecurity project in your organization?\nMake an appointment and meet us!\nContact us\nThank you for reading this blog post. Feel free to share your feedback, and read other TDR\nreports here:\nComments are closed.\n\n10/10",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2023/2023-05-17 - APT28 leverages multiple phishing techniques to target Ukrainian civil society.pdf"
    ],
    "report_names": [
        "2023-05-17 - APT28 leverages multiple phishing techniques to target Ukrainian civil society.pdf"
    ],
    "threat_actors": [
        {
            "id": "e3767160-695d-4360-8b2e-d5274db3f7cd",
            "created_at": "2022-10-25T16:47:55.914348Z",
            "updated_at": "2024-11-22T02:02:53.09478Z",
            "deleted_at": null,
            "main_name": "IRON TWILIGHT",
            "aliases": [
                "ATK5 ",
                "Blue Athena ",
                "BlueDelta ",
                "FROZENLAKE ",
                "Fancy Bear ",
                "Fighting Ursa ",
                "Forest Blizzard ",
                "Group 74 ",
                "PawnStorm ",
                "STRONTIUM ",
                "Sednit ",
                "Snakemackerel ",
                "Sofacy ",
                "TG-4127 ",
                "Tsar Team ",
                "APT28 "
            ],
            "source_name": "Secureworks:IRON TWILIGHT",
            "tools": [
                " Downdelph",
                " Drovorub",
                " EVILTOSS",
                " HIDEDRV",
                " Headlace",
                " LoJack",
                " Powershell Empire",
                " SCONATO",
                " SEDUPLOADER",
                " SHARPFRONT",
                " Scaramouche",
                " Sedkit Exploit Kit",
                " Sofacy downloader",
                " X-Agent",
                " X-Tunnel",
                " Zebrocy",
                " reGeorg",
                "DEALERSCHOICE"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "730dfa6e-572d-473c-9267-ea1597d1a42b",
            "created_at": "2023-01-06T13:46:38.389985Z",
            "updated_at": "2024-11-22T02:00:02.469031Z",
            "deleted_at": null,
            "main_name": "APT28",
            "aliases": [
                "Pawn Storm",
                "Sednit",
                "IRON TWILIGHT",
                "TA422",
                "T-APT-12",
                "Fighting Ursa",
                "ITG05",
                "UAC-0028",
                "FANCY BEAR",
                "SNAKEMACKEREL",
                "Tsar Team",
                "Group 74",
                "G0007",
                "BlueDelta",
                "Fancy Bear",
                "Sofacy",
                "TG-4127",
                "STRONTIUM",
                "Grizzly Steppe",
                "ATK5",
                "FROZENLAKE",
                "SIG40",
                "Blue Athena",
                "APT-C-20",
                "Forest Blizzard"
            ],
            "source_name": "MISPGALAXY:APT28",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "ae320ed7-9a63-42ed-944b-44ada7313495",
            "created_at": "2022-10-25T15:50:23.671663Z",
            "updated_at": "2024-11-22T02:00:52.392704Z",
            "deleted_at": null,
            "main_name": "APT28",
            "aliases": [
                "APT28",
                "IRON TWILIGHT",
                "SNAKEMACKEREL",
                "Group 74",
                "Sednit",
                "Sofacy",
                "Pawn Storm",
                "Fancy Bear",
                "STRONTIUM",
                "Tsar Team",
                "Threat Group-4127",
                "TG-4127",
                "Forest Blizzard",
                "FROZENLAKE"
            ],
            "source_name": "MITRE:APT28",
            "tools": [
                "Wevtutil",
                "certutil",
                "Forfiles",
                "DealersChoice",
                "Mimikatz",
                "ADVSTORESHELL",
                "Komplex",
                "HIDEDRV",
                "JHUHUGIT",
                "Koadic",
                "Winexe",
                "XTunnel",
                "Drovorub",
                "CORESHELL",
                "OLDBAIT",
                "Downdelph",
                "XAgentOSX",
                "USBStealer",
                "Zebrocy",
                "Fysbis",
                "LoJax"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "d2516b8e-e74f-490d-8a15-43ad6763c7ab",
            "created_at": "2022-10-25T16:07:24.212584Z",
            "updated_at": "2024-11-22T02:02:01.181291Z",
            "deleted_at": null,
            "main_name": "Sofacy",
            "aliases": [
                "APT 28",
                "ATK 5",
                "Blue Athena",
                "BlueDelta",
                "FROZENLAKE",
                "Fancy Bear",
                "Fighting Ursa",
                "Forest Blizzard",
                "Grey-Cloud",
                "Grizzly Steppe",
                "Group 74",
                "ITG05",
                "Iron Twilight",
                "Operation DealersChoice",
                "Operation Dear Joohn",
                "Operation Komplex",
                "Operation Pawn Storm",
                "Operation Russian Doll",
                "Operation Steal-It",
                "Pawn Storm",
                "SIG40",
                "Sednit",
                "Snakemackerel",
                "Sofacy",
                "Strontium",
                "T-APT-12",
                "TA422",
                "TAG-0700",
                "TG-4127",
                "Tsar Team",
                "UAC-0028",
                "UAC-0063"
            ],
            "source_name": "ETDA:Sofacy",
            "tools": [
                "ADVSTORESHELL",
                "AZZY",
                "Backdoor.SofacyX",
                "CHERRYSPY",
                "CORESHELL",
                "Carberp",
                "Computrace",
                "DealersChoice",
                "Delphacy",
                "Downdelph",
                "Downrage",
                "Drovorub",
                "EVILTOSS",
                "Foozer",
                "GAMEFISH",
                "GooseEgg",
                "Graphite",
                "HATVIBE",
                "HIDEDRV",
                "Headlace",
                "Impacket",
                "JHUHUGIT",
                "JKEYSKW",
                "Koadic",
                "Komplex",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "LoJack",
                "LoJax",
                "MASEPIE",
                "Mimikatz",
                "NETUI",
                "Nimcy",
                "OCEANMAP",
                "OLDBAIT",
                "PocoDown",
                "PocoDownloader",
                "Popr-d30",
                "ProcDump",
                "PythocyDbg",
                "SMBExec",
                "SOURFACE",
                "SPLM",
                "STEELHOOK",
                "Sasfis",
                "Sedkit",
                "Sednit",
                "Sedreco",
                "Seduploader",
                "Shunnael",
                "SkinnyBoy",
                "Sofacy",
                "SofacyCarberp",
                "SpiderLabs Responder",
                "Trojan.Shunnael",
                "Trojan.Sofacy",
                "USB Stealer",
                "USBStealer",
                "VPNFilter",
                "Win32/USBStealer",
                "WinIDS",
                "Winexe",
                "X-Agent",
                "X-Tunnel",
                "XAPS",
                "XTunnel",
                "Xagent",
                "Zebrocy",
                "Zekapab",
                "carberplike",
                "certutil",
                "certutil.exe",
                "fysbis",
                "webhp"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1685930845861,
    "ts_updated_at": 1732240975967,
    "ts_creation_date": 1685883509000,
    "ts_modification_date": 1685883509000,
    "files": {
        "pdf": "https://archive.orkl.eu/8f1b18480b4a23c1408c7656f5615414c46a9c3a.pdf",
        "text": "https://archive.orkl.eu/8f1b18480b4a23c1408c7656f5615414c46a9c3a.txt",
        "img": "https://archive.orkl.eu/8f1b18480b4a23c1408c7656f5615414c46a9c3a.jpg"
    }
}