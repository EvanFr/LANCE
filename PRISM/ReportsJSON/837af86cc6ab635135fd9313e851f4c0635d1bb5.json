{
    "id": "638a78b1-616a-42f8-a776-f4708a506b41",
    "created_at": "2023-06-05T02:07:42.016228Z",
    "updated_at": "2024-11-22T02:02:59.531299Z",
    "deleted_at": null,
    "sha1_hash": "837af86cc6ab635135fd9313e851f4c0635d1bb5",
    "title": "2023-05-24 - Volt Typhoon targets US critical infrastructure with living-off-the-land techniques",
    "authors": "",
    "file_creation_date": "2023-06-04T13:03:10Z",
    "file_modification_date": "2023-06-04T13:03:10Z",
    "file_size": 1267638,
    "plain_text": "Volt Typhoon targets US critical infrastructure with livingoff-the-land techniques\nmicrosoft.com/en-us/security/blog/2023/05/24/volt-typhoon-targets-us-critical-infrastructure-with-living-off-the-landtechniques/\nMay 24, 2023\n\nBy Microsoft Threat Intelligence\n\nMicrosoft has uncovered stealthy and targeted malicious activity focused on postcompromise credential access and network system discovery aimed at critical infrastructure\norganizations in the United States. The attack is carried out by Volt Typhoon, a statesponsored actor based in China that typically focuses on espionage and information\ngathering. Microsoft assesses with moderate confidence that this Volt Typhoon campaign is\npursuing development of capabilities that could disrupt critical communications infrastructure\nbetween the United States and Asia region during future crises.\nVolt Typhoon has been active since mid-2021 and has targeted critical infrastructure\norganizations in Guam and elsewhere in the United States. In this campaign, the affected\norganizations span the communications, manufacturing, utility, transportation, construction,\n\n1/9\n\nmaritime, government, information technology, and education sectors. Observed behavior\nsuggests that the threat actor intends to perform espionage and maintain access without\nbeing detected for as long as possible. Microsoft is choosing to highlight this Volt Typhoon\nactivity at this time because of our significant concern around the potential for further impact\nto our customers. Although our visibility into these threats has given us the ability to deploy\ndetections to our customers, the lack of visibility into other parts of the actor\u2019s activity\ncompelled us to drive broader community awareness and further investigations and\nprotections across the security ecosystem.\nTo achieve their objective, the threat actor puts strong emphasis on stealth in this campaign,\nrelying almost exclusively on living-off-the-land techniques and hands-on-keyboard activity.\nThey issue commands via the command line to (1) collect data, including credentials from\nlocal and network systems, (2) put the data into an archive file to stage it for exfiltration, and\nthen (3) use the stolen valid credentials to maintain persistence. In addition, Volt Typhoon\ntries to blend into normal network activity by routing traffic through compromised small office\nand home office (SOHO) network equipment, including routers, firewalls, and VPN hardware.\nThey have also been observed using custom versions of open-source tools to establish a\ncommand and control (C2) channel over proxy to further stay under the radar.\nIn this blog post, we share information on Volt Typhoon, their campaign targeting critical\ninfrastructure providers, and their tactics for achieving and maintaining unauthorized access\nto target networks. Because this activity relies on valid accounts and living-off-the-land\nbinaries (LOLBins), detecting and mitigating this attack could be challenging. Compromised\naccounts must be closed or changed. At the end of this blog post, we share more mitigation\nsteps and best practices, as well as provide details on how Microsoft 365 Defender detects\nmalicious and suspicious activity to protect organizations from such stealthy attacks. The\nNational Security Agency (NSA) has also published a Cybersecurity Advisory [PDF] which\ncontains a hunting guide for the tactics, techniques, and procedures (TTPs) discussed in this\nblog.\nAs with any observed nation-state actor activity, Microsoft has directly notified targeted or\ncompromised customers, providing them with important information needed to secure their\nenvironments. To learn about Microsoft\u2019s approach to threat actor tracking, read Microsoft\nshifts to a new threat actor naming taxonomy.\n\n2/9\n\nFigure 1. Volt Typhoon attack diagram\n\nInitial access\nVolt Typhoon achieves initial access to targeted organizations through internet-facing\nFortinet FortiGuard devices. Microsoft continues to investigate Volt Typhoon\u2019s methods for\ngaining access to these devices.\nThe threat actor attempts to leverage any privileges afforded by the Fortinet device, extracts\ncredentials to an Active Directory account used by the device, and then attempts to\nauthenticate to other devices on the network with those credentials.\nVolt Typhoon proxies all its network traffic to its targets through compromised SOHO network\nedge devices (including routers). Microsoft has confirmed that many of the devices, which\ninclude those manufactured by ASUS, Cisco, D-Link, NETGEAR, and Zyxel, allow the owner\nto expose HTTP or SSH management interfaces to the internet. Owners of network edge\ndevices should ensure that management interfaces are not exposed to the public internet in\norder to reduce their attack surface. By proxying through these devices, Volt Typhoon\nenhances the stealth of their operations and lowers overhead costs for acquiring\ninfrastructure.\n\nPost-compromise activity\nOnce Volt Typhoon gains access to a target environment, they begin conducting hands-onkeyboard activity via the command line. Some of these commands appear to be exploratory\nor experimental, as the operators adjust and repeat them multiple times.\nVolt Typhoon rarely uses malware in their post-compromise activity. Instead, they rely on\nliving-off-the-land commands to find information on the system, discover additional devices\non the network, and exfiltrate data. We describe their activities in the following sections,\nincluding the most impactful actions that relate to credential access.\n\n3/9\n\nCredential access\nIf the account that Volt Typhoon compromises from the Fortinet device has privileged access,\nthey use that account to perform the following credential access activities.\nMicrosoft has observed Volt Typhoon attempting to dump credentials through the Local\nSecurity Authority Subsystem Service (LSASS). The LSASS process memory space\ncontains hashes for the current user\u2019s operating system (OS) credentials.\n\nFigure 2. Volt Typhoon command to dump LSASS process memory, encoded in Base64\n\nFigure 3. Decoded Base64 of Volt Typhoon command to dump LSASS process memory\nVolt Typhoon also frequently attempts to use the command-line tool Ntdsutil.exe to create\ninstallation media from domain controllers, either remotely or locally. These media are\nintended to be used in the installation of new domain controllers. The files in the installation\nmedia contain usernames and password hashes that the threat actors can crack offline,\ngiving them valid domain account credentials that they could use to regain access to a\ncompromised organization if they lose access.\n\nFigure 4. Volt Typhoon command to remotely create domain controller installation media\n\nFigure 5. Volt Typhoon command to locally create domain controller installation media\n\nDiscovery\nMicrosoft has observed Volt Typhoon discovering system information, including file system\ntypes; drive names, size, and free space; running processes; and open networks. They also\nattempt to discover other systems on the compromised network using PowerShell, Windows\nManagement Instrumentation Command-line (WMIC), and the ping command. In a small\nnumber of cases, the threat actors run system checks to determine if they are operating\nwithin a virtualized environment.\n\n4/9\n\nCollection\nIn addition to operating system and domain credentials, Volt Typhoon dumps information\nfrom local web browser applications. Microsoft has also observed the threat actors staging\ncollected data in password-protected archives.\n\nCommand and control\nIn most cases, Volt Typhoon accesses compromised systems by signing in with valid\ncredentials, the same way authorized users do. However, in a small number of cases,\nMicrosoft has observed Volt Typhoon operators creating proxies on compromised systems to\nfacilitate access. They accomplish this with the built-in netsh portproxy command.\n\nFigure 6. Volt Typhoon commands creating and later deleting a port proxy on a compromised\nsystem\nIn rare cases, they also use custom versions of open-source tools Impacket and Fast\nReverse Proxy (FRP) to establish a C2 channel over proxy.\nCompromised organizations will observe C2 access in the form of successful sign-ins from\nunusual IP addresses. The same user account used for these sign-ins may be linked to\ncommand-line activity conducting further credential access. Microsoft will continue to monitor\nVolt Typhoon and track changes in their activity and tooling.\n\nMitigation and protection guidance\nMitigating risk from adversaries like Volt Typhoon that rely on valid accounts and living-offthe-land binaries (LOLBins) is particularly challenging. Detecting activity that uses normal\nsign-in channels and system binaries requires behavioral monitoring. Remediation requires\nclosing or changing credentials for compromised accounts. Suspected compromised\naccounts or affected systems should be investigated:\nIdentify LSASS dumping and domain controller installation media creation to identify\naffected accounts.\nExamine the activity of compromised accounts for any malicious actions or exposed\ndata.\n\n5/9\n\nClose or change credentials for all compromised accounts. Depending on the level of\ncollection activity, many accounts may be affected.\n\nDefending against this campaign\nMitigate the risk of compromised valid accounts by enforcing strong multi-factor\nauthentication (MFA) policies using hardware security keys or Microsoft Authenticator.\nPasswordless sign-in, password expiration rules, and deactivating unused accounts\ncan also help mitigate risk from this access method.\nReduce the attack surface. Microsoft customers can turn on the following attack\nsurface reduction rules to block or audit some observed activity associated with this\nthreat:\nBlock credential stealing from the Windows local security authority subsystem\n(lsass.exe).Block process creations originating from PSExec and WMI\ncommands. Some organizations may experience compatibility issues with this\nrule on certain server systems but should deploy it to other systems to prevent\nlateral movement originating from PsExec and WMI.\nBlock execution of potentially obfuscated scripts.\nHarden the LSASS process by enabling Protective Process Light (PPL) for LSASS on\nWindows 11 devices. New, enterprise-joined Windows 11 (22H2 update) installs have\nthis feature enabled by default. In addition, enable Windows Defender Credential\nGuard, which is also turned on by default for organizations using the Enterprise edition\nof Windows 11.\nTurn on cloud-delivered protection in Microsoft Defender Antivirus to cover rapidly\nevolving attacker tools, techniques, and behaviors such as those exhibited by Volt\nTyphoon.\nRun endpoint detection and response (EDR) in block mode so that Microsoft Defender\nfor Endpoint can block malicious artifacts, even when your non-Microsoft antivirus does\nnot detect the threat, or when Microsoft Defender Antivirus is running in passive mode.\nEDR in block mode works behind the scenes to remediate malicious artifacts that are\ndetected post-compromise.\n\nDetection details and hunting queries\nMicrosoft Defender Antivirus\nMicrosoft Defender Antivirus detects attempted post-compromise activity. Note, however, that\nthese alerts can also be triggered by threat activity unrelated to Volt Typhoon. Turn on clouddelivered protection to cover rapidly evolving attacker tools and techniques. Cloud-based\nmachine learning protections block most new and unknown threats.\nBehavior:Win32/SuspNtdsUtilUsage.A\nBehavior:Win32/SuspPowershellExec.E\n6/9\n\nBehavior:Win32/SuspRemoteCmdCommandParent.A\nBehavior:Win32/UNCFilePathOperation\nBehavior:Win32/VSSAmsiCaller.A\nBehavior:Win32/WinrsCommand.A\nBehavior:Win32/WmiSuspProcExec.J!se\nBehavior:Win32/WmicRemote.A\nBehavior:Win32/WmiprvseRemoteProc.B\n\nMicrosoft Defender for Endpoint\nMicrosoft Defender for Endpoint alerts with the following titles can indicate possible presence\nof Volt Typhoon activity.\nVolt Typhoon threat actor detected\nThe following alerts may also be associated with Volt Typhoon activity. Note, however, that\nthese alerts can also be triggered by threat activity unrelated to Volt Typhoon.\nA machine was configured to forward traffic to a non-local address\nNtdsutil collecting Active Directory information\nPassword hashes dumped from LSASS memory\nSuspicious use of wmic.exe to execute code\nImpacket toolkit\n\nHunting queries\nMicrosoft 365 Defender\nVolt Typhoon\u2019s post-compromise activity usually includes distinctive commands. Searching\nfor these can help to determine the scope and impact of an incident.\nFind commands creating domain controller installation media\nThis query can identify domain controller installation media creation commands similar to\nthose used by Volt Typhoon.\nDeviceProcessEvents\n| where ProcessCommandLine has_all (\"ntdsutil\", \"create full\", \"pro\")\n\nFind commands establishing internal proxies\nThis query can identify commands that establish internal proxies similar to those used by Volt\nTyphoon.\n\n7/9\n\nDeviceProcessEvents\n| where ProcessCommandLine has_all (\"portproxy\", \"netsh\", \"wmic\", \"process call\ncreate\", \"v4tov4\")\n\nFind detections of custom FRP executables\nThis query can identify alerts on files that match the SHA-256 hashes of known Volt Typhoon\ncustom FRP binaries.\nAlertEvidence\n| where SHA256 in\n('baeffeb5fdef2f42a752c65c2d2a52e84fb57efc906d981f89dd518c314e231c',\n'b4f7c5e3f14fb57be8b5f020377b993618b6e3532a4e1eb1eae9976d4130cc74',\n'4b0c4170601d6e922cf23b1caf096bba2fade3dfcf92f0ab895a5f0b9a310349',\n'c0fc29a52ec3202f71f6378d9f7f9a8a3a10eb19acb8765152d758aded98c76d',\n'd6ab36cb58c6c8c3527e788fc9239d8dcc97468b6999cf9ccd8a815c8b4a80af',\n'9dd101caee49c692e5df193b236f8d52a07a2030eed9bd858ed3aaccb406401a',\n'450437d49a7e5530c6fb04df2e56c3ab1553ada3712fab02bd1eeb1f1adbc267',\n'93ce3b6d2a18829c0212542751b309dacbdc8c1d950611efe2319aa715f3a066',\n'7939f67375e6b14dfa45ec70356e91823d12f28bbd84278992b99e0d2c12ace5',\n'389a497f27e1dd7484325e8e02bbdf656d53d5cf2601514e9b8d8974befddf61',\n'c4b185dbca490a7f93bc96eefb9a597684fdf532d5a04aa4d9b4d4b1552c283b',\n'e453e6efc5a002709057d8648dbe9998a49b9a12291dee390bb61c98a58b6e95',\n'6036390a2c81301a23c9452288e39cb34e577483d121711b6ba6230b29a3c9ff',\n'cd69e8a25a07318b153e01bba74a1ae60f8fc28eb3d56078f448461400baa984',\n'17506c2246551d401c43726bdaec800f8d41595d01311cf38a19140ad32da2f4',\n'8fa3e8fdbaa6ab5a9c44720de4514f19182adc0c9c6001c19cf159b79c0ae9c2',\n'd17317e1d5716b09cee904b8463a203dc6900d78ee2053276cc948e4f41c8295',\n'472ccfb865c81704562ea95870f60c08ef00bcd2ca1d7f09352398c05be5d05d',\n'3e9fc13fab3f8d8120bd01604ee50ff65a40121955a4150a6d2c007d34807642')\n\nMicrosoft Sentinel\nBelow are some suggested queries to assist Microsoft Sentinel customers in identifying Volt\nTyphoon activity in their environment:\nMicrosoft customers can use the TI Mapping analytics (a series of analytics all prefixed with\n\u2018TI map\u2019) to automatically match the malicious hash indicators (related to the custom Fast\nReverse Proxy binaries) mentioned in this blog post. These analytics are part of the Threat\nIntelligence solution and can be installed from the Microsoft Sentinel Content Hub if not\ncurrently deployed. More details on the Content Hub can be found\nhere: https://learn.microsoft.com/azure/sentinel/sentinel-solutions-deploy.\n\nIndicators of compromise (IOCs)\nThe below list provides IOCs observed during our investigation. We encourage our\ncustomers to investigate these indicators in their environments and implement detections\nand protection to identify past related activity and prevent future attacks against their\n\n8/9\n\nsystems.\nVolt Typhoon custom FRP executable (SHA-256):\nbaeffeb5fdef2f42a752c65c2d2a52e84fb57efc906d981f89dd518c314e231c\nb4f7c5e3f14fb57be8b5f020377b993618b6e3532a4e1eb1eae9976d4130cc74\n4b0c4170601d6e922cf23b1caf096bba2fade3dfcf92f0ab895a5f0b9a310349\nc0fc29a52ec3202f71f6378d9f7f9a8a3a10eb19acb8765152d758aded98c76d\nd6ab36cb58c6c8c3527e788fc9239d8dcc97468b6999cf9ccd8a815c8b4a80af\n9dd101caee49c692e5df193b236f8d52a07a2030eed9bd858ed3aaccb406401a\n450437d49a7e5530c6fb04df2e56c3ab1553ada3712fab02bd1eeb1f1adbc267\n93ce3b6d2a18829c0212542751b309dacbdc8c1d950611efe2319aa715f3a066\n7939f67375e6b14dfa45ec70356e91823d12f28bbd84278992b99e0d2c12ace5\n389a497f27e1dd7484325e8e02bbdf656d53d5cf2601514e9b8d8974befddf61\nc4b185dbca490a7f93bc96eefb9a597684fdf532d5a04aa4d9b4d4b1552c283b\ne453e6efc5a002709057d8648dbe9998a49b9a12291dee390bb61c98a58b6e95\n6036390a2c81301a23c9452288e39cb34e577483d121711b6ba6230b29a3c9ff\ncd69e8a25a07318b153e01bba74a1ae60f8fc28eb3d56078f448461400baa984\n17506c2246551d401c43726bdaec800f8d41595d01311cf38a19140ad32da2f4\n8fa3e8fdbaa6ab5a9c44720de4514f19182adc0c9c6001c19cf159b79c0ae9c2\nd17317e1d5716b09cee904b8463a203dc6900d78ee2053276cc948e4f41c8295\n472ccfb865c81704562ea95870f60c08ef00bcd2ca1d7f09352398c05be5d05d\n3e9fc13fab3f8d8120bd01604ee50ff65a40121955a4150a6d2c007d34807642\n\n9/9",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2023/2023-05-24 - Volt Typhoon targets US critical infrastructure with living-off-the-land techniques.pdf"
    ],
    "report_names": [
        "2023-05-24 - Volt Typhoon targets US critical infrastructure with living-off-the-land techniques.pdf"
    ],
    "threat_actors": [
        {
            "id": "846522d7-29cb-4a0c-8ebe-ffba7429e2d7",
            "created_at": "2023-06-23T02:04:34.793629Z",
            "updated_at": "2024-11-22T02:02:01.234118Z",
            "deleted_at": null,
            "main_name": "Volt Typhoon",
            "aliases": [
                "Bronze Silhouette",
                "VOLTZITE",
                "Vanguard Panda"
            ],
            "source_name": "ETDA:Volt Typhoon",
            "tools": [
                "FRP",
                "Fast Reverse Proxy",
                "Impacket",
                "LOLBAS",
                "LOLBins",
                "Living off the Land"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "382f2519-30b3-4943-b494-2d675bc2b38f",
            "created_at": "2024-06-19T02:03:07.951514Z",
            "updated_at": "2024-11-22T02:02:52.998745Z",
            "deleted_at": null,
            "main_name": "BRONZE SILHOUETTE",
            "aliases": [
                "Volt Typhoon "
            ],
            "source_name": "Secureworks:BRONZE SILHOUETTE",
            "tools": [
                " Web shells",
                "Living-off-the-land binaries"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "4ed2b20c-7523-4852-833b-cebee8029f55",
            "created_at": "2023-05-26T02:02:03.524749Z",
            "updated_at": "2024-11-22T02:00:02.817363Z",
            "deleted_at": null,
            "main_name": "Volt Typhoon",
            "aliases": [
                "VOLTZITE",
                "Dev-0391",
                "Storm-0391",
                "BRONZE SILHOUETTE",
                "VANGUARD PANDA",
                "UNC3236",
                "Insidious Taurus"
            ],
            "source_name": "MISPGALAXY:Volt Typhoon",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "a88747e2-ffed-45d8-b847-8464361b2254",
            "created_at": "2023-11-01T02:01:06.605663Z",
            "updated_at": "2024-11-22T02:00:52.310366Z",
            "deleted_at": null,
            "main_name": "Volt Typhoon",
            "aliases": [
                "Volt Typhoon",
                "BRONZE SILHOUETTE",
                "Vanguard Panda",
                "DEV-0391",
                "UNC3236",
                "Voltzite",
                "Insidious Taurus"
            ],
            "source_name": "MITRE:Volt Typhoon",
            "tools": [
                "netsh",
                "PsExec",
                "ipconfig",
                "Wevtutil",
                "VersaMem",
                "Tasklist",
                "Mimikatz",
                "Impacket",
                "Systeminfo",
                "netstat",
                "Nltest",
                "certutil",
                "FRP",
                "cmd"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1685930862016,
    "ts_updated_at": 1732240979531,
    "ts_creation_date": 1685883790000,
    "ts_modification_date": 1685883790000,
    "files": {
        "pdf": "https://archive.orkl.eu/837af86cc6ab635135fd9313e851f4c0635d1bb5.pdf",
        "text": "https://archive.orkl.eu/837af86cc6ab635135fd9313e851f4c0635d1bb5.txt",
        "img": "https://archive.orkl.eu/837af86cc6ab635135fd9313e851f4c0635d1bb5.jpg"
    }
}