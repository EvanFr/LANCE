{
    "id": "de85fffc-1cfc-4648-bdc0-a913347a6c55",
    "created_at": "2024-01-04T02:05:57.460702Z",
    "updated_at": "2024-11-22T02:03:30.712582Z",
    "deleted_at": null,
    "sha1_hash": "b0cce40bbc4e54a2742d25794bc5311cd958c2b2",
    "title": "Threat Actor 'UAC-0099' Continues to Target Ukraine",
    "authors": "Deepinstinct",
    "file_creation_date": "2024-01-03T02:33:11Z",
    "file_modification_date": "2024-01-03T02:33:11Z",
    "file_size": 2058444,
    "plain_text": "Threat Actor 'UAC-0099' Continues to Target Ukraine\ndeepinstinct.com/blog/threat-actor-uac-0099-continues-to-target-ukraine\nDecember 21, 2023\n\nDECEMBER 21, 2023\nDeep Instinct Threat Lab\nKey Takeaways\n\n\"UAC-0099\" is a threat actor that has targeted Ukraine since mid-2022\nDeep Instinct Threat Lab has identified new attacks by the threat actor\nThe threat actor was observed leveraging CVE-2023-38831\nThe threat actor targets Ukrainian employees working for companies outside of Ukraine\nIntroduction\n\nIn May 2023, the Ukrainian CERT published advisory #6710 about a threat actor dubbed\n\u201cUAC-0099.\u201d The advisory briefly details the threat actor\u2019s activities and tools.\nSince the CERT-UA publication in May, Deep Instinct has identified new attacks carried out\nby \u201cUAC-0099\u201d against Ukrainian targets.\nThis blog post will shed additional light on the threat group\u2019s recent attacks, which feature\ncommon tactics, techniques, and procedures (TTPs), including the use of a fabricated court\nsummons to bait targets in Ukraine into executing the malicious files.\nImportant note: Some of the C2 servers related to these attacks are still active at the\ntime of publication.\n\n1/11\n\nFigure 1: Overview of recent UAC-0099 activities.\nRAR SFX with LNK Infection Vector\n\nIn early August, \u201cUAC-0099\u201d sent an email impersonating the Lviv city court using the ukr.net\nemail service.\nThe email was sent to a corporate email box of a Ukrainian employee working remotely for a\ncompany outside of the Ukraine.\nThe attached is an executable file created by WinRAR, the Windows-based file archiver and\ncompression utility that can compress a file as a self-extracting archive (SFX):\n\n2/11\n\nFigure 2: Prompt when executing the attached SFX file.\nAfter extracting the contents of the archive, a new file is created with a double extension, in\nthis case docx.lnk:\n\nFigure 3: Double extension social engineering trick.\nThe file looks like a regular document file. However, it\u2019s a LNK shortcut disguised as a DOCX\nfile. Closer inspection reveals that the file uses the \u201cWordPad\u201d application icon instead of a\nDOCX icon. When opened, the specially crafted LNK file executes PowerShell with malicious\ncontent:\n\n3/11\n\nFigure 4: Malicious PowerShell commands inside the LNK file.\nThe malicious PowerShell code decodes two base64 blobs and writes the output into VBS\nand DOCX files. After that, the PowerShell code opens the DOCX file as a decoy while also\ncreating a new scheduled task that executes the VBS file every three minutes.\nThe VBS malware was named \u201cLonePage\u201d by CERT-UA. When executed, it creates a hidden\nPowerShell process that communicates with a hardcoded C2 URL to fetch a text file. The\nrest of the PowerShell code is executed only if the response from the C2 is greater than one\nbyte. In that instance, the PowerShell script checks to see if the string \u201cget-content\u201c is\nincluded in the text file. If the string is present, then the script executes the code from the\nserver and saves it as an array of bytes. If the string is absent, the script executes a\ncombination of commands inside the text file from the server and some hard-coded basic\nenumeration commands such as \u201cwhoami:\u201d\n\nFigure 5: LonePage VBS script.\nRegardless of the C2 response, the results of executing the commands inside the txt file or\nthe hardcoded commands are sent back to the same C2 server. However, it is sent to a\ndifferent port via HTTP POST method.\nThe DOCX document is a decoy to trick the victim into thinking they\u2019re opening a legitimate\nDOCX file containing a court summons instead of a malicious file:\n\n4/11\n\nFigure 6: Contents of DOCX file.\nIn early November, another instance of this campaign was observed using a different C2\naddress \u2014 196.196.156[.]2.\nSince the threat actor controls the content of the \u201cupgrade.txt\u201d files, they can change it\naccording to their objectives. As such, the content is not always the same and can vary.\nThe following code was observed as a response from the C2 server at 2023-11-08 14:50:30\nUTC.\n\n5/11\n\nFigure 7: C2 Get-Screenshot command.\nThis PowerShell code is responsible for taking a screenshot. As mentioned above, the\nLonePage VBS sends the results back to the C2, allowing the threat actor to execute any\nPowerShell code on the infected computer and receive the response back.\nAt the end of November 2023, another campaign instance was observed using the C2\naddress 2.59.222[.]98. In this case, the payload response from the C2 server aligns with\nwhat was described as \u201crecon\u201d activity in the pastebin:\n\nFigure 8: Recon commands received from C2 server.\nThe decoy document is a PDF file instead of a DOCX. And instead of the usual court\nsummons document, the PDF file shows a smudged document:\n\n6/11\n\nFigure 9: Smudged decoy PDF document.\nHTA Infection Vector\n\nIn contrast to the LNK attack vector described earlier, this attack uses HTA. The HTA method\nis similar, but there are notable differences. Instead of an LNK file invoking PowerShell, the\nHTA file includes HTML code that contains a VBScript that executes PowerShell. The\nscheduled task cadence is also different \u2014 it runs every four minutes instead of three in the\nprevious cases.\nWhile CERT-UA reported in their advisory that the HTA file drops an HTML file as a decoy,\nDeep Instinct observed a similar court summons DOCX decoy document, like what was\nobserved in the LNK chain.\n\n7/11\n\nFigure 10: HTA file content.\nCVE-2023-38831 Infection Vector\n\nIn both attacks described below, \u201cUAC-0099\u201d exploited a known WinRAR vulnerability,\nidentified by Group-IB and traced back to April 2023.\nThe vulnerability stems from how WinRAR processes ZIP files. The exploitation requires a\nuser to interact with a specially crafted ZIP archive.\nHere\u2019s how it works: the attacker creates an archive with a benign filename with a space\nafter the file extension \u2014 for example, \u201cpoc.pdf .\u201d The archive includes a folder with the same\nname, including the space (something that is not possible under normal conditions, since the\noperating system does not allow the creation of a file with the same name). The folder\nincludes an additional file with the same name as the benign file, including a space, followed\nby a \u201c.cmd\u201d extension.\nWhen a user opens a ZIP file containing these files in an unpatched version of WinRAR and\ndouble-clicks on the benign file, the file with the \u201ccmd\u201d extension is executed instead.\nThe vulnerability might produce higher infection rates because the attacks are disguised so\nwell; even security-savvy victims can fall for the deception. Expecting to open a benign file,\nthe user will inadvertently execute malicious code.\nYou can find a POC for the vulnerability in GitHub. A patched WinRAR (version 6.23) was\nreleased on August 2, 2023.\nDeep Instinct identified two ZIP files created by \u201cUAC-0099\" on August 5, 2023:\n\n8/11\n\nFigure 11: Contents of malicious \u201ccmd\u201d file inside ZIP archive.\nThe malicious \u201ccmd\u201d file is different in the two files, each containing a different C2 URI path.\nThe modification time between the two files is only two seconds, indicating that, most likely,\nthe files were created in an automated fashion. This, combined with the fact that UAC-0099\nstarted to exploit the vulnerability several days after the patch, shows the level of\nsophistication of the attackers.\nWhile Google TAG identified several Russian threat actors using the vulnerability to attack\nUkrainian targets, the UAC-0099 activity is absent in their blog.\nThe CVE assignment and the Group-IB blog about the vulnerability were published after\n\u201cUAC-0099\u201d leveraged the attack technique, indicating they likely knew how to exploit it.\nThe decoy used in this campaign was once again the \u201csummon to court\u201d document theme.\nConclusions and Recommendations\n\nThe tactics used by \u201cUAC-0099\u201d are simple, yet effective. Despite the different initial infection\nvectors, the core infection is the same \u2014 they rely on PowerShell and the creation of a\nscheduled task that executes a VBS file.\nMonitoring and limiting the functionality of those components can reduce the risk of \u201cUAC0099\u201d attacks \u2014 and/or identify them quickly in the event of compromise.\nThe WinRAR exploitation is an interesting choice. Some people don\u2019t update their software\nin a timely fashion, even with automatic updates. WinRAR requires a manual update,\nmeaning that even if a patch is available, many people will likely still have a vulnerable\nversion of WinRAR installed.\nPlease make sure you have the latest version of WinRAR installed.\nIOCs and the POC for the CVE-2023-38831 can be found on our GitHub.\nIOCs\n\n147.78.46[.]40\n196.196.156[.]2\n2.59.222[.]98\n\n9/11\n\nSHA256\n\nDescriptio\n\nd21aa84542303ca70b59b53e9de9f092f9001f409158a9d46a5e8ce82ab60fb6\n\nSFX\n\n0eec5a7373b28a991831d9be1e30976ceb057e5b701e732372524f1a50255c7\n\nLNK\n\n8aca535047a3a38a57f80a64d9282ace7a33c54336cd08662409352c23507602\n\nVBS\n\n2c2fa6b9fbb6aa270ba0f49ebb361ebf7d36258e1bdfd825bc2faeb738c487ed\n\nDecoy\n\n659abb39eec218de66e2c1d917b22149ead7b743d3fe968ef840ef22318060fd\n\nSFX\n\n0aa794e54c19dbcd5425405e3678ab9bc98fb7ea787684afb962ee22a1c0ab51\n\nLNK\n\n4e8de351db362c519504509df309c7b58b891baf9cb99a3500b92fe0ef772924\n\nVBS\n\n53812d7bdaf5e8e5c1b99b4b9f3d8d3d7726d4c6c23a72fb109132d96ca725c2\n\nDecoy\n\n38b49818bb95108187fb4376e9537084062207f91310cdafcb9e4b7aa0d078f9\n\nHTA\n\na10209c10bf373ed682a13dad4ff3aea95f0fdcd48b62168c6441a1c9f06be37\n\nVBS\n\n61a5b971a6b5f9c2b5e9a860c996569da30369ac67108d4b8a71f58311a6e1f1\n\nDecoy\n\n86549cf9c343d0533ef80be2f080a7e3c38c77a1dfbde0a2f89048127979ec2a\n\nSFX\n\n762c7289fb016bbcf976bd104bd8da72e17d6d81121a846cd40480dbdd876378\n\nLNK\n\n39d56eab8adfe9eb244914dde42ec7f12f48836d3ba56c479ab21bdbc41025fe\n\nVBS\n\nf75f1d4c561fcb013e262b3667982759f215ba7e714c43474755b72ed7f9d01e\n\nDecoy\n\n986694cad425c8f566e4e12c104811d4e8b30ce6c4c4d38f919b617b1aa66b05\n\nCVE-2023\n38831 ZIP\n\n54458ebfbe56bc932e75d6d0a5c1222286218a8ef26face40f2a0c0ec2517584\n\nCVE\nPayload\n\n96ab977f8763762af26bad2b6c501185b25916775b4ed2d18ad66b4c38bd5f0d\n\nVBS\n\n6a638569f831990df48669ca81fec37c6da380dbaaa6432d4407985e809810da\n\nDecoy\n\n87291b918218e01cac58ea55472d809d8cdd79266c372aebe9ee593c0f4e3b77\n\nCVE-2023\n38831 ZIP\n\nf5f269cf469bf9c9703fe0903cda100acbb4b3e13dbfef6b6ee87a907e5fcd1b\n\nCVE\nPayload\n\ne34fc4910458e9378ea357baf045e9c0c21515a0b8818a5b36daceb2af464ea0\n\nVBS\n\n2a3da413f9f0554148469ea715f2776ab40e86925fb68cc6279ffc00f4f410dd\n\nSFX\n\n10/11\n\nSHA256\n\nDescriptio\n\n0acd4a9ef18f3fd1ccf440879e768089d4dd2107e1ce19d2a17a59ebed8c7f5d\n\nLNK\n\n6f5f265110490158df91ca8ad429a96f8af69ca30b9e3b0d9c11d4fef74091e8\n\nVBS\n\n736c0128402d83cd3694a5f5bb02072d77385c587311274e3229e9b2fd5c5af7\n\nDecoy\n\n11/11",
    "language": "EN",
    "sources": [
        {
            "id": "d63ae2b7-445f-460d-965d-2676dacdb6de",
            "created_at": "2022-10-25T15:59:19.552139Z",
            "updated_at": "2022-10-25T15:59:19.552139Z",
            "deleted_at": null,
            "name": "APTnotes",
            "url": "https://github.com/aptnotes/data",
            "description": "APTnotes data",
            "reports": null
        }
    ],
    "references": [
        "https://app.box.com/s/dd69xw7nerwy3w6zkqapfwhrsacgtxxj"
    ],
    "report_names": [
        "Deepinstinct_TA-UAC-0099-Continues-Target-Ukraine(12-21-2023)"
    ],
    "threat_actors": [
        {
            "id": "154da875-2e93-41ab-8a41-90fdd66b214b",
            "created_at": "2024-01-09T02:00:04.2024Z",
            "updated_at": "2024-11-22T02:00:02.953072Z",
            "deleted_at": null,
            "main_name": "UAC-0099",
            "aliases": [],
            "source_name": "MISPGALAXY:UAC-0099",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1704333957460,
    "ts_updated_at": 1732241010712,
    "ts_creation_date": 1704249191000,
    "ts_modification_date": 1704249191000,
    "files": {
        "pdf": "https://archive.orkl.eu/b0cce40bbc4e54a2742d25794bc5311cd958c2b2.pdf",
        "text": "https://archive.orkl.eu/b0cce40bbc4e54a2742d25794bc5311cd958c2b2.txt",
        "img": "https://archive.orkl.eu/b0cce40bbc4e54a2742d25794bc5311cd958c2b2.jpg"
    }
}