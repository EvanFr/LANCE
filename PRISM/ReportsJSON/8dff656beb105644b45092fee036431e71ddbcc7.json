{
    "id": "69623e88-45ea-4706-b12c-eccc08f7adaa",
    "created_at": "2023-06-05T02:06:45.134482Z",
    "updated_at": "2024-11-22T02:03:44.032213Z",
    "deleted_at": null,
    "sha1_hash": "8dff656beb105644b45092fee036431e71ddbcc7",
    "title": "2023-04-21 - X_Trader Supply Chain Attack Affects Critical Infrastructure Organizations in U.S. and Europe",
    "authors": "",
    "file_creation_date": "2023-06-04T13:03:29Z",
    "file_modification_date": "2023-06-04T13:03:29Z",
    "file_size": 147819,
    "plain_text": "X_Trader Supply Chain Attack Affects Critical\nInfrastructure Organizations in U.S. and Europe\nsymantec-enterprise-blogs.security.com/blogs/threat-intelligence/xtrader-3cx-supply-chain\n\nThreat Hunter TeamSymantec\nThe X_Trader software supply chain attack affected more organizations than 3CX. Initial\ninvestigation by Symantec\u2019s Threat Hunter Team has, to date, found that among the victims\nare two critical infrastructure organizations in the energy sector, one in the U.S. and the other\nin Europe. In addition to this, two other organizations involved in financial trading were also\nbreached.\nAs reported yesterday by Mandiant, Trojanized X_Trader software was the cause of the 3CX\nbreach, which was uncovered last month. As a result of this breach, 3CX\u2019s software was\ncompromised, with many customers inadvertently downloading malicious versions of the\ncompany\u2019s voice and video calling software DesktopApp. In addition to wider victims,\nSymantec has also discovered additional indicators of compromise, listed below.\nIt appears likely that the X_Trader supply chain attack is financially motivated, since Trading\nTechnologies, the developer of X_Trader, facilitates futures trading, including energy futures.\nNevertheless, the compromise of critical infrastructure targets is a source of concern. North\nKorean-sponsored actors are known to engage in both espionage and financially motivated\nattacks and it cannot be ruled out that strategically important organizations breached during\na financial campaign are targeted for further exploitation.\n\nMalicious Installer\nThe infection chain starts with the Trojanized installer named X_TRADER_r7.17.90p608.exe\n(SHA256: 900b63ff9b06e0890bf642bdfcbfcc6ab7887c7a3c057c8e3fd6fba5ffc8e5d6), which\nis digitally signed by \"Trading Technologies International, Inc.\" and contains a malicious\nexecutable named Setup.exe. Our analysis of one version of this executable (SHA256:\naa318070ad1bf90ed459ac34dc5254acc178baff3202d2ea7f49aaf5a055dd43) found that\nwhen executed, it examined the file named X_TRADER-ja.mst (also contained in the\ninstaller) for the following marker bytes at hardcoded offset 0x167000:\n\n1/4\n\n5E DA F3 76\nIf the marker bytes are present, it creates a folder named:\nC:\\Programdata\\TPM\nIt then copies the file C:\\Windows\\Sysnative\\immersivetpmvscmgrsvr.exe as\nC:\\Programdata\\TPM\\TpmVscMgrSvr.exe to the new folder.\nNext, it will drop two malicious DLLs:\nC:\\Programdata\\TPM\\winscard.dll (SHA256:\ncc4eedb7b1f77f02b962f4b05278fa7f8082708b5a12cacf928118520762b5e2)\nC:\\Programdata\\TPM\\msvcr100.dll (SHA256:\nd937e19ccb3fd1dddeea3eaaf72645e8cd64083228a0df69c60820289b1aa3c0)\nThe content of the dropped files is generated by decrypting chunks of the file X_TRADERja.mst mentioned earlier using the XOR algorithm with the following key:\n74 F2 39 DA E5 CF\nTo achieve persistence on the victim\u2019s system, the malware invokes a CLSID_TaskScheduler\nCOM object, possibly to create a scheduled task to run periodically the following file:\nC:\\Programdata\\TPM\\TpmVscMgrSvr.exe\nSetup.exe then drops a file named X_TRADER.exe, also contained within the installer. The\ncontent of the dropped file is generated by decrypting chunks from one of its own portable\nexecutable resources starting at hardcoded offset 0x1CB40 using the XOR algorithm with\nthe following key:\n74 F2 39 DA E5 CF\nSetup will then execute X_Trader.exe before deleting itself.\n\nBackdoor Installation\nOnce installed, the legitimate X_Trader executable side-loads the two malicious DLLs\ndropped by the installer. The first, winscard.dll, acts as a loader and contains code that will\nload and execute a payload from the second (msvcr100.dll). The msvcr100.dll file contains\nan encrypted blob appended to the file. The blob starts with the hex value FEEDFACE, which\nthe loader uses to find the blob.\nThe process for payload installation is almost identical as that seen with the Trojanized 3CX\napp, where two side-loaded DLLs are used to extract a payload from an encrypted blob.\n\n2/4\n\nIn this attack, the payload extracted is a modular backdoor called Veiledsignal (SHA256:\ne185c99b3d1085aed9fda65a9774abd73ecf1229f14591606c6c59e9660c4345). Veiledsignal\ncontains another DLL (SHA256:\n19442d9e476e3ef990ce57b683190301e946ccb28fc88b69ab53a93bf84464ae), which is a\nprocess-injection module. This can be injected into the Chrome, Firefox, or Edge web\nbrowsers. The module contains a second DLL (SHA256:\nf8c370c67ffb3a88107c9022b17382b5465c4af3dd453e50e4a0bd3ae9b012ce), which is a\ncommand-and-control (C&C) module. It connects to the following C&C URL:\nhttps://www.tradingtechnologies.com/trading/order-management\n\nHydra-like Campaign\nThe discovery that 3CX was breached by another, earlier supply chain attack made it highly\nlikely that further organizations would be impacted by this campaign, which now transpires to\nbe far more wide-ranging than originally believed. The attackers behind these breaches\nclearly have a successful template for software supply chain attacks and further, similar\nattacks cannot be ruled out.\n\nProtection/Mitigation\nFor the latest protection updates, please visit the Symantec Protection Bulletin.\n\nIndicators of Compromise\nIf an IOC is malicious and the file available to us, Symantec Endpoint products will detect\nand block that file.\n900b63ff9b06e0890bf642bdfcbfcc6ab7887c7a3c057c8e3fd6fba5ffc8e5d6 - Trojanized\ninstaller (X_TRADER_r7.17.90p608.exe)\n6e989462acf2321ff671eaf91b4e3933b77dab6ab51cd1403a7fe056bf4763ba \u2013 Possible\nTrojanized installer\naa318070ad1bf90ed459ac34dc5254acc178baff3202d2ea7f49aaf5a055dd43 - Malicious\ncomponent of Trojanized installer (setup.exe)\n6e11c02485ddd5a3798bf0f77206f2be37487ba04d3119e2d5ce12501178b378 - Malicious\ncomponent of Trojanized installer (setup.exe)\n47a8e3b20405a23f7634fa296f148cab39a7f5f84248c6afcfabf5201374d1d1 - Benign\nWindows executable used for side-loading (tpmvscmgrsvr.exe)\n\n3/4\n\ncc4eedb7b1f77f02b962f4b05278fa7f8082708b5a12cacf928118520762b5e2 \u2013 Veiledsignal\nloader (winscard.dll)\n277119738f4bdafa1cde9790ec82ce1e46e04cebf6c43c0e100246f681ba184e \u2013 Veiledsignal\nloader (devobj.dll)\ncb374af8990c5f47b627596c74e2308fbf39ba33d08d862a2bea46631409539f \u2013 Malicious\nDLL (msvcr100.dll)\nd937e19ccb3fd1dddeea3eaaf72645e8cd64083228a0df69c60820289b1aa3c0 \u2013 Malicious\nDLL (msvcr100.dll)\ne185c99b3d1085aed9fda65a9774abd73ecf1229f14591606c6c59e9660c4345 - Veiledsignal\nmain component\n19442d9e476e3ef990ce57b683190301e946ccb28fc88b69ab53a93bf84464ae - Veiledsignal\nprocess-injection module\nf8c370c67ffb3a88107c9022b17382b5465c4af3dd453e50e4a0bd3ae9b012ce - Veiledsignal\ncommunications module\nhttps://www.tradingtechnologies[.]com/trading/order-management - Veiledsignal C&C server\n\\\\.\\pipe\\gecko.nativeMessaging.in.foo8bc16e6288f2a -Veiledsignal named pipe\nMozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko)\nChrome/95.0.4638.54 Safari/537.36 Edg/95.0.1020.40 - Veiledsignal user agent\n\nAbout the Author\nThreat Hunter Team\nSymantec\nThe Threat Hunter Team is a group of security experts within Symantec whose mission is to\ninvestigate targeted attacks, drive enhanced protection in Symantec products, and offer\nanalysis that helps customers respond to attacks.\n\n4/4",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2023/2023-04-21 - X_Trader Supply Chain Attack Affects Critical Infrastructure Organizations in U.S. and Europe.pdf"
    ],
    "report_names": [
        "2023-04-21 - X_Trader Supply Chain Attack Affects Critical Infrastructure Organizations in U.S. and Europe.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1685930805134,
    "ts_updated_at": 1732241024032,
    "ts_creation_date": 1685883809000,
    "ts_modification_date": 1685883809000,
    "files": {
        "pdf": "https://archive.orkl.eu/8dff656beb105644b45092fee036431e71ddbcc7.pdf",
        "text": "https://archive.orkl.eu/8dff656beb105644b45092fee036431e71ddbcc7.txt",
        "img": "https://archive.orkl.eu/8dff656beb105644b45092fee036431e71ddbcc7.jpg"
    }
}